"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/superadmin/stats/route";
exports.ids = ["app/api/superadmin/stats/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsuperadmin%2Fstats%2Froute&page=%2Fapi%2Fsuperadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsuperadmin%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsuperadmin%2Fstats%2Froute&page=%2Fapi%2Fsuperadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsuperadmin%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_superadmin_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/superadmin/stats/route.ts */ \"(rsc)/./src/app/api/superadmin/stats/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/superadmin/stats/route\",\n        pathname: \"/api/superadmin/stats\",\n        filename: \"route\",\n        bundlePath: \"app/api/superadmin/stats/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\OffirOmer\\\\Documents\\\\IPSPlatform\\\\src\\\\app\\\\api\\\\superadmin\\\\stats\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_superadmin_stats_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/superadmin/stats/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZzdXBlcmFkbWluJTJGc3RhdHMlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRnN1cGVyYWRtaW4lMkZzdGF0cyUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRnN1cGVyYWRtaW4lMkZzdGF0cyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNPZmZpck9tZXIlNUNEb2N1bWVudHMlNUNJUFNQbGF0Zm9ybSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDT2ZmaXJPbWVyJTVDRG9jdW1lbnRzJTVDSVBTUGxhdGZvcm0maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3dDO0FBQ3JIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8/N2IxNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxPZmZpck9tZXJcXFxcRG9jdW1lbnRzXFxcXElQU1BsYXRmb3JtXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXHN1cGVyYWRtaW5cXFxcc3RhdHNcXFxccm91dGUudHNcIjtcbi8vIFdlIGluamVjdCB0aGUgbmV4dENvbmZpZ091dHB1dCBoZXJlIHNvIHRoYXQgd2UgY2FuIHVzZSB0aGVtIGluIHRoZSByb3V0ZVxuLy8gbW9kdWxlLlxuY29uc3QgbmV4dENvbmZpZ091dHB1dCA9IFwiXCJcbmNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IEFwcFJvdXRlUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLkFQUF9ST1VURSxcbiAgICAgICAgcGFnZTogXCIvYXBpL3N1cGVyYWRtaW4vc3RhdHMvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9zdXBlcmFkbWluL3N0YXRzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9zdXBlcmFkbWluL3N0YXRzL3JvdXRlXCJcbiAgICB9LFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiQzpcXFxcVXNlcnNcXFxcT2ZmaXJPbWVyXFxcXERvY3VtZW50c1xcXFxJUFNQbGF0Zm9ybVxcXFxzcmNcXFxcYXBwXFxcXGFwaVxcXFxzdXBlcmFkbWluXFxcXHN0YXRzXFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9zdXBlcmFkbWluL3N0YXRzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsuperadmin%2Fstats%2Froute&page=%2Fapi%2Fsuperadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsuperadmin%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/superadmin/stats/route.ts":
/*!***********************************************!*\
  !*** ./src/app/api/superadmin/stats/route.ts ***!
  \***********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _lib_tenant_auth__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/tenant/auth */ \"(rsc)/./src/lib/tenant/auth.ts\");\n\n\n\n// GET - Get platform-wide statistics (Super Admin only)\nasync function GET(request) {\n    try {\n        // Check if user is super admin\n        const isSuper = await (0,_lib_tenant_auth__WEBPACK_IMPORTED_MODULE_2__.isSuperAdmin)();\n        if (!isSuper) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Super admin access required\"\n            }, {\n                status: 403\n            });\n        }\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        // Get total tenant count\n        const { count: totalTenants } = await supabase.from(\"tenants\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        // Get active tenant count\n        const { count: activeTenants } = await supabase.from(\"tenants\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"status\", \"active\");\n        // Get total user count\n        const { count: totalUsers } = await supabase.from(\"tenant_users\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        }).eq(\"status\", \"active\");\n        // Get total course count\n        const { count: totalCourses } = await supabase.from(\"courses\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        });\n        // Get tenants by subscription tier\n        const { data: tierData } = await supabase.from(\"tenants\").select(\"subscription_tier\").eq(\"status\", \"active\");\n        const tierCounts = tierData?.reduce((acc, t)=>{\n            acc[t.subscription_tier] = (acc[t.subscription_tier] || 0) + 1;\n            return acc;\n        }, {});\n        // Get recent tenants (last 30 days)\n        const thirtyDaysAgo = new Date();\n        thirtyDaysAgo.setDate(thirtyDaysAgo.getDate() - 30);\n        const { count: recentTenants } = await supabase.from(\"tenants\").select(\"*\", {\n            count: \"exact\",\n            head: true\n        }).gte(\"created_at\", thirtyDaysAgo.toISOString());\n        // Get tenant growth by month (last 6 months)\n        const sixMonthsAgo = new Date();\n        sixMonthsAgo.setMonth(sixMonthsAgo.getMonth() - 6);\n        const { data: growthData } = await supabase.from(\"tenants\").select(\"created_at\").gte(\"created_at\", sixMonthsAgo.toISOString()).order(\"created_at\", {\n            ascending: true\n        });\n        const monthlyGrowth = growthData?.reduce((acc, t)=>{\n            const month = new Date(t.created_at).toISOString().substring(0, 7); // YYYY-MM\n            acc[month] = (acc[month] || 0) + 1;\n            return acc;\n        }, {});\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: {\n                overview: {\n                    total_tenants: totalTenants || 0,\n                    active_tenants: activeTenants || 0,\n                    total_users: totalUsers || 0,\n                    total_courses: totalCourses || 0,\n                    recent_tenants_30d: recentTenants || 0\n                },\n                by_tier: tierCounts || {},\n                monthly_growth: monthlyGrowth || {}\n            }\n        });\n    } catch (error) {\n        console.error(\"Get stats error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"An error occurred while fetching statistics\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9zdXBlcmFkbWluL3N0YXRzL3JvdXRlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBd0Q7QUFDSDtBQUNKO0FBRWpELHdEQUF3RDtBQUNqRCxlQUFlRyxJQUFJQyxPQUFvQjtJQUM1QyxJQUFJO1FBQ0YsK0JBQStCO1FBQy9CLE1BQU1DLFVBQVUsTUFBTUgsOERBQVlBO1FBQ2xDLElBQUksQ0FBQ0csU0FBUztZQUNaLE9BQU9MLHFEQUFZQSxDQUFDTSxJQUFJLENBQ3RCO2dCQUFFQyxTQUFTO2dCQUFPQyxPQUFPO1lBQThCLEdBQ3ZEO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxNQUFNQyxXQUFXLE1BQU1ULGtFQUFZQTtRQUVuQyx5QkFBeUI7UUFDekIsTUFBTSxFQUFFVSxPQUFPQyxZQUFZLEVBQUUsR0FBRyxNQUFNRixTQUNuQ0csSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxLQUFLO1lBQUVILE9BQU87WUFBU0ksTUFBTTtRQUFLO1FBRTVDLDBCQUEwQjtRQUMxQixNQUFNLEVBQUVKLE9BQU9LLGFBQWEsRUFBRSxHQUFHLE1BQU1OLFNBQ3BDRyxJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDLEtBQUs7WUFBRUgsT0FBTztZQUFTSSxNQUFNO1FBQUssR0FDekNFLEVBQUUsQ0FBQyxVQUFVO1FBRWhCLHVCQUF1QjtRQUN2QixNQUFNLEVBQUVOLE9BQU9PLFVBQVUsRUFBRSxHQUFHLE1BQU1SLFNBQ2pDRyxJQUFJLENBQUMsZ0JBQ0xDLE1BQU0sQ0FBQyxLQUFLO1lBQUVILE9BQU87WUFBU0ksTUFBTTtRQUFLLEdBQ3pDRSxFQUFFLENBQUMsVUFBVTtRQUVoQix5QkFBeUI7UUFDekIsTUFBTSxFQUFFTixPQUFPUSxZQUFZLEVBQUUsR0FBRyxNQUFNVCxTQUNuQ0csSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxLQUFLO1lBQUVILE9BQU87WUFBU0ksTUFBTTtRQUFLO1FBRTVDLG1DQUFtQztRQUNuQyxNQUFNLEVBQUVLLE1BQU1DLFFBQVEsRUFBRSxHQUFHLE1BQU1YLFNBQzlCRyxJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDLHFCQUNQRyxFQUFFLENBQUMsVUFBVTtRQUVoQixNQUFNSyxhQUFhRCxVQUFVRSxPQUFPLENBQUNDLEtBQVVDO1lBQzdDRCxHQUFHLENBQUNDLEVBQUVDLGlCQUFpQixDQUFDLEdBQUcsQ0FBQ0YsR0FBRyxDQUFDQyxFQUFFQyxpQkFBaUIsQ0FBQyxJQUFJLEtBQUs7WUFDN0QsT0FBT0Y7UUFDVCxHQUFHLENBQUM7UUFFSixvQ0FBb0M7UUFDcEMsTUFBTUcsZ0JBQWdCLElBQUlDO1FBQzFCRCxjQUFjRSxPQUFPLENBQUNGLGNBQWNHLE9BQU8sS0FBSztRQUVoRCxNQUFNLEVBQUVuQixPQUFPb0IsYUFBYSxFQUFFLEdBQUcsTUFBTXJCLFNBQ3BDRyxJQUFJLENBQUMsV0FDTEMsTUFBTSxDQUFDLEtBQUs7WUFBRUgsT0FBTztZQUFTSSxNQUFNO1FBQUssR0FDekNpQixHQUFHLENBQUMsY0FBY0wsY0FBY00sV0FBVztRQUU5Qyw2Q0FBNkM7UUFDN0MsTUFBTUMsZUFBZSxJQUFJTjtRQUN6Qk0sYUFBYUMsUUFBUSxDQUFDRCxhQUFhRSxRQUFRLEtBQUs7UUFFaEQsTUFBTSxFQUFFaEIsTUFBTWlCLFVBQVUsRUFBRSxHQUFHLE1BQU0zQixTQUNoQ0csSUFBSSxDQUFDLFdBQ0xDLE1BQU0sQ0FBQyxjQUNQa0IsR0FBRyxDQUFDLGNBQWNFLGFBQWFELFdBQVcsSUFDMUNLLEtBQUssQ0FBQyxjQUFjO1lBQUVDLFdBQVc7UUFBSztRQUV6QyxNQUFNQyxnQkFBZ0JILFlBQVlkLE9BQU8sQ0FBQ0MsS0FBVUM7WUFDbEQsTUFBTWdCLFFBQVEsSUFBSWIsS0FBS0gsRUFBRWlCLFVBQVUsRUFBRVQsV0FBVyxHQUFHVSxTQUFTLENBQUMsR0FBRyxJQUFJLFVBQVU7WUFDOUVuQixHQUFHLENBQUNpQixNQUFNLEdBQUcsQ0FBQ2pCLEdBQUcsQ0FBQ2lCLE1BQU0sSUFBSSxLQUFLO1lBQ2pDLE9BQU9qQjtRQUNULEdBQUcsQ0FBQztRQUVKLE9BQU94QixxREFBWUEsQ0FBQ00sSUFBSSxDQUFDO1lBQ3ZCQyxTQUFTO1lBQ1RhLE1BQU07Z0JBQ0p3QixVQUFVO29CQUNSQyxlQUFlakMsZ0JBQWdCO29CQUMvQmtDLGdCQUFnQjlCLGlCQUFpQjtvQkFDakMrQixhQUFhN0IsY0FBYztvQkFDM0I4QixlQUFlN0IsZ0JBQWdCO29CQUMvQjhCLG9CQUFvQmxCLGlCQUFpQjtnQkFDdkM7Z0JBQ0FtQixTQUFTNUIsY0FBYyxDQUFDO2dCQUN4QjZCLGdCQUFnQlgsaUJBQWlCLENBQUM7WUFDcEM7UUFDRjtJQUNGLEVBQUUsT0FBT2hDLE9BQU87UUFDZDRDLFFBQVE1QyxLQUFLLENBQUMsb0JBQW9CQTtRQUNsQyxPQUFPUixxREFBWUEsQ0FBQ00sSUFBSSxDQUN0QjtZQUFFQyxTQUFTO1lBQU9DLE9BQU87UUFBOEMsR0FDdkU7WUFBRUMsUUFBUTtRQUFJO0lBRWxCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYXJlbnRpbmctc2Nob29sLXBsYXRmb3JtLy4vc3JjL2FwcC9hcGkvc3VwZXJhZG1pbi9zdGF0cy9yb3V0ZS50cz82ZjExIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcic7XG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAL2xpYi9zdXBhYmFzZS9zZXJ2ZXInO1xuaW1wb3J0IHsgaXNTdXBlckFkbWluIH0gZnJvbSAnQC9saWIvdGVuYW50L2F1dGgnO1xuXG4vLyBHRVQgLSBHZXQgcGxhdGZvcm0td2lkZSBzdGF0aXN0aWNzIChTdXBlciBBZG1pbiBvbmx5KVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIENoZWNrIGlmIHVzZXIgaXMgc3VwZXIgYWRtaW5cbiAgICBjb25zdCBpc1N1cGVyID0gYXdhaXQgaXNTdXBlckFkbWluKCk7XG4gICAgaWYgKCFpc1N1cGVyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnU3VwZXIgYWRtaW4gYWNjZXNzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAzIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIC8vIEdldCB0b3RhbCB0ZW5hbnQgY291bnRcbiAgICBjb25zdCB7IGNvdW50OiB0b3RhbFRlbmFudHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndGVuYW50cycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KTtcblxuICAgIC8vIEdldCBhY3RpdmUgdGVuYW50IGNvdW50XG4gICAgY29uc3QgeyBjb3VudDogYWN0aXZlVGVuYW50cyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRzJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pXG4gICAgICAuZXEoJ3N0YXR1cycsICdhY3RpdmUnKTtcblxuICAgIC8vIEdldCB0b3RhbCB1c2VyIGNvdW50XG4gICAgY29uc3QgeyBjb3VudDogdG90YWxVc2VycyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRfdXNlcnMnKVxuICAgICAgLnNlbGVjdCgnKicsIHsgY291bnQ6ICdleGFjdCcsIGhlYWQ6IHRydWUgfSlcbiAgICAgIC5lcSgnc3RhdHVzJywgJ2FjdGl2ZScpO1xuXG4gICAgLy8gR2V0IHRvdGFsIGNvdXJzZSBjb3VudFxuICAgIGNvbnN0IHsgY291bnQ6IHRvdGFsQ291cnNlcyB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdjb3Vyc2VzJylcbiAgICAgIC5zZWxlY3QoJyonLCB7IGNvdW50OiAnZXhhY3QnLCBoZWFkOiB0cnVlIH0pO1xuXG4gICAgLy8gR2V0IHRlbmFudHMgYnkgc3Vic2NyaXB0aW9uIHRpZXJcbiAgICBjb25zdCB7IGRhdGE6IHRpZXJEYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3RlbmFudHMnKVxuICAgICAgLnNlbGVjdCgnc3Vic2NyaXB0aW9uX3RpZXInKVxuICAgICAgLmVxKCdzdGF0dXMnLCAnYWN0aXZlJyk7XG5cbiAgICBjb25zdCB0aWVyQ291bnRzID0gdGllckRhdGE/LnJlZHVjZSgoYWNjOiBhbnksIHQ6IGFueSkgPT4ge1xuICAgICAgYWNjW3Quc3Vic2NyaXB0aW9uX3RpZXJdID0gKGFjY1t0LnN1YnNjcmlwdGlvbl90aWVyXSB8fCAwKSArIDE7XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sIHt9KTtcblxuICAgIC8vIEdldCByZWNlbnQgdGVuYW50cyAobGFzdCAzMCBkYXlzKVxuICAgIGNvbnN0IHRoaXJ0eURheXNBZ28gPSBuZXcgRGF0ZSgpO1xuICAgIHRoaXJ0eURheXNBZ28uc2V0RGF0ZSh0aGlydHlEYXlzQWdvLmdldERhdGUoKSAtIDMwKTtcblxuICAgIGNvbnN0IHsgY291bnQ6IHJlY2VudFRlbmFudHMgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgndGVuYW50cycpXG4gICAgICAuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JywgaGVhZDogdHJ1ZSB9KVxuICAgICAgLmd0ZSgnY3JlYXRlZF9hdCcsIHRoaXJ0eURheXNBZ28udG9JU09TdHJpbmcoKSk7XG5cbiAgICAvLyBHZXQgdGVuYW50IGdyb3d0aCBieSBtb250aCAobGFzdCA2IG1vbnRocylcbiAgICBjb25zdCBzaXhNb250aHNBZ28gPSBuZXcgRGF0ZSgpO1xuICAgIHNpeE1vbnRoc0Fnby5zZXRNb250aChzaXhNb250aHNBZ28uZ2V0TW9udGgoKSAtIDYpO1xuXG4gICAgY29uc3QgeyBkYXRhOiBncm93dGhEYXRhIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ3RlbmFudHMnKVxuICAgICAgLnNlbGVjdCgnY3JlYXRlZF9hdCcpXG4gICAgICAuZ3RlKCdjcmVhdGVkX2F0Jywgc2l4TW9udGhzQWdvLnRvSVNPU3RyaW5nKCkpXG4gICAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogdHJ1ZSB9KTtcblxuICAgIGNvbnN0IG1vbnRobHlHcm93dGggPSBncm93dGhEYXRhPy5yZWR1Y2UoKGFjYzogYW55LCB0OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IG1vbnRoID0gbmV3IERhdGUodC5jcmVhdGVkX2F0KS50b0lTT1N0cmluZygpLnN1YnN0cmluZygwLCA3KTsgLy8gWVlZWS1NTVxuICAgICAgYWNjW21vbnRoXSA9IChhY2NbbW9udGhdIHx8IDApICsgMTtcbiAgICAgIHJldHVybiBhY2M7XG4gICAgfSwge30pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiB7XG4gICAgICAgIG92ZXJ2aWV3OiB7XG4gICAgICAgICAgdG90YWxfdGVuYW50czogdG90YWxUZW5hbnRzIHx8IDAsXG4gICAgICAgICAgYWN0aXZlX3RlbmFudHM6IGFjdGl2ZVRlbmFudHMgfHwgMCxcbiAgICAgICAgICB0b3RhbF91c2VyczogdG90YWxVc2VycyB8fCAwLFxuICAgICAgICAgIHRvdGFsX2NvdXJzZXM6IHRvdGFsQ291cnNlcyB8fCAwLFxuICAgICAgICAgIHJlY2VudF90ZW5hbnRzXzMwZDogcmVjZW50VGVuYW50cyB8fCAwLFxuICAgICAgICB9LFxuICAgICAgICBieV90aWVyOiB0aWVyQ291bnRzIHx8IHt9LFxuICAgICAgICBtb250aGx5X2dyb3d0aDogbW9udGhseUdyb3d0aCB8fCB7fSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2V0IHN0YXRzIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIHN0YXRpc3RpY3MnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlQ2xpZW50IiwiaXNTdXBlckFkbWluIiwiR0VUIiwicmVxdWVzdCIsImlzU3VwZXIiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwic3RhdHVzIiwic3VwYWJhc2UiLCJjb3VudCIsInRvdGFsVGVuYW50cyIsImZyb20iLCJzZWxlY3QiLCJoZWFkIiwiYWN0aXZlVGVuYW50cyIsImVxIiwidG90YWxVc2VycyIsInRvdGFsQ291cnNlcyIsImRhdGEiLCJ0aWVyRGF0YSIsInRpZXJDb3VudHMiLCJyZWR1Y2UiLCJhY2MiLCJ0Iiwic3Vic2NyaXB0aW9uX3RpZXIiLCJ0aGlydHlEYXlzQWdvIiwiRGF0ZSIsInNldERhdGUiLCJnZXREYXRlIiwicmVjZW50VGVuYW50cyIsImd0ZSIsInRvSVNPU3RyaW5nIiwic2l4TW9udGhzQWdvIiwic2V0TW9udGgiLCJnZXRNb250aCIsImdyb3d0aERhdGEiLCJvcmRlciIsImFzY2VuZGluZyIsIm1vbnRobHlHcm93dGgiLCJtb250aCIsImNyZWF0ZWRfYXQiLCJzdWJzdHJpbmciLCJvdmVydmlldyIsInRvdGFsX3RlbmFudHMiLCJhY3RpdmVfdGVuYW50cyIsInRvdGFsX3VzZXJzIiwidG90YWxfY291cnNlcyIsInJlY2VudF90ZW5hbnRzXzMwZCIsImJ5X3RpZXIiLCJtb250aGx5X2dyb3d0aCIsImNvbnNvbGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/superadmin/stats/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminClient: () => (/* binding */ createAdminClient),\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n\n// Regular authenticated client (subject to RLS)\nasync function createClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const client = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRnZG9uZHN2dHFicW5zZWNiYXl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNjQ3ODIsImV4cCI6MjA3Nzg0MDc4Mn0.vJCiJGwPGhy_q7avgMnsjihi4i1a7GFUwoGv3Go-9c0\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // The `set` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // The `delete` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n    // Set tenant context if multitenancy is enabled\n    if (true) {\n        try {\n            const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.headers)();\n            const tenantSlug = headersList.get(\"x-tenant-slug\");\n            if (tenantSlug) {\n                // Get tenant ID from slug\n                const { data: tenant } = await client.rpc(\"get_tenant_by_slug\", {\n                    p_slug: tenantSlug\n                }).single();\n                const typedTenant = tenant;\n                if (typedTenant?.id) {\n                    // Set current tenant in database session\n                    await client.rpc(\"set_current_tenant\", {\n                        p_tenant_id: typedTenant.id\n                    });\n                }\n            }\n        } catch (error) {\n            console.error(\"Error setting tenant context:\", error);\n        // Don't fail the request, just log the error\n        }\n    }\n    return client;\n}\n// Admin client with service role (bypasses RLS)\n// Use this for admin operations that need to bypass RLS policies\nfunction createAdminClient() {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFnRDtBQUN1QjtBQUNNO0FBRTdFLGdEQUFnRDtBQUN6QyxlQUFlRztJQUNwQixNQUFNRSxjQUFjLE1BQU1MLHFEQUFPQTtJQUVqQyxNQUFNTSxTQUFTSixpRUFBa0JBLENBQy9CSywwQ0FBb0MsRUFDcENBLGtOQUF5QyxFQUN6QztRQUNFUCxTQUFTO1lBQ1BXLEtBQUlDLElBQVk7Z0JBQ2QsT0FBT1AsWUFBWU0sR0FBRyxDQUFDQyxPQUFPQztZQUNoQztZQUNBQyxLQUFJRixJQUFZLEVBQUVDLEtBQWEsRUFBRUUsT0FBc0I7Z0JBQ3JELElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DO3dCQUFPLEdBQUdFLE9BQU87b0JBQUM7Z0JBQzVDLEVBQUUsT0FBT0MsT0FBTztnQkFDZCx1REFBdUQ7Z0JBQ3ZELHdEQUF3RDtnQkFDeEQsaUJBQWlCO2dCQUNuQjtZQUNGO1lBQ0FDLFFBQU9MLElBQVksRUFBRUcsT0FBc0I7Z0JBQ3pDLElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DLE9BQU87d0JBQUksR0FBR0UsT0FBTztvQkFBQztnQkFDaEQsRUFBRSxPQUFPQyxPQUFPO2dCQUNkLDBEQUEwRDtnQkFDMUQsd0RBQXdEO2dCQUN4RCxpQkFBaUI7Z0JBQ25CO1lBQ0Y7UUFDRjtJQUNGO0lBR0YsZ0RBQWdEO0lBQ2hELElBQUlULElBQWlELEVBQVE7UUFDM0QsSUFBSTtZQUNGLE1BQU1ZLGNBQWMsTUFBTWxCLHFEQUFPQTtZQUNqQyxNQUFNbUIsYUFBYUQsWUFBWVIsR0FBRyxDQUFDO1lBRW5DLElBQUlTLFlBQVk7Z0JBQ2QsMEJBQTBCO2dCQUMxQixNQUFNLEVBQUVDLE1BQU1DLE1BQU0sRUFBRSxHQUFHLE1BQU1oQixPQUM1QmlCLEdBQUcsQ0FBQyxzQkFBc0I7b0JBQUVDLFFBQVFKO2dCQUFXLEdBQy9DSyxNQUFNO2dCQUVULE1BQU1DLGNBQWNKO2dCQUNwQixJQUFJSSxhQUFhQyxJQUFJO29CQUNuQix5Q0FBeUM7b0JBQ3pDLE1BQU1yQixPQUFPaUIsR0FBRyxDQUFDLHNCQUFzQjt3QkFBRUssYUFBYUYsWUFBWUMsRUFBRTtvQkFBQztnQkFDdkU7WUFDRjtRQUNGLEVBQUUsT0FBT1gsT0FBTztZQUNkYSxRQUFRYixLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyw2Q0FBNkM7UUFDL0M7SUFDRjtJQUVBLE9BQU9WO0FBQ1Q7QUFFQSxnREFBZ0Q7QUFDaEQsaUVBQWlFO0FBQzFELFNBQVN3QjtJQUNkLE9BQU8xQixtRUFBb0JBLENBQ3pCRywwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ3VCLHlCQUF5QixFQUNyQztRQUNFQyxNQUFNO1lBQ0pDLGtCQUFrQjtZQUNsQkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhcmVudGluZy1zY2hvb2wtcGxhdGZvcm0vLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cz8yZThlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMsIGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCBhcyBjcmVhdGVTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbi8vIFJlZ3VsYXIgYXV0aGVudGljYXRlZCBjbGllbnQgKHN1YmplY3QgdG8gUkxTKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNsaWVudCgpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG5cbiAgY29uc3QgY2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXQobmFtZSk/LnZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYHNldGAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IENvb2tpZU9wdGlvbnMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6ICcnLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYGRlbGV0ZWAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH1cbiAgKTtcblxuICAvLyBTZXQgdGVuYW50IGNvbnRleHQgaWYgbXVsdGl0ZW5hbmN5IGlzIGVuYWJsZWRcbiAgaWYgKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01VTFRJVEVOQU5DWV9FTkFCTEVEID09PSAndHJ1ZScpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGVhZGVyc0xpc3QgPSBhd2FpdCBoZWFkZXJzKCk7XG4gICAgICBjb25zdCB0ZW5hbnRTbHVnID0gaGVhZGVyc0xpc3QuZ2V0KCd4LXRlbmFudC1zbHVnJyk7XG5cbiAgICAgIGlmICh0ZW5hbnRTbHVnKSB7XG4gICAgICAgIC8vIEdldCB0ZW5hbnQgSUQgZnJvbSBzbHVnXG4gICAgICAgIGNvbnN0IHsgZGF0YTogdGVuYW50IH0gPSBhd2FpdCBjbGllbnRcbiAgICAgICAgICAucnBjKCdnZXRfdGVuYW50X2J5X3NsdWcnLCB7IHBfc2x1ZzogdGVuYW50U2x1ZyB9KVxuICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICBjb25zdCB0eXBlZFRlbmFudCA9IHRlbmFudCBhcyB7IGlkOiBzdHJpbmc7IHNsdWc6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0gfCBudWxsO1xuICAgICAgICBpZiAodHlwZWRUZW5hbnQ/LmlkKSB7XG4gICAgICAgICAgLy8gU2V0IGN1cnJlbnQgdGVuYW50IGluIGRhdGFiYXNlIHNlc3Npb25cbiAgICAgICAgICBhd2FpdCBjbGllbnQucnBjKCdzZXRfY3VycmVudF90ZW5hbnQnLCB7IHBfdGVuYW50X2lkOiB0eXBlZFRlbmFudC5pZCB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHRlbmFudCBjb250ZXh0OicsIGVycm9yKTtcbiAgICAgIC8vIERvbid0IGZhaWwgdGhlIHJlcXVlc3QsIGp1c3QgbG9nIHRoZSBlcnJvclxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjbGllbnQ7XG59XG5cbi8vIEFkbWluIGNsaWVudCB3aXRoIHNlcnZpY2Ugcm9sZSAoYnlwYXNzZXMgUkxTKVxuLy8gVXNlIHRoaXMgZm9yIGFkbWluIG9wZXJhdGlvbnMgdGhhdCBuZWVkIHRvIGJ5cGFzcyBSTFMgcG9saWNpZXNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBZG1pbkNsaWVudCgpIHtcbiAgcmV0dXJuIGNyZWF0ZVN1cGFiYXNlQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXG4gICAge1xuICAgICAgYXV0aDoge1xuICAgICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICApO1xufSJdLCJuYW1lcyI6WyJjb29raWVzIiwiaGVhZGVycyIsImNyZWF0ZVNlcnZlckNsaWVudCIsImNyZWF0ZUNsaWVudCIsImNyZWF0ZVN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJjbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwiZXJyb3IiLCJyZW1vdmUiLCJORVhUX1BVQkxJQ19NVUxUSVRFTkFOQ1lfRU5BQkxFRCIsImhlYWRlcnNMaXN0IiwidGVuYW50U2x1ZyIsImRhdGEiLCJ0ZW5hbnQiLCJycGMiLCJwX3NsdWciLCJzaW5nbGUiLCJ0eXBlZFRlbmFudCIsImlkIiwicF90ZW5hbnRfaWQiLCJjb25zb2xlIiwiY3JlYXRlQWRtaW5DbGllbnQiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/server.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant/auth.ts":
/*!********************************!*\
  !*** ./src/lib/tenant/auth.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   verifyTenantAdmin: () => (/* binding */ verifyTenantAdmin),\n/* harmony export */   verifyTenantMember: () => (/* binding */ verifyTenantMember)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _detection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./detection */ \"(rsc)/./src/lib/tenant/detection.ts\");\n\n\n/**\n * Verify that the current user is authenticated and is an admin/owner in the current tenant\n * @param request - The Next.js request object\n * @returns Object with user, tenant, and tenant user role, or null if unauthorized\n */ async function verifyTenantAdmin(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return null;\n        }\n        // Get current tenant\n        const tenant = await (0,_detection__WEBPACK_IMPORTED_MODULE_1__.getCurrentTenant)(request);\n        if (!tenant) {\n            return null;\n        }\n        // Check if user is admin/owner in this tenant\n        const { data: tenantUser } = await supabase.from(\"tenant_users\").select(\"role, status\").eq(\"tenant_id\", tenant.id).eq(\"user_id\", user.id).single();\n        if (!tenantUser || tenantUser.status !== \"active\") {\n            return null;\n        }\n        if (![\n            \"owner\",\n            \"admin\"\n        ].includes(tenantUser.role)) {\n            return null;\n        }\n        return {\n            user,\n            tenant,\n            tenantRole: tenantUser.role\n        };\n    } catch (error) {\n        console.error(\"Error verifying tenant admin:\", error);\n        return null;\n    }\n}\n/**\n * Verify that the current user is authenticated and belongs to the current tenant\n * @param request - The Next.js request object\n * @returns Object with user, tenant, and tenant user role, or null if unauthorized\n */ async function verifyTenantMember(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return null;\n        }\n        // Get current tenant\n        const tenant = await (0,_detection__WEBPACK_IMPORTED_MODULE_1__.getCurrentTenant)(request);\n        if (!tenant) {\n            return null;\n        }\n        // Check if user belongs to this tenant\n        const { data: tenantUser } = await supabase.from(\"tenant_users\").select(\"role, status\").eq(\"tenant_id\", tenant.id).eq(\"user_id\", user.id).single();\n        if (!tenantUser || tenantUser.status !== \"active\") {\n            return null;\n        }\n        return {\n            user,\n            tenant,\n            tenantRole: tenantUser.role\n        };\n    } catch (error) {\n        console.error(\"Error verifying tenant member:\", error);\n        return null;\n    }\n}\n/**\n * Check if the current user is a super admin\n * @returns boolean indicating if user is super admin\n */ async function isSuperAdmin() {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return false;\n        }\n        const { data } = await supabase.rpc(\"is_super_admin\", {\n            p_user_id: user.id\n        });\n        return data === true;\n    } catch (error) {\n        console.error(\"Error checking super admin status:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYXJlbnRpbmctc2Nob29sLXBsYXRmb3JtLy4vc3JjL2xpYi90ZW5hbnQvYXV0aC50cz9mZjVmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcic7XG5pbXBvcnQgeyBnZXRDdXJyZW50VGVuYW50IH0gZnJvbSAnLi9kZXRlY3Rpb24nO1xuXG4vKipcbiAqIFZlcmlmeSB0aGF0IHRoZSBjdXJyZW50IHVzZXIgaXMgYXV0aGVudGljYXRlZCBhbmQgaXMgYW4gYWRtaW4vb3duZXIgaW4gdGhlIGN1cnJlbnQgdGVuYW50XG4gKiBAcGFyYW0gcmVxdWVzdCAtIFRoZSBOZXh0LmpzIHJlcXVlc3Qgb2JqZWN0XG4gKiBAcmV0dXJucyBPYmplY3Qgd2l0aCB1c2VyLCB0ZW5hbnQsIGFuZCB0ZW5hbnQgdXNlciByb2xlLCBvciBudWxsIGlmIHVuYXV0aG9yaXplZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VGVuYW50QWRtaW4ocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcblxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gR2V0IGN1cnJlbnQgdGVuYW50XG4gICAgY29uc3QgdGVuYW50ID0gYXdhaXQgZ2V0Q3VycmVudFRlbmFudChyZXF1ZXN0KTtcbiAgICBpZiAoIXRlbmFudCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdXNlciBpcyBhZG1pbi9vd25lciBpbiB0aGlzIHRlbmFudFxuICAgIGNvbnN0IHsgZGF0YTogdGVuYW50VXNlciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRfdXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZSwgc3RhdHVzJylcbiAgICAgIC5lcSgndGVuYW50X2lkJywgdGVuYW50LmlkKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICghdGVuYW50VXNlciB8fCB0ZW5hbnRVc2VyLnN0YXR1cyAhPT0gJ2FjdGl2ZScpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmICghWydvd25lcicsICdhZG1pbiddLmluY2x1ZGVzKHRlbmFudFVzZXIucm9sZSkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1c2VyLFxuICAgICAgdGVuYW50LFxuICAgICAgdGVuYW50Um9sZTogdGVuYW50VXNlci5yb2xlLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHRlbmFudCBhZG1pbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgdGhhdCB0aGUgY3VycmVudCB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgYW5kIGJlbG9uZ3MgdG8gdGhlIGN1cnJlbnQgdGVuYW50XG4gKiBAcGFyYW0gcmVxdWVzdCAtIFRoZSBOZXh0LmpzIHJlcXVlc3Qgb2JqZWN0XG4gKiBAcmV0dXJucyBPYmplY3Qgd2l0aCB1c2VyLCB0ZW5hbnQsIGFuZCB0ZW5hbnQgdXNlciByb2xlLCBvciBudWxsIGlmIHVuYXV0aG9yaXplZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VGVuYW50TWVtYmVyKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgLy8gQ2hlY2sgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIEdldCBjdXJyZW50IHRlbmFudFxuICAgIGNvbnN0IHRlbmFudCA9IGF3YWl0IGdldEN1cnJlbnRUZW5hbnQocmVxdWVzdCk7XG4gICAgaWYgKCF0ZW5hbnQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHVzZXIgYmVsb25ncyB0byB0aGlzIHRlbmFudFxuICAgIGNvbnN0IHsgZGF0YTogdGVuYW50VXNlciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRfdXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZSwgc3RhdHVzJylcbiAgICAgIC5lcSgndGVuYW50X2lkJywgdGVuYW50LmlkKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICghdGVuYW50VXNlciB8fCB0ZW5hbnRVc2VyLnN0YXR1cyAhPT0gJ2FjdGl2ZScpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1c2VyLFxuICAgICAgdGVuYW50LFxuICAgICAgdGVuYW50Um9sZTogdGVuYW50VXNlci5yb2xlLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHRlbmFudCBtZW1iZXI6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhIHN1cGVyIGFkbWluXG4gKiBAcmV0dXJucyBib29sZWFuIGluZGljYXRpbmcgaWYgdXNlciBpcyBzdXBlciBhZG1pblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNTdXBlckFkbWluKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygnaXNfc3VwZXJfYWRtaW4nLCB7IHBfdXNlcl9pZDogdXNlci5pZCB9KTtcbiAgICByZXR1cm4gZGF0YSA9PT0gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBzdXBlciBhZG1pbiBzdGF0dXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImdldEN1cnJlbnRUZW5hbnQiLCJ2ZXJpZnlUZW5hbnRBZG1pbiIsInJlcXVlc3QiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiYXV0aCIsImdldFVzZXIiLCJ0ZW5hbnQiLCJ0ZW5hbnRVc2VyIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJzaW5nbGUiLCJzdGF0dXMiLCJpbmNsdWRlcyIsInJvbGUiLCJ0ZW5hbnRSb2xlIiwiZXJyb3IiLCJjb25zb2xlIiwidmVyaWZ5VGVuYW50TWVtYmVyIiwiaXNTdXBlckFkbWluIiwicnBjIiwicF91c2VyX2lkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant/detection.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant/detection.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentTenant: () => (/* binding */ getCurrentTenant),\n/* harmony export */   getTenantByDomain: () => (/* binding */ getTenantByDomain),\n/* harmony export */   getTenantBySlug: () => (/* binding */ getTenantBySlug),\n/* harmony export */   getTenantSlugFromHeaders: () => (/* binding */ getTenantSlugFromHeaders),\n/* harmony export */   getTenantSlugFromPath: () => (/* binding */ getTenantSlugFromPath),\n/* harmony export */   getUserTenantRole: () => (/* binding */ getUserTenantRole),\n/* harmony export */   getUserTenants: () => (/* binding */ getUserTenants),\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   validateUserTenantAccess: () => (/* binding */ validateUserTenantAccess)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n// ============================================================================\n// MULTITENANCY: TENANT DETECTION\n// ============================================================================\n// Functions for detecting and retrieving tenant information\n// ============================================================================\n\n/**\n * Get tenant slug from request headers (set by middleware)\n */ function getTenantSlugFromHeaders(headers) {\n    return headers.get(\"x-tenant-slug\");\n}\n/**\n * Get tenant by slug from database\n */ async function getTenantBySlug(slug) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_tenant_by_slug\", {\n            p_slug: slug\n        }).single();\n        if (error) {\n            console.error(\"Error fetching tenant by slug:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getTenantBySlug:\", error);\n        return null;\n    }\n}\n/**\n * Get tenant by custom domain\n */ async function getTenantByDomain(domain) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_tenant_by_domain\", {\n            p_domain: domain\n        }).single();\n        if (error) {\n            console.error(\"Error fetching tenant by domain:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getTenantByDomain:\", error);\n        return null;\n    }\n}\n/**\n * Extract tenant slug from URL path\n * Supports path-based routing: /org/{slug}/...\n */ function getTenantSlugFromPath(url) {\n    try {\n        const urlObj = new URL(url);\n        const pathMatch = urlObj.pathname.match(/^\\/org\\/([a-z0-9][a-z0-9-]{1,61}[a-z0-9])/);\n        return pathMatch ? pathMatch[1] : null;\n    } catch  {\n        return null;\n    }\n}\n/**\n * Get current tenant from request\n * Priority:\n * 1. Path-based routing (/org/{slug}) - for localhost testing\n * 2. Custom domain\n * 3. Subdomain from headers\n * 4. Default tenant (localhost fallback)\n */ async function getCurrentTenant(request) {\n    const headers = new Headers(request.headers);\n    const hostname = headers.get(\"host\") || \"\";\n    const url = request.url;\n    const defaultTenantSlug = \"default\" || 0;\n    // For local development with path-based routing\n    if (hostname.includes(\"localhost\") || hostname.includes(\"127.0.0.1\")) {\n        // Check for path-based tenant: /org/{slug}/...\n        const pathSlug = getTenantSlugFromPath(url);\n        if (pathSlug) {\n            const tenant = await getTenantBySlug(pathSlug);\n            if (tenant) {\n                return tenant;\n            }\n        }\n        // Fall back to default tenant for localhost\n        return getTenantBySlug(defaultTenantSlug);\n    }\n    // Production: Try custom domain first\n    let tenant = await getTenantByDomain(hostname);\n    if (tenant) {\n        return tenant;\n    }\n    // Fall back to subdomain from middleware\n    const tenantSlug = getTenantSlugFromHeaders(headers);\n    if (tenantSlug) {\n        tenant = await getTenantBySlug(tenantSlug);\n    }\n    return tenant;\n}\n/**\n * Validate that a user belongs to a tenant\n */ async function validateUserTenantAccess(userId, tenantId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"user_belongs_to_tenant\", {\n            p_user_id: userId,\n            p_tenant_id: tenantId\n        });\n        if (error) {\n            console.error(\"Error validating tenant access:\", error);\n            return false;\n        }\n        return data === true;\n    } catch (error) {\n        console.error(\"Error in validateUserTenantAccess:\", error);\n        return false;\n    }\n}\n/**\n * Get user's role in a tenant\n */ async function getUserTenantRole(userId, tenantId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_user_tenant_role\", {\n            p_user_id: userId,\n            p_tenant_id: tenantId\n        });\n        if (error) {\n            console.error(\"Error fetching user tenant role:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getUserTenantRole:\", error);\n        return null;\n    }\n}\n/**\n * Get all tenants a user belongs to\n */ async function getUserTenants(userId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_user_tenants\", {\n            p_user_id: userId\n        });\n        if (error) {\n            console.error(\"Error fetching user tenants:\", error);\n            return [];\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error in getUserTenants:\", error);\n        return [];\n    }\n}\n/**\n * Check if user is a super admin\n */ async function isSuperAdmin(userId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"is_super_admin\", {\n            p_user_id: userId\n        });\n        if (error) {\n            console.error(\"Error checking super admin status:\", error);\n            return false;\n        }\n        return data === true;\n    } catch (error) {\n        console.error(\"Error in isSuperAdmin:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWVrQyxhQUFhTixNQUFjO0lBQy9DLElBQUk7UUFDRixNQUFNOUIsV0FBVyxNQUFNTixrRUFBWUE7UUFFbkMsTUFBTSxFQUFFTyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLFNBQzNCRyxHQUFHLENBQUMsa0JBQWtCO1lBQUU2QixXQUFXRjtRQUFPO1FBRTdDLElBQUk1QixPQUFPO1lBQ1RJLFFBQVFKLEtBQUssQ0FBQyxzQ0FBc0NBO1lBQ3BELE9BQU87UUFDVDtRQUVBLE9BQU9ELFNBQVM7SUFDbEIsRUFBRSxPQUFPQyxPQUFPO1FBQ2RJLFFBQVFKLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8uL3NyYy9saWIvdGVuYW50L2RldGVjdGlvbi50cz8yZWY0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1VTFRJVEVOQU5DWTogVEVOQU5UIERFVEVDVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRnVuY3Rpb25zIGZvciBkZXRlY3RpbmcgYW5kIHJldHJpZXZpbmcgdGVuYW50IGluZm9ybWF0aW9uXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcic7XG5pbXBvcnQgdHlwZSB7IFRlbmFudCB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIEdldCB0ZW5hbnQgc2x1ZyBmcm9tIHJlcXVlc3QgaGVhZGVycyAoc2V0IGJ5IG1pZGRsZXdhcmUpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMoaGVhZGVyczogSGVhZGVycyk6IHN0cmluZyB8IG51bGwge1xuICByZXR1cm4gaGVhZGVycy5nZXQoJ3gtdGVuYW50LXNsdWcnKTtcbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGJ5IHNsdWcgZnJvbSBkYXRhYmFzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGVuYW50QnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8VGVuYW50IHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLnJwYygnZ2V0X3RlbmFudF9ieV9zbHVnJywgeyBwX3NsdWc6IHNsdWcgfSlcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdGVuYW50IGJ5IHNsdWc6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgYXMgVGVuYW50O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldFRlbmFudEJ5U2x1ZzonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGJ5IGN1c3RvbSBkb21haW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRlbmFudEJ5RG9tYWluKGRvbWFpbjogc3RyaW5nKTogUHJvbWlzZTxUZW5hbnQgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAucnBjKCdnZXRfdGVuYW50X2J5X2RvbWFpbicsIHsgcF9kb21haW46IGRvbWFpbiB9KVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0ZW5hbnQgYnkgZG9tYWluOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhIGFzIFRlbmFudDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBnZXRUZW5hbnRCeURvbWFpbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBFeHRyYWN0IHRlbmFudCBzbHVnIGZyb20gVVJMIHBhdGhcbiAqIFN1cHBvcnRzIHBhdGgtYmFzZWQgcm91dGluZzogL29yZy97c2x1Z30vLi4uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZW5hbnRTbHVnRnJvbVBhdGgodXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgY29uc3QgcGF0aE1hdGNoID0gdXJsT2JqLnBhdGhuYW1lLm1hdGNoKC9eXFwvb3JnXFwvKFthLXowLTldW2EtejAtOS1dezEsNjF9W2EtejAtOV0pLyk7XG4gICAgcmV0dXJuIHBhdGhNYXRjaCA/IHBhdGhNYXRjaFsxXSA6IG51bGw7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgdGVuYW50IGZyb20gcmVxdWVzdFxuICogUHJpb3JpdHk6XG4gKiAxLiBQYXRoLWJhc2VkIHJvdXRpbmcgKC9vcmcve3NsdWd9KSAtIGZvciBsb2NhbGhvc3QgdGVzdGluZ1xuICogMi4gQ3VzdG9tIGRvbWFpblxuICogMy4gU3ViZG9tYWluIGZyb20gaGVhZGVyc1xuICogNC4gRGVmYXVsdCB0ZW5hbnQgKGxvY2FsaG9zdCBmYWxsYmFjaylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRUZW5hbnQocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8VGVuYW50IHwgbnVsbD4ge1xuICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMocmVxdWVzdC5oZWFkZXJzKTtcbiAgY29uc3QgaG9zdG5hbWUgPSBoZWFkZXJzLmdldCgnaG9zdCcpIHx8ICcnO1xuICBjb25zdCB1cmwgPSByZXF1ZXN0LnVybDtcbiAgY29uc3QgZGVmYXVsdFRlbmFudFNsdWcgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19ERUZBVUxUX1RFTkFOVF9TTFVHIHx8ICdkZWZhdWx0JztcblxuICAvLyBGb3IgbG9jYWwgZGV2ZWxvcG1lbnQgd2l0aCBwYXRoLWJhc2VkIHJvdXRpbmdcbiAgaWYgKGhvc3RuYW1lLmluY2x1ZGVzKCdsb2NhbGhvc3QnKSB8fCBob3N0bmFtZS5pbmNsdWRlcygnMTI3LjAuMC4xJykpIHtcbiAgICAvLyBDaGVjayBmb3IgcGF0aC1iYXNlZCB0ZW5hbnQ6IC9vcmcve3NsdWd9Ly4uLlxuICAgIGNvbnN0IHBhdGhTbHVnID0gZ2V0VGVuYW50U2x1Z0Zyb21QYXRoKHVybCk7XG4gICAgaWYgKHBhdGhTbHVnKSB7XG4gICAgICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBnZXRUZW5hbnRCeVNsdWcocGF0aFNsdWcpO1xuICAgICAgaWYgKHRlbmFudCkge1xuICAgICAgICByZXR1cm4gdGVuYW50O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZhbGwgYmFjayB0byBkZWZhdWx0IHRlbmFudCBmb3IgbG9jYWxob3N0XG4gICAgcmV0dXJuIGdldFRlbmFudEJ5U2x1ZyhkZWZhdWx0VGVuYW50U2x1Zyk7XG4gIH1cblxuICAvLyBQcm9kdWN0aW9uOiBUcnkgY3VzdG9tIGRvbWFpbiBmaXJzdFxuICBsZXQgdGVuYW50ID0gYXdhaXQgZ2V0VGVuYW50QnlEb21haW4oaG9zdG5hbWUpO1xuICBpZiAodGVuYW50KSB7XG4gICAgcmV0dXJuIHRlbmFudDtcbiAgfVxuXG4gIC8vIEZhbGwgYmFjayB0byBzdWJkb21haW4gZnJvbSBtaWRkbGV3YXJlXG4gIGNvbnN0IHRlbmFudFNsdWcgPSBnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMoaGVhZGVycyk7XG4gIGlmICh0ZW5hbnRTbHVnKSB7XG4gICAgdGVuYW50ID0gYXdhaXQgZ2V0VGVuYW50QnlTbHVnKHRlbmFudFNsdWcpO1xuICB9XG5cbiAgcmV0dXJuIHRlbmFudDtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSB0aGF0IGEgdXNlciBiZWxvbmdzIHRvIGEgdGVuYW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3MoXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5ycGMoJ3VzZXJfYmVsb25nc190b190ZW5hbnQnLCB7XG4gICAgICAgIHBfdXNlcl9pZDogdXNlcklkLFxuICAgICAgICBwX3RlbmFudF9pZDogdGVuYW50SWQsXG4gICAgICB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdmFsaWRhdGluZyB0ZW5hbnQgYWNjZXNzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YSA9PT0gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB1c2VyJ3Mgcm9sZSBpbiBhIHRlbmFudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclRlbmFudFJvbGUoXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5ycGMoJ2dldF91c2VyX3RlbmFudF9yb2xlJywge1xuICAgICAgICBwX3VzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgcF90ZW5hbnRfaWQ6IHRlbmFudElkLFxuICAgICAgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgdGVuYW50IHJvbGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlclRlbmFudFJvbGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGFsbCB0ZW5hbnRzIGEgdXNlciBiZWxvbmdzIHRvXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyVGVuYW50cyh1c2VySWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLnJwYygnZ2V0X3VzZXJfdGVuYW50cycsIHsgcF91c2VyX2lkOiB1c2VySWQgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgdGVuYW50czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgfHwgW107XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlclRlbmFudHM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgYSBzdXBlciBhZG1pblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNTdXBlckFkbWluKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAucnBjKCdpc19zdXBlcl9hZG1pbicsIHsgcF91c2VyX2lkOiB1c2VySWQgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIHN1cGVyIGFkbWluIHN0YXR1czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgPT09IHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gaXNTdXBlckFkbWluOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0IiwiZ2V0VGVuYW50QnlTbHVnIiwic2x1ZyIsInN1cGFiYXNlIiwiZGF0YSIsImVycm9yIiwicnBjIiwicF9zbHVnIiwic2luZ2xlIiwiY29uc29sZSIsImdldFRlbmFudEJ5RG9tYWluIiwiZG9tYWluIiwicF9kb21haW4iLCJnZXRUZW5hbnRTbHVnRnJvbVBhdGgiLCJ1cmwiLCJ1cmxPYmoiLCJVUkwiLCJwYXRoTWF0Y2giLCJwYXRobmFtZSIsIm1hdGNoIiwiZ2V0Q3VycmVudFRlbmFudCIsInJlcXVlc3QiLCJIZWFkZXJzIiwiaG9zdG5hbWUiLCJkZWZhdWx0VGVuYW50U2x1ZyIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19ERUZBVUxUX1RFTkFOVF9TTFVHIiwiaW5jbHVkZXMiLCJwYXRoU2x1ZyIsInRlbmFudCIsInRlbmFudFNsdWciLCJ2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3MiLCJ1c2VySWQiLCJ0ZW5hbnRJZCIsInBfdXNlcl9pZCIsInBfdGVuYW50X2lkIiwiZ2V0VXNlclRlbmFudFJvbGUiLCJnZXRVc2VyVGVuYW50cyIsImlzU3VwZXJBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant/detection.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fsuperadmin%2Fstats%2Froute&page=%2Fapi%2Fsuperadmin%2Fstats%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fsuperadmin%2Fstats%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();