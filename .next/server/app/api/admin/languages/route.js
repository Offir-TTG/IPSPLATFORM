"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/admin/languages/route";
exports.ids = ["app/api/admin/languages/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Flanguages%2Froute&page=%2Fapi%2Fadmin%2Flanguages%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Flanguages%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Flanguages%2Froute&page=%2Fapi%2Fadmin%2Flanguages%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Flanguages%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_admin_languages_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/admin/languages/route.ts */ \"(rsc)/./src/app/api/admin/languages/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/admin/languages/route\",\n        pathname: \"/api/admin/languages\",\n        filename: \"route\",\n        bundlePath: \"app/api/admin/languages/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\OffirOmer\\\\Documents\\\\IPSPlatform\\\\src\\\\app\\\\api\\\\admin\\\\languages\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_admin_languages_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/admin/languages/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhZG1pbiUyRmxhbmd1YWdlcyUyRnJvdXRlJnBhZ2U9JTJGYXBpJTJGYWRtaW4lMkZsYW5ndWFnZXMlMkZyb3V0ZSZhcHBQYXRocz0mcGFnZVBhdGg9cHJpdmF0ZS1uZXh0LWFwcC1kaXIlMkZhcGklMkZhZG1pbiUyRmxhbmd1YWdlcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNPZmZpck9tZXIlNUNEb2N1bWVudHMlNUNJUFNQbGF0Zm9ybSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDT2ZmaXJPbWVyJTVDRG9jdW1lbnRzJTVDSVBTUGxhdGZvcm0maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ3VDO0FBQ3BIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8/MzA3YiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxPZmZpck9tZXJcXFxcRG9jdW1lbnRzXFxcXElQU1BsYXRmb3JtXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFkbWluXFxcXGxhbmd1YWdlc1xcXFxyb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvYWRtaW4vbGFuZ3VhZ2VzL3JvdXRlXCIsXG4gICAgICAgIHBhdGhuYW1lOiBcIi9hcGkvYWRtaW4vbGFuZ3VhZ2VzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9hZG1pbi9sYW5ndWFnZXMvcm91dGVcIlxuICAgIH0sXG4gICAgcmVzb2x2ZWRQYWdlUGF0aDogXCJDOlxcXFxVc2Vyc1xcXFxPZmZpck9tZXJcXFxcRG9jdW1lbnRzXFxcXElQU1BsYXRmb3JtXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGFkbWluXFxcXGxhbmd1YWdlc1xcXFxyb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHJlcXVlc3RBc3luY1N0b3JhZ2UsIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzIH0gPSByb3V0ZU1vZHVsZTtcbmNvbnN0IG9yaWdpbmFsUGF0aG5hbWUgPSBcIi9hcGkvYWRtaW4vbGFuZ3VhZ2VzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Flanguages%2Froute&page=%2Fapi%2Fadmin%2Flanguages%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Flanguages%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/admin/languages/route.ts":
/*!**********************************************!*\
  !*** ./src/app/api/admin/languages/route.ts ***!
  \**********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   DELETE: () => (/* binding */ DELETE),\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST),\n/* harmony export */   PUT: () => (/* binding */ PUT)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _lib_audit_auditService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/audit/auditService */ \"(rsc)/./src/lib/audit/auditService.ts\");\n/* harmony import */ var _lib_tenant_auth__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/lib/tenant/auth */ \"(rsc)/./src/lib/tenant/auth.ts\");\n\n\n\n\n// GET all languages\nasync function GET() {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { data: languages, error } = await supabase.from(\"languages\").select(\"*\").order(\"is_default\", {\n            ascending: false\n        }).order(\"name\");\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: languages\n        });\n    } catch (error) {\n        console.error(\"Get languages error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to fetch languages\"\n        }, {\n            status: 500\n        });\n    }\n}\n// POST - Create new language\nasync function POST(request) {\n    try {\n        // Verify tenant admin\n        const auth = await (0,_lib_tenant_auth__WEBPACK_IMPORTED_MODULE_3__.verifyTenantAdmin)(request);\n        if (!auth) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized or insufficient permissions\"\n            }, {\n                status: 403\n            });\n        }\n        const { user, tenant } = auth;\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { code, name, native_name, direction, is_active, is_default, currency_code, currency_symbol, currency_position } = await request.json();\n        if (!code || !name || !native_name || !direction) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Missing required fields\"\n            }, {\n                status: 400\n            });\n        }\n        // If setting as default, unset other defaults\n        if (is_default) {\n            await supabase.from(\"languages\").update({\n                is_default: false\n            }).neq(\"code\", code);\n        }\n        const { data: language, error } = await supabase.from(\"languages\").insert({\n            code,\n            name,\n            native_name,\n            direction,\n            is_active: is_active ?? true,\n            is_default: is_default ?? false,\n            currency_code,\n            currency_symbol,\n            currency_position\n        }).select().single();\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        // Audit log\n        await (0,_lib_audit_auditService__WEBPACK_IMPORTED_MODULE_2__.logAuditEvent)({\n            user_id: user.id,\n            event_type: \"CREATE\",\n            event_category: \"CONFIG\",\n            resource_type: \"language\",\n            resource_id: language.id,\n            resource_name: `${name} (${code})`,\n            action: \"Created language\",\n            description: `Created language: ${native_name} (${code})`,\n            new_values: {\n                code,\n                name,\n                native_name,\n                direction,\n                is_active,\n                is_default,\n                currency_code,\n                currency_symbol,\n                currency_position\n            },\n            status: \"success\",\n            risk_level: \"medium\",\n            metadata: {\n                direction,\n                is_default,\n                currency_code\n            }\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: language,\n            message: \"Language created successfully\"\n        });\n    } catch (error) {\n        console.error(\"Create language error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to create language\"\n        }, {\n            status: 500\n        });\n    }\n}\n// PUT - Update language\nasync function PUT(request) {\n    try {\n        // Verify tenant admin\n        const auth = await (0,_lib_tenant_auth__WEBPACK_IMPORTED_MODULE_3__.verifyTenantAdmin)(request);\n        if (!auth) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized or insufficient permissions\"\n            }, {\n                status: 403\n            });\n        }\n        const { user, tenant } = auth;\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { code, name, native_name, direction, is_active, is_default, currency_code, currency_symbol, currency_position } = await request.json();\n        if (!code) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Language code is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Get old values for audit\n        const { data: oldLanguage } = await supabase.from(\"languages\").select(\"*\").eq(\"code\", code).single();\n        // If setting as default, unset other defaults\n        if (is_default) {\n            await supabase.from(\"languages\").update({\n                is_default: false\n            }).neq(\"code\", code);\n        }\n        const updateData = {};\n        if (name) updateData.name = name;\n        if (native_name) updateData.native_name = native_name;\n        if (direction) updateData.direction = direction;\n        if (is_active !== undefined) updateData.is_active = is_active;\n        if (is_default !== undefined) updateData.is_default = is_default;\n        if (currency_code !== undefined) updateData.currency_code = currency_code;\n        if (currency_symbol !== undefined) updateData.currency_symbol = currency_symbol;\n        if (currency_position !== undefined) updateData.currency_position = currency_position;\n        const { data: language, error } = await supabase.from(\"languages\").update(updateData).eq(\"code\", code).select().single();\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        // Audit log\n        if (oldLanguage) {\n            const changedFields = Object.keys(updateData);\n            await (0,_lib_audit_auditService__WEBPACK_IMPORTED_MODULE_2__.logAuditEvent)({\n                user_id: user.id,\n                event_type: \"UPDATE\",\n                event_category: \"CONFIG\",\n                resource_type: \"language\",\n                resource_id: oldLanguage.id,\n                resource_name: `${oldLanguage.name} (${code})`,\n                action: \"Updated language\",\n                description: `Updated language: ${oldLanguage.native_name} (${code})`,\n                old_values: Object.fromEntries(changedFields.map((k)=>[\n                        k,\n                        oldLanguage[k]\n                    ])),\n                new_values: updateData,\n                status: \"success\",\n                risk_level: is_default ? \"high\" : \"medium\",\n                metadata: {\n                    direction: oldLanguage.direction,\n                    was_default: oldLanguage.is_default,\n                    is_default\n                }\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: language,\n            message: \"Language updated successfully\"\n        });\n    } catch (error) {\n        console.error(\"Update language error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to update language\"\n        }, {\n            status: 500\n        });\n    }\n}\n// DELETE - Delete language\nasync function DELETE(request) {\n    try {\n        // Verify tenant admin\n        const auth = await (0,_lib_tenant_auth__WEBPACK_IMPORTED_MODULE_3__.verifyTenantAdmin)(request);\n        if (!auth) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized or insufficient permissions\"\n            }, {\n                status: 403\n            });\n        }\n        const { user, tenant } = auth;\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        const { searchParams } = new URL(request.url);\n        const code = searchParams.get(\"code\");\n        if (!code) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Language code is required\"\n            }, {\n                status: 400\n            });\n        }\n        // Check if it's the default language\n        const { data: language } = await supabase.from(\"languages\").select(\"id, code, name, native_name, direction, is_default, is_active\").eq(\"code\", code).single();\n        if (language?.is_default) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Cannot delete default language\"\n            }, {\n                status: 400\n            });\n        }\n        const { error } = await supabase.from(\"languages\").delete().eq(\"code\", code);\n        if (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n        // Audit log\n        if (language) {\n            await (0,_lib_audit_auditService__WEBPACK_IMPORTED_MODULE_2__.logAuditEvent)({\n                user_id: user.id,\n                event_type: \"DELETE\",\n                event_category: \"CONFIG\",\n                resource_type: \"language\",\n                resource_id: language.id,\n                resource_name: `${language.name} (${code})`,\n                action: \"Deleted language\",\n                description: `Deleted language: ${language.native_name} (${code})`,\n                old_values: {\n                    code,\n                    name: language.name,\n                    native_name: language.native_name,\n                    direction: language.direction,\n                    is_active: language.is_active\n                },\n                status: \"success\",\n                risk_level: \"high\",\n                metadata: {\n                    direction: language.direction,\n                    was_default: language.is_default\n                }\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: \"Language deleted successfully\"\n        });\n    } catch (error) {\n        console.error(\"Delete language error:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Failed to delete language\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvYXBwL2FwaS9hZG1pbi9sYW5ndWFnZXMvcm91dGUudHMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7QUFBd0Q7QUFDSDtBQUNJO0FBQ0g7QUFFdEQsb0JBQW9CO0FBQ2IsZUFBZUk7SUFDcEIsSUFBSTtRQUNGLE1BQU1DLFdBQVcsTUFBTUosa0VBQVlBO1FBRW5DLE1BQU0sRUFBRUssTUFBTUMsU0FBUyxFQUFFQyxLQUFLLEVBQUUsR0FBRyxNQUFNSCxTQUN0Q0ksSUFBSSxDQUFDLGFBQ0xDLE1BQU0sQ0FBQyxLQUNQQyxLQUFLLENBQUMsY0FBYztZQUFFQyxXQUFXO1FBQU0sR0FDdkNELEtBQUssQ0FBQztRQUVULElBQUlILE9BQU87WUFDVCxPQUFPUixxREFBWUEsQ0FBQ2EsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT04sT0FBT0EsTUFBTU8sT0FBTztZQUFDLEdBQ3ZDO2dCQUFFQyxRQUFRO1lBQUk7UUFFbEI7UUFFQSxPQUFPaEIscURBQVlBLENBQUNhLElBQUksQ0FBQztZQUN2QkMsU0FBUztZQUNUUixNQUFNQztRQUNSO0lBQ0YsRUFBRSxPQUFPQyxPQUFPO1FBQ2RTLFFBQVFULEtBQUssQ0FBQyx3QkFBd0JBO1FBQ3RDLE9BQU9SLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT04sT0FBTztRQUE0QixHQUNyRDtZQUFFUSxRQUFRO1FBQUk7SUFFbEI7QUFDRjtBQUVBLDZCQUE2QjtBQUN0QixlQUFlRSxLQUFLQyxPQUFvQjtJQUM3QyxJQUFJO1FBQ0Ysc0JBQXNCO1FBQ3RCLE1BQU1DLE9BQU8sTUFBTWpCLG1FQUFpQkEsQ0FBQ2dCO1FBQ3JDLElBQUksQ0FBQ0MsTUFBTTtZQUNULE9BQU9wQixxREFBWUEsQ0FBQ2EsSUFBSSxDQUN0QjtnQkFBRUMsU0FBUztnQkFBT04sT0FBTztZQUEyQyxHQUNwRTtnQkFBRVEsUUFBUTtZQUFJO1FBRWxCO1FBRUEsTUFBTSxFQUFFSyxJQUFJLEVBQUVDLE1BQU0sRUFB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LFNBQVM7Z0JBQU9OLE9BQU9BLE1BQU1PLE9BQU87WUFBQyxHQUN2QztnQkFBRUMsUUFBUTtZQUFJO1FBRWxCO1FBRUEsWUFBWTtRQUNaLElBQUlrQixVQUFVO1lBQ1osTUFBTWhDLHNFQUFhQSxDQUFDO2dCQUNsQm1DLFNBQVNoQixLQUFLaUIsRUFBRTtnQkFDaEJDLFlBQVk7Z0JBQ1pDLGdCQUFnQjtnQkFDaEJDLGVBQWU7Z0JBQ2ZDLGFBQWFSLFNBQVNJLEVBQUU7Z0JBQ3hCSyxlQUFlLENBQUMsRUFBRVQsU0FBU1YsSUFBSSxDQUFDLEVBQUUsRUFBRUQsS0FBSyxDQUFDLENBQUM7Z0JBQzNDcUIsUUFBUTtnQkFDUkMsYUFBYSxDQUFDLGtCQUFrQixFQUFFWCxTQUFTVCxXQUFXLENBQUMsRUFBRSxFQUFFRixLQUFLLENBQUMsQ0FBQztnQkFDbEVrQyxZQUFZO29CQUFFbEM7b0JBQU1DLE1BQU1VLFNBQVNWLElBQUk7b0JBQUVDLGFBQWFTLFNBQVNULFdBQVc7b0JBQUVDLFdBQVdRLFNBQVNSLFNBQVM7b0JBQUVDLFdBQVdPLFNBQVNQLFNBQVM7Z0JBQUM7Z0JBQ3pJWCxRQUFRO2dCQUNSK0IsWUFBWTtnQkFDWkMsVUFBVTtvQkFBRXRCLFdBQVdRLFNBQVNSLFNBQVM7b0JBQUVtQyxhQUFhM0IsU0FBU04sVUFBVTtnQkFBQztZQUM5RTtRQUNGO1FBRUEsT0FBTzVCLHFEQUFZQSxDQUFDYSxJQUFJLENBQUM7WUFDdkJDLFNBQVM7WUFDVEMsU0FBUztRQUNYO0lBQ0YsRUFBRSxPQUFPUCxPQUFPO1FBQ2RTLFFBQVFULEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU9SLHFEQUFZQSxDQUFDYSxJQUFJLENBQ3RCO1lBQUVDLFNBQVM7WUFBT04sT0FBTztRQUE0QixHQUNyRDtZQUFFUSxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhcmVudGluZy1zY2hvb2wtcGxhdGZvcm0vLi9zcmMvYXBwL2FwaS9hZG1pbi9sYW5ndWFnZXMvcm91dGUudHM/MTRlNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY3JlYXRlQ2xpZW50IH0gZnJvbSAnQC9saWIvc3VwYWJhc2Uvc2VydmVyJztcbmltcG9ydCB7IGxvZ0F1ZGl0RXZlbnQgfSBmcm9tICdAL2xpYi9hdWRpdC9hdWRpdFNlcnZpY2UnO1xuaW1wb3J0IHsgdmVyaWZ5VGVuYW50QWRtaW4gfSBmcm9tICdAL2xpYi90ZW5hbnQvYXV0aCc7XG5cbi8vIEdFVCBhbGwgbGFuZ3VhZ2VzXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKCkge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGE6IGxhbmd1YWdlcywgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnbGFuZ3VhZ2VzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLm9yZGVyKCdpc19kZWZhdWx0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pXG4gICAgICAub3JkZXIoJ25hbWUnKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBsYW5ndWFnZXMsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignR2V0IGxhbmd1YWdlcyBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gZmV0Y2ggbGFuZ3VhZ2VzJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBQT1NUIC0gQ3JlYXRlIG5ldyBsYW5ndWFnZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBWZXJpZnkgdGVuYW50IGFkbWluXG4gICAgY29uc3QgYXV0aCA9IGF3YWl0IHZlcmlmeVRlbmFudEFkbWluKHJlcXVlc3QpO1xuICAgIGlmICghYXV0aCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZCBvciBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHVzZXIsIHRlbmFudCB9ID0gYXV0aDtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBjb2RlLCBuYW1lLCBuYXRpdmVfbmFtZSwgZGlyZWN0aW9uLCBpc19hY3RpdmUsIGlzX2RlZmF1bHQsIGN1cnJlbmN5X2NvZGUsIGN1cnJlbmN5X3N5bWJvbCwgY3VycmVuY3lfcG9zaXRpb24gfSA9IGF3YWl0IHJlcXVlc3QuanNvbigpO1xuXG4gICAgaWYgKCFjb2RlIHx8ICFuYW1lIHx8ICFuYXRpdmVfbmFtZSB8fCAhZGlyZWN0aW9uKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBJZiBzZXR0aW5nIGFzIGRlZmF1bHQsIHVuc2V0IG90aGVyIGRlZmF1bHRzXG4gICAgaWYgKGlzX2RlZmF1bHQpIHtcbiAgICAgIGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdsYW5ndWFnZXMnKVxuICAgICAgICAudXBkYXRlKHsgaXNfZGVmYXVsdDogZmFsc2UgfSlcbiAgICAgICAgLm5lcSgnY29kZScsIGNvZGUpO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZGF0YTogbGFuZ3VhZ2UsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLmZyb20oJ2xhbmd1YWdlcycpXG4gICAgICAuaW5zZXJ0KHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbmF0aXZlX25hbWUsXG4gICAgICAgIGRpcmVjdGlvbixcbiAgICAgICAgaXNfYWN0aXZlOiBpc19hY3RpdmUgPz8gdHJ1ZSxcbiAgICAgICAgaXNfZGVmYXVsdDogaXNfZGVmYXVsdCA/PyBmYWxzZSxcbiAgICAgICAgY3VycmVuY3lfY29kZSxcbiAgICAgICAgY3VycmVuY3lfc3ltYm9sLFxuICAgICAgICBjdXJyZW5jeV9wb3NpdGlvbixcbiAgICAgIH0pXG4gICAgICAuc2VsZWN0KClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9LFxuICAgICAgICB7IHN0YXR1czogNTAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQXVkaXQgbG9nXG4gICAgYXdhaXQgbG9nQXVkaXRFdmVudCh7XG4gICAgICB1c2VyX2lkOiB1c2VyLmlkLFxuICAgICAgZXZlbnRfdHlwZTogJ0NSRUFURScsXG4gICAgICBldmVudF9jYXRlZ29yeTogJ0NPTkZJRycsXG4gICAgICByZXNvdXJjZV90eXBlOiAnbGFuZ3VhZ2UnLFxuICAgICAgcmVzb3VyY2VfaWQ6IGxhbmd1YWdlLmlkLFxuICAgICAgcmVzb3VyY2VfbmFtZTogYCR7bmFtZX0gKCR7Y29kZX0pYCxcbiAgICAgIGFjdGlvbjogJ0NyZWF0ZWQgbGFuZ3VhZ2UnLFxuICAgICAgZGVzY3JpcHRpb246IGBDcmVhdGVkIGxhbmd1YWdlOiAke25hdGl2ZV9uYW1lfSAoJHtjb2RlfSlgLFxuICAgICAgbmV3X3ZhbHVlczogeyBjb2RlLCBuYW1lLCBuYXRpdmVfbmFtZSwgZGlyZWN0aW9uLCBpc19hY3RpdmUsIGlzX2RlZmF1bHQsIGN1cnJlbmN5X2NvZGUsIGN1cnJlbmN5X3N5bWJvbCwgY3VycmVuY3lfcG9zaXRpb24gfSxcbiAgICAgIHN0YXR1czogJ3N1Y2Nlc3MnLFxuICAgICAgcmlza19sZXZlbDogJ21lZGl1bScsXG4gICAgICBtZXRhZGF0YTogeyBkaXJlY3Rpb24sIGlzX2RlZmF1bHQsIGN1cnJlbmN5X2NvZGUgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiBsYW5ndWFnZSxcbiAgICAgIG1lc3NhZ2U6ICdMYW5ndWFnZSBjcmVhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignQ3JlYXRlIGxhbmd1YWdlIGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ZhaWxlZCB0byBjcmVhdGUgbGFuZ3VhZ2UnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8vIFBVVCAtIFVwZGF0ZSBsYW5ndWFnZVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBVVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIC8vIFZlcmlmeSB0ZW5hbnQgYWRtaW5cbiAgICBjb25zdCBhdXRoID0gYXdhaXQgdmVyaWZ5VGVuYW50QWRtaW4ocmVxdWVzdCk7XG4gICAgaWYgKCFhdXRoKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkIG9yIGluc3VmZmljaWVudCBwZXJtaXNzaW9ucycgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMyB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgdXNlciwgdGVuYW50IH0gPSBhdXRoO1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGNvZGUsIG5hbWUsIG5hdGl2ZV9uYW1lLCBkaXJlY3Rpb24sIGlzX2FjdGl2ZSwgaXNfZGVmYXVsdCwgY3VycmVuY3lfY29kZSwgY3VycmVuY3lfc3ltYm9sLCBjdXJyZW5jeV9wb3NpdGlvbiB9ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdMYW5ndWFnZSBjb2RlIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gR2V0IG9sZCB2YWx1ZXMgZm9yIGF1ZGl0XG4gICAgY29uc3QgeyBkYXRhOiBvbGRMYW5ndWFnZSB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdsYW5ndWFnZXMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ2NvZGUnLCBjb2RlKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgLy8gSWYgc2V0dGluZyBhcyBkZWZhdWx0LCB1bnNldCBvdGhlciBkZWZhdWx0c1xuICAgIGlmIChpc19kZWZhdWx0KSB7XG4gICAgICBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnbGFuZ3VhZ2VzJylcbiAgICAgICAgLnVwZGF0ZSh7IGlzX2RlZmF1bHQ6IGZhbHNlIH0pXG4gICAgICAgIC5uZXEoJ2NvZGUnLCBjb2RlKTtcbiAgICB9XG5cbiAgICBjb25zdCB1cGRhdGVEYXRhOiBhbnkgPSB7fTtcbiAgICBpZiAobmFtZSkgdXBkYXRlRGF0YS5uYW1lID0gbmFtZTtcbiAgICBpZiAobmF0aXZlX25hbWUpIHVwZGF0ZURhdGEubmF0aXZlX25hbWUgPSBuYXRpdmVfbmFtZTtcbiAgICBpZiAoZGlyZWN0aW9uKSB1cGRhdGVEYXRhLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjtcbiAgICBpZiAoaXNfYWN0aXZlICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfYWN0aXZlID0gaXNfYWN0aXZlO1xuICAgIGlmIChpc19kZWZhdWx0ICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuaXNfZGVmYXVsdCA9IGlzX2RlZmF1bHQ7XG4gICAgaWYgKGN1cnJlbmN5X2NvZGUgIT09IHVuZGVmaW5lZCkgdXBkYXRlRGF0YS5jdXJyZW5jeV9jb2RlID0gY3VycmVuY3lfY29kZTtcbiAgICBpZiAoY3VycmVuY3lfc3ltYm9sICE9PSB1bmRlZmluZWQpIHVwZGF0ZURhdGEuY3VycmVuY3lfc3ltYm9sID0gY3VycmVuY3lfc3ltYm9sO1xuICAgIGlmIChjdXJyZW5jeV9wb3NpdGlvbiAhPT0gdW5kZWZpbmVkKSB1cGRhdGVEYXRhLmN1cnJlbmN5X3Bvc2l0aW9uID0gY3VycmVuY3lfcG9zaXRpb247XG5cbiAgICBjb25zdCB7IGRhdGE6IGxhbmd1YWdlLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCdsYW5ndWFnZXMnKVxuICAgICAgLnVwZGF0ZSh1cGRhdGVEYXRhKVxuICAgICAgLmVxKCdjb2RlJywgY29kZSlcbiAgICAgIC5zZWxlY3QoKVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBlcnJvci5tZXNzYWdlIH0sXG4gICAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBBdWRpdCBsb2dcbiAgICBpZiAob2xkTGFuZ3VhZ2UpIHtcbiAgICAgIGNvbnN0IGNoYW5nZWRGaWVsZHMgPSBPYmplY3Qua2V5cyh1cGRhdGVEYXRhKTtcbiAgICAgIGF3YWl0IGxvZ0F1ZGl0RXZlbnQoe1xuICAgICAgICB1c2VyX2lkOiB1c2VyLmlkLFxuICAgICAgICBldmVudF90eXBlOiAnVVBEQVRFJyxcbiAgICAgICAgZXZlbnRfY2F0ZWdvcnk6ICdDT05GSUcnLFxuICAgICAgICByZXNvdXJjZV90eXBlOiAnbGFuZ3VhZ2UnLFxuICAgICAgICByZXNvdXJjZV9pZDogb2xkTGFuZ3VhZ2UuaWQsXG4gICAgICAgIHJlc291cmNlX25hbWU6IGAke29sZExhbmd1YWdlLm5hbWV9ICgke2NvZGV9KWAsXG4gICAgICAgIGFjdGlvbjogJ1VwZGF0ZWQgbGFuZ3VhZ2UnLFxuICAgICAgICBkZXNjcmlwdGlvbjogYFVwZGF0ZWQgbGFuZ3VhZ2U6ICR7b2xkTGFuZ3VhZ2UubmF0aXZlX25hbWV9ICgke2NvZGV9KWAsXG4gICAgICAgIG9sZF92YWx1ZXM6IE9iamVjdC5mcm9tRW50cmllcyhjaGFuZ2VkRmllbGRzLm1hcChrID0+IFtrLCBvbGRMYW5ndWFnZVtrXV0pKSxcbiAgICAgICAgbmV3X3ZhbHVlczogdXBkYXRlRGF0YSxcbiAgICAgICAgc3RhdHVzOiAnc3VjY2VzcycsXG4gICAgICAgIHJpc2tfbGV2ZWw6IGlzX2RlZmF1bHQgPyAnaGlnaCcgOiAnbWVkaXVtJyxcbiAgICAgICAgbWV0YWRhdGE6IHsgZGlyZWN0aW9uOiBvbGRMYW5ndWFnZS5kaXJlY3Rpb24sIHdhc19kZWZhdWx0OiBvbGRMYW5ndWFnZS5pc19kZWZhdWx0LCBpc19kZWZhdWx0IH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogbGFuZ3VhZ2UsXG4gICAgICBtZXNzYWdlOiAnTGFuZ3VhZ2UgdXBkYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1VwZGF0ZSBsYW5ndWFnZSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gdXBkYXRlIGxhbmd1YWdlJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG4vLyBERUxFVEUgLSBEZWxldGUgbGFuZ3VhZ2VcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBERUxFVEUocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICAvLyBWZXJpZnkgdGVuYW50IGFkbWluXG4gICAgY29uc3QgYXV0aCA9IGF3YWl0IHZlcmlmeVRlbmFudEFkbWluKHJlcXVlc3QpO1xuICAgIGlmICghYXV0aCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZCBvciBpbnN1ZmZpY2llbnQgcGVybWlzc2lvbnMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDMgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IHVzZXIsIHRlbmFudCB9ID0gYXV0aDtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxdWVzdC51cmwpO1xuICAgIGNvbnN0IGNvZGUgPSBzZWFyY2hQYXJhbXMuZ2V0KCdjb2RlJyk7XG5cbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdMYW5ndWFnZSBjb2RlIGlzIHJlcXVpcmVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAwIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgaXQncyB0aGUgZGVmYXVsdCBsYW5ndWFnZVxuICAgIGNvbnN0IHsgZGF0YTogbGFuZ3VhZ2UgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnbGFuZ3VhZ2VzJylcbiAgICAgIC5zZWxlY3QoJ2lkLCBjb2RlLCBuYW1lLCBuYXRpdmVfbmFtZSwgZGlyZWN0aW9uLCBpc19kZWZhdWx0LCBpc19hY3RpdmUnKVxuICAgICAgLmVxKCdjb2RlJywgY29kZSlcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChsYW5ndWFnZT8uaXNfZGVmYXVsdCkge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0Nhbm5vdCBkZWxldGUgZGVmYXVsdCBsYW5ndWFnZScgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAuZnJvbSgnbGFuZ3VhZ2VzJylcbiAgICAgIC5kZWxldGUoKVxuICAgICAgLmVxKCdjb2RlJywgY29kZSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfSxcbiAgICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEF1ZGl0IGxvZ1xuICAgIGlmIChsYW5ndWFnZSkge1xuICAgICAgYXdhaXQgbG9nQXVkaXRFdmVudCh7XG4gICAgICAgIHVzZXJfaWQ6IHVzZXIuaWQsXG4gICAgICAgIGV2ZW50X3R5cGU6ICdERUxFVEUnLFxuICAgICAgICBldmVudF9jYXRlZ29yeTogJ0NPTkZJRycsXG4gICAgICAgIHJlc291cmNlX3R5cGU6ICdsYW5ndWFnZScsXG4gICAgICAgIHJlc291cmNlX2lkOiBsYW5ndWFnZS5pZCxcbiAgICAgICAgcmVzb3VyY2VfbmFtZTogYCR7bGFuZ3VhZ2UubmFtZX0gKCR7Y29kZX0pYCxcbiAgICAgICAgYWN0aW9uOiAnRGVsZXRlZCBsYW5ndWFnZScsXG4gICAgICAgIGRlc2NyaXB0aW9uOiBgRGVsZXRlZCBsYW5ndWFnZTogJHtsYW5ndWFnZS5uYXRpdmVfbmFtZX0gKCR7Y29kZX0pYCxcbiAgICAgICAgb2xkX3ZhbHVlczogeyBjb2RlLCBuYW1lOiBsYW5ndWFnZS5uYW1lLCBuYXRpdmVfbmFtZTogbGFuZ3VhZ2UubmF0aXZlX25hbWUsIGRpcmVjdGlvbjogbGFuZ3VhZ2UuZGlyZWN0aW9uLCBpc19hY3RpdmU6IGxhbmd1YWdlLmlzX2FjdGl2ZSB9LFxuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcbiAgICAgICAgcmlza19sZXZlbDogJ2hpZ2gnLFxuICAgICAgICBtZXRhZGF0YTogeyBkaXJlY3Rpb246IGxhbmd1YWdlLmRpcmVjdGlvbiwgd2FzX2RlZmF1bHQ6IGxhbmd1YWdlLmlzX2RlZmF1bHQgfVxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnTGFuZ3VhZ2UgZGVsZXRlZCBzdWNjZXNzZnVsbHknLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0RlbGV0ZSBsYW5ndWFnZSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdGYWlsZWQgdG8gZGVsZXRlIGxhbmd1YWdlJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImNyZWF0ZUNsaWVudCIsImxvZ0F1ZGl0RXZlbnQiLCJ2ZXJpZnlUZW5hbnRBZG1pbiIsIkdFVCIsInN1cGFiYXNlIiwiZGF0YSIsImxhbmd1YWdlcyIsImVycm9yIiwiZnJvbSIsInNlbGVjdCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwianNvbiIsInN1Y2Nlc3MiLCJtZXNzYWdlIiwic3RhdHVzIiwiY29uc29sZSIsIlBPU1QiLCJyZXF1ZXN0IiwiYXV0aCIsInVzZXIiLCJ0ZW5hbnQiLCJjb2RlIiwibmFtZSIsIm5hdGl2ZV9uYW1lIiwiZGlyZWN0aW9uIiwiaXNfYWN0aXZlIiwiaXNfZGVmYXVsdCIsImN1cnJlbmN5X2NvZGUiLCJjdXJyZW5jeV9zeW1ib2wiLCJjdXJyZW5jeV9wb3NpdGlvbiIsInVwZGF0ZSIsIm5lcSIsImxhbmd1YWdlIiwiaW5zZXJ0Iiwic2luZ2xlIiwidXNlcl9pZCIsImlkIiwiZXZlbnRfdHlwZSIsImV2ZW50X2NhdGVnb3J5IiwicmVzb3VyY2VfdHlwZSIsInJlc291cmNlX2lkIiwicmVzb3VyY2VfbmFtZSIsImFjdGlvbiIsImRlc2NyaXB0aW9uIiwibmV3X3ZhbHVlcyIsInJpc2tfbGV2ZWwiLCJtZXRhZGF0YSIsIlBVVCIsIm9sZExhbmd1YWdlIiwiZXEiLCJ1cGRhdGVEYXRhIiwidW5kZWZpbmVkIiwiY2hhbmdlZEZpZWxkcyIsIk9iamVjdCIsImtleXMiLCJvbGRfdmFsdWVzIiwiZnJvbUVudHJpZXMiLCJtYXAiLCJrIiwid2FzX2RlZmF1bHQiLCJERUxFVEUiLCJzZWFyY2hQYXJhbXMiLCJVUkwiLCJ1cmwiLCJnZXQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/admin/languages/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/audit/auditService.ts":
/*!***************************************!*\
  !*** ./src/lib/audit/auditService.ts ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   auditService: () => (/* binding */ auditService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   generateComplianceReport: () => (/* binding */ generateComplianceReport),\n/* harmony export */   generateSessionId: () => (/* binding */ generateSessionId),\n/* harmony export */   getActiveAlerts: () => (/* binding */ getActiveAlerts),\n/* harmony export */   getAuditEvents: () => (/* binding */ getAuditEvents),\n/* harmony export */   getClientInfo: () => (/* binding */ getClientInfo),\n/* harmony export */   getGradeChanges: () => (/* binding */ getGradeChanges),\n/* harmony export */   getHighRiskEvents: () => (/* binding */ getHighRiskEvents),\n/* harmony export */   getParentalConsent: () => (/* binding */ getParentalConsent),\n/* harmony export */   getStudentRecordAccess: () => (/* binding */ getStudentRecordAccess),\n/* harmony export */   hasValidConsent: () => (/* binding */ hasValidConsent),\n/* harmony export */   logAuditEvent: () => (/* binding */ logAuditEvent),\n/* harmony export */   logAuthEvent: () => (/* binding */ logAuthEvent),\n/* harmony export */   logConfigChange: () => (/* binding */ logConfigChange),\n/* harmony export */   logConsentAction: () => (/* binding */ logConsentAction),\n/* harmony export */   logDataExport: () => (/* binding */ logDataExport),\n/* harmony export */   logGradeChange: () => (/* binding */ logGradeChange),\n/* harmony export */   logStudentRecordAccess: () => (/* binding */ logStudentRecordAccess),\n/* harmony export */   verifyAuditChain: () => (/* binding */ verifyAuditChain)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n// ============================================================================\n// AUDIT TRAIL SERVICE\n// Centralized service for logging and retrieving audit events\n// ============================================================================\n\n// Initialize Supabase client\n// Note: Uses SERVICE_ROLE_KEY to bypass RLS for system-level audit logging\nconst supabaseUrl = \"https://dgdondsvtqbqnsecbayx.supabase.co\" || 0;\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY || \"\";\nlet supabase = null;\nfunction getSupabaseClient() {\n    if (!supabase) {\n        supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey, {\n            auth: {\n                autoRefreshToken: false,\n                persistSession: false\n            }\n        });\n    }\n    return supabase;\n}\n// ============================================================================\n// CORE AUDIT LOGGING\n// ============================================================================\n/**\n * Log an audit event using the database function\n * This is the main function to call from application code\n */ async function logAuditEvent(params) {\n    try {\n        const client = getSupabaseClient();\n        // Call the database function\n        const { data, error } = await client.rpc(\"log_audit_event\", {\n            p_user_id: params.user_id || null,\n            p_event_type: params.event_type,\n            p_event_category: params.event_category,\n            p_resource_type: params.resource_type,\n            p_resource_id: params.resource_id || null,\n            p_resource_name: params.resource_name || null,\n            p_action: params.action,\n            p_description: params.description || null,\n            p_old_values: params.old_values || null,\n            p_new_values: params.new_values || null,\n            p_session_id: params.session_id || null,\n            p_ip_address: params.ip_address || null,\n            p_user_agent: params.user_agent || null,\n            p_status: params.status || \"success\",\n            p_risk_level: params.risk_level || \"low\",\n            p_metadata: params.metadata || null\n        });\n        if (error) {\n            console.error(\"Error logging audit event:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Exception logging audit event:\", error);\n        return null;\n    }\n}\n/**\n * Helper function to get current user's IP address and user agent\n */ function getClientInfo(req) {\n    if (false) {}\n    if (req) {\n        // Server-side with request object\n        const forwarded = req.headers.get(\"x-forwarded-for\");\n        const ip = forwarded ? forwarded.split(\",\")[0] : req.headers.get(\"x-real-ip\") || undefined;\n        return {\n            ip,\n            userAgent: req.headers.get(\"user-agent\") || undefined\n        };\n    }\n    return {};\n}\n/**\n * Generate a session ID for tracking user sessions\n */ function generateSessionId() {\n    return `session_${Date.now()}_${Math.random().toString(36).substring(7)}`;\n}\n// ============================================================================\n// CONVENIENCE LOGGING FUNCTIONS\n// ============================================================================\n/**\n * Log user authentication event\n */ async function logAuthEvent(userId, action, metadata) {\n    const clientInfo = getClientInfo();\n    return logAuditEvent({\n        user_id: userId,\n        event_type: action === \"login\" ? \"LOGIN\" : action === \"logout\" ? \"LOGOUT\" : \"ACCESS\",\n        event_category: \"AUTH\",\n        resource_type: \"auth_session\",\n        action: action.replace(\"_\", \" \"),\n        status: action === \"failed_login\" ? \"failure\" : \"success\",\n        risk_level: action === \"failed_login\" ? \"medium\" : \"low\",\n        ...clientInfo,\n        metadata\n    });\n}\n/**\n * Log student record access (FERPA compliance)\n */ async function logStudentRecordAccess(userId, studentId, resourceType, resourceId, action, metadata) {\n    const clientInfo = getClientInfo();\n    return logAuditEvent({\n        user_id: userId,\n        event_type: \"ACCESS\",\n        event_category: \"STUDENT_RECORD\",\n        resource_type: resourceType,\n        resource_id: resourceId,\n        action,\n        student_id: studentId,\n        is_student_record: true,\n        compliance_flags: [\n            \"FERPA\"\n        ],\n        risk_level: \"medium\",\n        ...clientInfo,\n        metadata\n    });\n}\n/**\n * Log grade change (high-risk event)\n */ async function logGradeChange(userId, studentId, gradeId, oldGrade, newGrade, metadata) {\n    const clientInfo = getClientInfo();\n    return logAuditEvent({\n        user_id: userId,\n        event_type: \"UPDATE\",\n        event_category: \"GRADE\",\n        resource_type: \"grades\",\n        resource_id: gradeId,\n        action: \"Updated student grade\",\n        old_values: oldGrade,\n        new_values: newGrade,\n        student_id: studentId,\n        is_student_record: true,\n        compliance_flags: [\n            \"FERPA\"\n        ],\n        risk_level: \"high\",\n        ...clientInfo,\n        metadata\n    });\n}\n/**\n * Log parental consent action (COPPA compliance)\n */ async function logConsentAction(userId, studentId, consentId, action, consentType, metadata) {\n    const clientInfo = getClientInfo();\n    return logAuditEvent({\n        user_id: userId,\n        event_type: \"CONSENT\",\n        event_category: \"COMPLIANCE\",\n        resource_type: \"parental_consent\",\n        resource_id: consentId,\n        action,\n        student_id: studentId,\n        parental_consent_id: consentId,\n        compliance_flags: [\n            \"COPPA\",\n            \"FERPA\"\n        ],\n        risk_level: \"medium\",\n        ...clientInfo,\n        metadata: {\n            consent_type: consentType,\n            ...metadata\n        }\n    });\n}\n/**\n * Log data export (high-risk event)\n */ async function logDataExport(userId, resourceType, exportFormat, recordCount, metadata) {\n    const clientInfo = getClientInfo();\n    return logAuditEvent({\n        user_id: userId,\n        event_type: \"EXPORT\",\n        event_category: \"DATA\",\n        resource_type: resourceType,\n        action: `Exported ${recordCount} ${resourceType} records as ${exportFormat}`,\n        risk_level: recordCount > 100 ? \"high\" : \"medium\",\n        ...clientInfo,\n        metadata: {\n            export_format: exportFormat,\n            record_count: recordCount,\n            ...metadata\n        }\n    });\n}\n/**\n * Log configuration change (admin action)\n */ async function logConfigChange(userId, resourceType, resourceId, oldValues, newValues, metadata) {\n    const clientInfo = getClientInfo();\n    // Filter out automatic database fields that shouldn't be shown in audit logs\n    const automaticFields = [\n        \"updated_at\",\n        \"created_at\",\n        \"id\"\n    ];\n    const filteredOldValues = oldValues ? Object.fromEntries(Object.entries(oldValues).filter(([key])=>!automaticFields.includes(key))) : undefined;\n    const filteredNewValues = newValues ? Object.fromEntries(Object.entries(newValues).filter(([key])=>!automaticFields.includes(key))) : undefined;\n    return logAuditEvent({\n        user_id: userId,\n        event_type: \"UPDATE\",\n        event_category: \"CONFIG\",\n        resource_type: resourceType,\n        resource_id: resourceId,\n        action: `Updated ${resourceType} configuration`,\n        old_values: filteredOldValues,\n        new_values: filteredNewValues,\n        risk_level: \"high\",\n        ...clientInfo,\n        metadata\n    });\n}\n// ============================================================================\n// AUDIT RETRIEVAL\n// ============================================================================\n/**\n * Get audit events with filters\n */ async function getAuditEvents(filters = {}) {\n    try {\n        const client = getSupabaseClient();\n        let query = client.from(\"audit_events\").select(\"*\", {\n            count: \"exact\"\n        });\n        // Apply filters\n        if (filters.date_from) {\n            query = query.gte(\"event_timestamp\", filters.date_from);\n        }\n        if (filters.date_to) {\n            query = query.lte(\"event_timestamp\", filters.date_to);\n        }\n        if (filters.user_ids && filters.user_ids.length > 0) {\n            query = query.in(\"user_id\", filters.user_ids);\n        }\n        if (filters.student_ids && filters.student_ids.length > 0) {\n            query = query.in(\"student_id\", filters.student_ids);\n        }\n        if (filters.event_types && filters.event_types.length > 0) {\n            query = query.in(\"event_type\", filters.event_types);\n        }\n        if (filters.event_categories && filters.event_categories.length > 0) {\n            query = query.in(\"event_category\", filters.event_categories);\n        }\n        if (filters.resource_types && filters.resource_types.length > 0) {\n            query = query.in(\"resource_type\", filters.resource_types);\n        }\n        if (filters.risk_levels && filters.risk_levels.length > 0) {\n            query = query.in(\"risk_level\", filters.risk_levels);\n        }\n        if (filters.status && filters.status.length > 0) {\n            query = query.in(\"status\", filters.status);\n        }\n        if (filters.is_student_record !== undefined) {\n            query = query.eq(\"is_student_record\", filters.is_student_record);\n        }\n        if (filters.is_minor_data !== undefined) {\n            query = query.eq(\"is_minor_data\", filters.is_minor_data);\n        }\n        if (filters.search) {\n            query = query.textSearch(\"search_vector\", filters.search);\n        }\n        // Order by timestamp descending\n        query = query.order(\"event_timestamp\", {\n            ascending: false\n        });\n        // Pagination\n        if (filters.limit) {\n            query = query.limit(filters.limit);\n        }\n        if (filters.offset) {\n            query = query.range(filters.offset, filters.offset + (filters.limit || 50) - 1);\n        }\n        const { data, error, count } = await query;\n        return {\n            data: data || [],\n            error,\n            count: count || 0\n        };\n    } catch (error) {\n        console.error(\"Error getting audit events:\", error);\n        return {\n            data: [],\n            error,\n            count: 0\n        };\n    }\n}\n/**\n * Get student record access logs (FERPA view)\n */ async function getStudentRecordAccess(studentId, dateFrom, dateTo) {\n    try {\n        const client = getSupabaseClient();\n        let query = client.from(\"audit_student_record_access\").select(\"*\");\n        if (studentId) {\n            query = query.eq(\"student_id\", studentId);\n        }\n        if (dateFrom) {\n            query = query.gte(\"event_timestamp\", dateFrom);\n        }\n        if (dateTo) {\n            query = query.lte(\"event_timestamp\", dateTo);\n        }\n        query = query.order(\"event_timestamp\", {\n            ascending: false\n        }).limit(100);\n        const { data, error } = await query;\n        return {\n            data: data || [],\n            error\n        };\n    } catch (error) {\n        console.error(\"Error getting student record access:\", error);\n        return {\n            data: [],\n            error\n        };\n    }\n}\n/**\n * Get grade changes audit\n */ async function getGradeChanges(studentId, dateFrom, dateTo) {\n    try {\n        const client = getSupabaseClient();\n        let query = client.from(\"audit_grade_changes\").select(\"*\");\n        if (studentId) {\n            query = query.eq(\"student_id\", studentId);\n        }\n        if (dateFrom) {\n            query = query.gte(\"event_timestamp\", dateFrom);\n        }\n        if (dateTo) {\n            query = query.lte(\"event_timestamp\", dateTo);\n        }\n        query = query.order(\"event_timestamp\", {\n            ascending: false\n        }).limit(100);\n        const { data, error } = await query;\n        return {\n            data: data || [],\n            error\n        };\n    } catch (error) {\n        console.error(\"Error getting grade changes:\", error);\n        return {\n            data: [],\n            error\n        };\n    }\n}\n/**\n * Get high-risk events\n */ async function getHighRiskEvents(limit = 50) {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.from(\"audit_high_risk_events\").select(\"*\").order(\"event_timestamp\", {\n            ascending: false\n        }).limit(limit);\n        return {\n            data: data || [],\n            error\n        };\n    } catch (error) {\n        console.error(\"Error getting high-risk events:\", error);\n        return {\n            data: [],\n            error\n        };\n    }\n}\n/**\n * Get active alerts\n */ async function getActiveAlerts() {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.from(\"audit_alerts\").select(\"*\").in(\"status\", [\n            \"open\",\n            \"investigating\"\n        ]).order(\"detected_at\", {\n            ascending: false\n        });\n        return {\n            data: data || [],\n            error\n        };\n    } catch (error) {\n        console.error(\"Error getting active alerts:\", error);\n        return {\n            data: [],\n            error\n        };\n    }\n}\n// ============================================================================\n// PARENTAL CONSENT MANAGEMENT\n// ============================================================================\n/**\n * Get parental consent for a student\n */ async function getParentalConsent(studentId) {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.from(\"parental_consent_audit\").select(\"*\").eq(\"student_id\", studentId).order(\"requested_at\", {\n            ascending: false\n        });\n        return {\n            data: data || [],\n            error\n        };\n    } catch (error) {\n        console.error(\"Error getting parental consent:\", error);\n        return {\n            data: [],\n            error\n        };\n    }\n}\n/**\n * Check if student has valid consent for a specific type\n */ async function hasValidConsent(studentId, consentType) {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.from(\"parental_consent_audit\").select(\"id, consent_status, expires_at\").eq(\"student_id\", studentId).eq(\"consent_type\", consentType).eq(\"consent_status\", \"granted\").single();\n        if (error || !data) {\n            return false;\n        }\n        // Check if expired\n        const consentData = data;\n        if (consentData.expires_at) {\n            const expiryDate = new Date(consentData.expires_at);\n            if (expiryDate < new Date()) {\n                return false;\n            }\n        }\n        return true;\n    } catch (error) {\n        console.error(\"Error checking consent:\", error);\n        return false;\n    }\n}\n// ============================================================================\n// UTILITY FUNCTIONS\n// ============================================================================\n/**\n * Verify audit chain integrity\n */ async function verifyAuditChain(dateFrom, dateTo) {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.rpc(\"verify_audit_chain\", {\n            p_date_from: dateFrom || new Date(Date.now() - 24 * 60 * 60 * 1000).toISOString(),\n            p_date_to: dateTo || new Date().toISOString()\n        });\n        if (error) {\n            console.error(\"Error verifying audit chain:\", error);\n            return {\n                isValid: false,\n                totalEvents: 0,\n                invalidEvents: 0\n            };\n        }\n        const result = data;\n        return {\n            isValid: result[0].is_valid,\n            totalEvents: result[0].total_events,\n            invalidEvents: result[0].invalid_events\n        };\n    } catch (error) {\n        console.error(\"Exception verifying audit chain:\", error);\n        return {\n            isValid: false,\n            totalEvents: 0,\n            invalidEvents: 0\n        };\n    }\n}\n/**\n * Generate compliance report\n */ async function generateComplianceReport(framework, dateFrom, dateTo) {\n    try {\n        const client = getSupabaseClient();\n        const { data, error } = await client.rpc(\"generate_compliance_report\", {\n            p_framework: framework,\n            p_date_from: dateFrom || new Date(Date.now() - 30 * 24 * 60 * 60 * 1000).toISOString(),\n            p_date_to: dateTo || new Date().toISOString()\n        });\n        if (error) {\n            console.error(\"Error generating compliance report:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Exception generating compliance report:\", error);\n        return null;\n    }\n}\nconst auditService = {\n    logAuditEvent,\n    logAuthEvent,\n    logStudentRecordAccess,\n    logGradeChange,\n    logConsentAction,\n    logDataExport,\n    logConfigChange,\n    getAuditEvents,\n    getStudentRecordAccess,\n    getGradeChanges,\n    getHighRiskEvents,\n    getActiveAlerts,\n    getParentalConsent,\n    hasValidConsent,\n    verifyAuditChain,\n    generateComplianceReport,\n    getClientInfo,\n    generateSessionId\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (auditService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTtZQUNyRCxPQUFPO1FBQ1Q7UUFFQSxPQUFPRDtJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNka0MsUUFBUWxDLEtBQUssQ0FBQywyQ0FBMkNBO1FBQ3pELE9BQU87SUFDVDtBQUNGO0FBRU8sTUFBTThJLGVBQWU7SUFDMUJsSjtJQUNBd0Q7SUFDQUk7SUFDQU87SUFDQUk7SUFDQUs7SUFDQUs7SUFDQVk7SUFDQTJCO0lBQ0FHO0lBQ0FDO0lBQ0FDO0lBQ0FDO0lBQ0FDO0lBQ0FLO0lBQ0FXO0lBQ0F4RztJQUNBVTtBQUNGLEVBQUU7QUFFRixpRUFBZWlHLFlBQVlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYXJlbnRpbmctc2Nob29sLXBsYXRmb3JtLy4vc3JjL2xpYi9hdWRpdC9hdWRpdFNlcnZpY2UudHM/ZDgxMiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBBVURJVCBUUkFJTCBTRVJWSUNFXG4vLyBDZW50cmFsaXplZCBzZXJ2aWNlIGZvciBsb2dnaW5nIGFuZCByZXRyaWV2aW5nIGF1ZGl0IGV2ZW50c1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnO1xuaW1wb3J0IHR5cGUge1xuICBBdWRpdEV2ZW50LFxuICBDcmVhdGVBdWRpdEV2ZW50UGFyYW1zLFxuICBBdWRpdEZpbHRlcnMsXG4gIFBhcmVudGFsQ29uc2VudCxcbiAgU3R1ZGVudFJlY29yZEFjY2VzcyxcbiAgR3JhZGVDaGFuZ2UsXG4gIEF1ZGl0QWxlcnQsXG59IGZyb20gJy4vdHlwZXMnO1xuXG4vLyBJbml0aWFsaXplIFN1cGFiYXNlIGNsaWVudFxuLy8gTm90ZTogVXNlcyBTRVJWSUNFX1JPTEVfS0VZIHRvIGJ5cGFzcyBSTFMgZm9yIHN5c3RlbS1sZXZlbCBhdWRpdCBsb2dnaW5nXG5jb25zdCBzdXBhYmFzZVVybCA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCB8fCAnJztcbmNvbnN0IHN1cGFiYXNlU2VydmljZUtleSA9IHByb2Nlc3MuZW52LlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkgfHwgJyc7XG5cbmxldCBzdXBhYmFzZTogUmV0dXJuVHlwZTx0eXBlb2YgY3JlYXRlQ2xpZW50PiB8IG51bGwgPSBudWxsO1xuXG5mdW5jdGlvbiBnZXRTdXBhYmFzZUNsaWVudCgpIHtcbiAgaWYgKCFzdXBhYmFzZSkge1xuICAgIHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZVNlcnZpY2VLZXksIHtcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgYXV0b1JlZnJlc2hUb2tlbjogZmFsc2UsXG4gICAgICAgIHBlcnNpc3RTZXNzaW9uOiBmYWxzZVxuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHJldHVybiBzdXBhYmFzZTtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09SRSBBVURJVCBMT0dHSU5HXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbi8qKlxuICogTG9nIGFuIGF1ZGl0IGV2ZW50IHVzaW5nIHRoZSBkYXRhYmFzZSBmdW5jdGlvblxuICogVGhpcyBpcyB0aGUgbWFpbiBmdW5jdGlvbiB0byBjYWxsIGZyb20gYXBwbGljYXRpb24gY29kZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQXVkaXRFdmVudChwYXJhbXM6IENyZWF0ZUF1ZGl0RXZlbnRQYXJhbXMpOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xuXG4gICAgLy8gQ2FsbCB0aGUgZGF0YWJhc2UgZnVuY3Rpb25cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnQucnBjKCdsb2dfYXVkaXRfZXZlbnQnLCB7XG4gICAgICBwX3VzZXJfaWQ6IHBhcmFtcy51c2VyX2lkIHx8IG51bGwsXG4gICAgICBwX2V2ZW50X3R5cGU6IHBhcmFtcy5ldmVudF90eXBlLFxuICAgICAgcF9ldmVudF9jYXRlZ29yeTogcGFyYW1zLmV2ZW50X2NhdGVnb3J5LFxuICAgICAgcF9yZXNvdXJjZV90eXBlOiBwYXJhbXMucmVzb3VyY2VfdHlwZSxcbiAgICAgIHBfcmVzb3VyY2VfaWQ6IHBhcmFtcy5yZXNvdXJjZV9pZCB8fCBudWxsLFxuICAgICAgcF9yZXNvdXJjZV9uYW1lOiBwYXJhbXMucmVzb3VyY2VfbmFtZSB8fCBudWxsLFxuICAgICAgcF9hY3Rpb246IHBhcmFtcy5hY3Rpb24sXG4gICAgICBwX2Rlc2NyaXB0aW9uOiBwYXJhbXMuZGVzY3JpcHRpb24gfHwgbnVsbCxcbiAgICAgIHBfb2xkX3ZhbHVlczogcGFyYW1zLm9sZF92YWx1ZXMgfHwgbnVsbCxcbiAgICAgIHBfbmV3X3ZhbHVlczogcGFyYW1zLm5ld192YWx1ZXMgfHwgbnVsbCxcbiAgICAgIHBfc2Vzc2lvbl9pZDogcGFyYW1zLnNlc3Npb25faWQgfHwgbnVsbCxcbiAgICAgIHBfaXBfYWRkcmVzczogcGFyYW1zLmlwX2FkZHJlc3MgfHwgbnVsbCxcbiAgICAgIHBfdXNlcl9hZ2VudDogcGFyYW1zLnVzZXJfYWdlbnQgfHwgbnVsbCxcbiAgICAgIHBfc3RhdHVzOiBwYXJhbXMuc3RhdHVzIHx8ICdzdWNjZXNzJyxcbiAgICAgIHBfcmlza19sZXZlbDogcGFyYW1zLnJpc2tfbGV2ZWwgfHwgJ2xvdycsXG4gICAgICBwX21ldGFkYXRhOiBwYXJhbXMubWV0YWRhdGEgfHwgbnVsbCxcbiAgICB9IGFzIGFueSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGxvZ2dpbmcgYXVkaXQgZXZlbnQ6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgYXMgc3RyaW5nO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0V4Y2VwdGlvbiBsb2dnaW5nIGF1ZGl0IGV2ZW50OicsIGVycm9yKTtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxufVxuXG4vKipcbiAqIEhlbHBlciBmdW5jdGlvbiB0byBnZXQgY3VycmVudCB1c2VyJ3MgSVAgYWRkcmVzcyBhbmQgdXNlciBhZ2VudFxuICovXG5leHBvcnQgZnVuY3Rpb24gZ2V0Q2xpZW50SW5mbyhyZXE/OiBSZXF1ZXN0KTogeyBpcD86IHN0cmluZzsgdXNlckFnZW50Pzogc3RyaW5nIH0ge1xuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBDbGllbnQtc2lkZVxuICAgIHJldHVybiB7XG4gICAgICB1c2VyQWdlbnQ6IG5hdmlnYXRvci51c2VyQWdlbnQsXG4gICAgfTtcbiAgfVxuXG4gIGlmIChyZXEpIHtcbiAgICAvLyBTZXJ2ZXItc2lkZSB3aXRoIHJlcXVlc3Qgb2JqZWN0XG4gICAgY29uc3QgZm9yd2FyZGVkID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKTtcbiAgICBjb25zdCBpcCA9IGZvcndhcmRlZCA/IGZvcndhcmRlZC5zcGxpdCgnLCcpWzBdIDogcmVxLmhlYWRlcnMuZ2V0KCd4LXJlYWwtaXAnKSB8fCB1bmRlZmluZWQ7XG5cbiAgICByZXR1cm4ge1xuICAgICAgaXAsXG4gICAgICB1c2VyQWdlbnQ6IHJlcS5oZWFkZXJzLmdldCgndXNlci1hZ2VudCcpIHx8IHVuZGVmaW5lZCxcbiAgICB9O1xuICB9XG5cbiAgcmV0dXJuIHt9O1xufVxuXG4vKipcbiAqIEdlbmVyYXRlIGEgc2Vzc2lvbiBJRCBmb3IgdHJhY2tpbmcgdXNlciBzZXNzaW9uc1xuICovXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVTZXNzaW9uSWQoKTogc3RyaW5nIHtcbiAgcmV0dXJuIGBzZXNzaW9uXyR7RGF0ZS5ub3coKX1fJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoNyl9YDtcbn1cblxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gQ09OVkVOSUVOQ0UgTE9HR0lORyBGVU5DVElPTlNcbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cblxuLyoqXG4gKiBMb2cgdXNlciBhdXRoZW50aWNhdGlvbiBldmVudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nQXV0aEV2ZW50KFxuICB1c2VySWQ6IHN0cmluZyB8IHVuZGVmaW5lZCxcbiAgYWN0aW9uOiAnbG9naW4nIHwgJ2xvZ291dCcgfCAnZmFpbGVkX2xvZ2luJyB8ICdwYXNzd29yZF9yZXNldCcsXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuKSB7XG4gIGNvbnN0IGNsaWVudEluZm8gPSBnZXRDbGllbnRJbmZvKCk7XG5cbiAgcmV0dXJuIGxvZ0F1ZGl0RXZlbnQoe1xuICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICBldmVudF90eXBlOiBhY3Rpb24gPT09ICdsb2dpbicgPyAnTE9HSU4nIDogYWN0aW9uID09PSAnbG9nb3V0JyA/ICdMT0dPVVQnIDogJ0FDQ0VTUycsXG4gICAgZXZlbnRfY2F0ZWdvcnk6ICdBVVRIJyxcbiAgICByZXNvdXJjZV90eXBlOiAnYXV0aF9zZXNzaW9uJyxcbiAgICBhY3Rpb246IGFjdGlvbi5yZXBsYWNlKCdfJywgJyAnKSxcbiAgICBzdGF0dXM6IGFjdGlvbiA9PT0gJ2ZhaWxlZF9sb2dpbicgPyAnZmFpbHVyZScgOiAnc3VjY2VzcycsXG4gICAgcmlza19sZXZlbDogYWN0aW9uID09PSAnZmFpbGVkX2xvZ2luJyA/ICdtZWRpdW0nIDogJ2xvdycsXG4gICAgLi4uY2xpZW50SW5mbyxcbiAgICBtZXRhZGF0YSxcbiAgfSk7XG59XG5cbi8qKlxuICogTG9nIHN0dWRlbnQgcmVjb3JkIGFjY2VzcyAoRkVSUEEgY29tcGxpYW5jZSlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvZ1N0dWRlbnRSZWNvcmRBY2Nlc3MoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBzdHVkZW50SWQ6IHN0cmluZyxcbiAgcmVzb3VyY2VUeXBlOiBzdHJpbmcsXG4gIHJlc291cmNlSWQ6IHN0cmluZyxcbiAgYWN0aW9uOiBzdHJpbmcsXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuKSB7XG4gIGNvbnN0IGNsaWVudEluZm8gPSBnZXRDbGllbnRJbmZvKCk7XG5cbiAgcmV0dXJuIGxvZ0F1ZGl0RXZlbnQoe1xuICAgIHVzZXJfaWQ6IHVzZXJJZCxcbiAgICBldmVudF90eXBlOiAnQUNDRVNTJyxcbiAgICBldmVudF9jYXRlZ29yeTogJ1NUVURFTlRfUkVDT1JEJyxcbiAgICByZXNvdXJjZV90eXBlOiByZXNvdXJjZVR5cGUsXG4gICAgcmVzb3VyY2VfaWQ6IHJlc291cmNlSWQsXG4gICAgYWN0aW9uLFxuICAgIHN0dWRlbnRfaWQ6IHN0dWRlbnRJZCxcbiAgICBpc19zdHVkZW50X3JlY29yZDogdHJ1ZSxcbiAgICBjb21wbGlhbmNlX2ZsYWdzOiBbJ0ZFUlBBJ10sXG4gICAgcmlza19sZXZlbDogJ21lZGl1bScsXG4gICAgLi4uY2xpZW50SW5mbyxcbiAgICBtZXRhZGF0YSxcbiAgfSk7XG59XG5cbi8qKlxuICogTG9nIGdyYWRlIGNoYW5nZSAoaGlnaC1yaXNrIGV2ZW50KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nR3JhZGVDaGFuZ2UoXG4gIHVzZXJJZDogc3RyaW5nLFxuICBzdHVkZW50SWQ6IHN0cmluZyxcbiAgZ3JhZGVJZDogc3RyaW5nLFxuICBvbGRHcmFkZTogYW55LFxuICBuZXdHcmFkZTogYW55LFxuICBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT5cbikge1xuICBjb25zdCBjbGllbnRJbmZvID0gZ2V0Q2xpZW50SW5mbygpO1xuXG4gIHJldHVybiBsb2dBdWRpdEV2ZW50KHtcbiAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgZXZlbnRfdHlwZTogJ1VQREFURScsXG4gICAgZXZlbnRfY2F0ZWdvcnk6ICdHUkFERScsXG4gICAgcmVzb3VyY2VfdHlwZTogJ2dyYWRlcycsXG4gICAgcmVzb3VyY2VfaWQ6IGdyYWRlSWQsXG4gICAgYWN0aW9uOiAnVXBkYXRlZCBzdHVkZW50IGdyYWRlJyxcbiAgICBvbGRfdmFsdWVzOiBvbGRHcmFkZSxcbiAgICBuZXdfdmFsdWVzOiBuZXdHcmFkZSxcbiAgICBzdHVkZW50X2lkOiBzdHVkZW50SWQsXG4gICAgaXNfc3R1ZGVudF9yZWNvcmQ6IHRydWUsXG4gICAgY29tcGxpYW5jZV9mbGFnczogWydGRVJQQSddLFxuICAgIHJpc2tfbGV2ZWw6ICdoaWdoJyxcbiAgICAuLi5jbGllbnRJbmZvLFxuICAgIG1ldGFkYXRhLFxuICB9KTtcbn1cblxuLyoqXG4gKiBMb2cgcGFyZW50YWwgY29uc2VudCBhY3Rpb24gKENPUFBBIGNvbXBsaWFuY2UpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dDb25zZW50QWN0aW9uKFxuICB1c2VySWQ6IHN0cmluZyxcbiAgc3R1ZGVudElkOiBzdHJpbmcsXG4gIGNvbnNlbnRJZDogc3RyaW5nLFxuICBhY3Rpb246IHN0cmluZyxcbiAgY29uc2VudFR5cGU6IHN0cmluZyxcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pIHtcbiAgY29uc3QgY2xpZW50SW5mbyA9IGdldENsaWVudEluZm8oKTtcblxuICByZXR1cm4gbG9nQXVkaXRFdmVudCh7XG4gICAgdXNlcl9pZDogdXNlcklkLFxuICAgIGV2ZW50X3R5cGU6ICdDT05TRU5UJyxcbiAgICBldmVudF9jYXRlZ29yeTogJ0NPTVBMSUFOQ0UnLFxuICAgIHJlc291cmNlX3R5cGU6ICdwYXJlbnRhbF9jb25zZW50JyxcbiAgICByZXNvdXJjZV9pZDogY29uc2VudElkLFxuICAgIGFjdGlvbixcbiAgICBzdHVkZW50X2lkOiBzdHVkZW50SWQsXG4gICAgcGFyZW50YWxfY29uc2VudF9pZDogY29uc2VudElkLFxuICAgIGNvbXBsaWFuY2VfZmxhZ3M6IFsnQ09QUEEnLCAnRkVSUEEnXSxcbiAgICByaXNrX2xldmVsOiAnbWVkaXVtJyxcbiAgICAuLi5jbGllbnRJbmZvLFxuICAgIG1ldGFkYXRhOiB7IGNvbnNlbnRfdHlwZTogY29uc2VudFR5cGUsIC4uLm1ldGFkYXRhIH0sXG4gIH0pO1xufVxuXG4vKipcbiAqIExvZyBkYXRhIGV4cG9ydCAoaGlnaC1yaXNrIGV2ZW50KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gbG9nRGF0YUV4cG9ydChcbiAgdXNlcklkOiBzdHJpbmcsXG4gIHJlc291cmNlVHlwZTogc3RyaW5nLFxuICBleHBvcnRGb3JtYXQ6IHN0cmluZyxcbiAgcmVjb3JkQ291bnQ6IG51bWJlcixcbiAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+XG4pIHtcbiAgY29uc3QgY2xpZW50SW5mbyA9IGdldENsaWVudEluZm8oKTtcblxuICByZXR1cm4gbG9nQXVkaXRFdmVudCh7XG4gICAgdXNlcl9pZDogdXNlcklkLFxuICAgIGV2ZW50X3R5cGU6ICdFWFBPUlQnLFxuICAgIGV2ZW50X2NhdGVnb3J5OiAnREFUQScsXG4gICAgcmVzb3VyY2VfdHlwZTogcmVzb3VyY2VUeXBlLFxuICAgIGFjdGlvbjogYEV4cG9ydGVkICR7cmVjb3JkQ291bnR9ICR7cmVzb3VyY2VUeXBlfSByZWNvcmRzIGFzICR7ZXhwb3J0Rm9ybWF0fWAsXG4gICAgcmlza19sZXZlbDogcmVjb3JkQ291bnQgPiAxMDAgPyAnaGlnaCcgOiAnbWVkaXVtJyxcbiAgICAuLi5jbGllbnRJbmZvLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBleHBvcnRfZm9ybWF0OiBleHBvcnRGb3JtYXQsXG4gICAgICByZWNvcmRfY291bnQ6IHJlY29yZENvdW50LFxuICAgICAgLi4ubWV0YWRhdGEsXG4gICAgfSxcbiAgfSk7XG59XG5cbi8qKlxuICogTG9nIGNvbmZpZ3VyYXRpb24gY2hhbmdlIChhZG1pbiBhY3Rpb24pXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dDb25maWdDaGFuZ2UoXG4gIHVzZXJJZDogc3RyaW5nLFxuICByZXNvdXJjZVR5cGU6IHN0cmluZyxcbiAgcmVzb3VyY2VJZDogc3RyaW5nLFxuICBvbGRWYWx1ZXM6IGFueSxcbiAgbmV3VmFsdWVzOiBhbnksXG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PlxuKSB7XG4gIGNvbnN0IGNsaWVudEluZm8gPSBnZXRDbGllbnRJbmZvKCk7XG5cbiAgLy8gRmlsdGVyIG91dCBhdXRvbWF0aWMgZGF0YWJhc2UgZmllbGRzIHRoYXQgc2hvdWxkbid0IGJlIHNob3duIGluIGF1ZGl0IGxvZ3NcbiAgY29uc3QgYXV0b21hdGljRmllbGRzID0gWyd1cGRhdGVkX2F0JywgJ2NyZWF0ZWRfYXQnLCAnaWQnXTtcbiAgY29uc3QgZmlsdGVyZWRPbGRWYWx1ZXMgPSBvbGRWYWx1ZXMgPyBPYmplY3QuZnJvbUVudHJpZXMoXG4gICAgT2JqZWN0LmVudHJpZXMob2xkVmFsdWVzKS5maWx0ZXIoKFtrZXldKSA9PiAhYXV0b21hdGljRmllbGRzLmluY2x1ZGVzKGtleSkpXG4gICkgOiB1bmRlZmluZWQ7XG4gIGNvbnN0IGZpbHRlcmVkTmV3VmFsdWVzID0gbmV3VmFsdWVzID8gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgIE9iamVjdC5lbnRyaWVzKG5ld1ZhbHVlcykuZmlsdGVyKChba2V5XSkgPT4gIWF1dG9tYXRpY0ZpZWxkcy5pbmNsdWRlcyhrZXkpKVxuICApIDogdW5kZWZpbmVkO1xuXG4gIHJldHVybiBsb2dBdWRpdEV2ZW50KHtcbiAgICB1c2VyX2lkOiB1c2VySWQsXG4gICAgZXZlbnRfdHlwZTogJ1VQREFURScsXG4gICAgZXZlbnRfY2F0ZWdvcnk6ICdDT05GSUcnLFxuICAgIHJlc291cmNlX3R5cGU6IHJlc291cmNlVHlwZSxcbiAgICByZXNvdXJjZV9pZDogcmVzb3VyY2VJZCxcbiAgICBhY3Rpb246IGBVcGRhdGVkICR7cmVzb3VyY2VUeXBlfSBjb25maWd1cmF0aW9uYCxcbiAgICBvbGRfdmFsdWVzOiBmaWx0ZXJlZE9sZFZhbHVlcyxcbiAgICBuZXdfdmFsdWVzOiBmaWx0ZXJlZE5ld1ZhbHVlcyxcbiAgICByaXNrX2xldmVsOiAnaGlnaCcsXG4gICAgLi4uY2xpZW50SW5mbyxcbiAgICBtZXRhZGF0YSxcbiAgfSk7XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIEFVRElUIFJFVFJJRVZBTFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBhdWRpdCBldmVudHMgd2l0aCBmaWx0ZXJzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRBdWRpdEV2ZW50cyhcbiAgZmlsdGVyczogQXVkaXRGaWx0ZXJzID0ge31cbik6IFByb21pc2U8eyBkYXRhOiBBdWRpdEV2ZW50W107IGVycm9yOiBhbnk7IGNvdW50OiBudW1iZXIgfT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IGdldFN1cGFiYXNlQ2xpZW50KCk7XG5cbiAgICBsZXQgcXVlcnkgPSBjbGllbnQuZnJvbSgnYXVkaXRfZXZlbnRzJykuc2VsZWN0KCcqJywgeyBjb3VudDogJ2V4YWN0JyB9KTtcblxuICAgIC8vIEFwcGx5IGZpbHRlcnNcbiAgICBpZiAoZmlsdGVycy5kYXRlX2Zyb20pIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZ3RlKCdldmVudF90aW1lc3RhbXAnLCBmaWx0ZXJzLmRhdGVfZnJvbSk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmRhdGVfdG8pIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdldmVudF90aW1lc3RhbXAnLCBmaWx0ZXJzLmRhdGVfdG8pO1xuICAgIH1cbiAgICBpZiAoZmlsdGVycy51c2VyX2lkcyAmJiBmaWx0ZXJzLnVzZXJfaWRzLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ3VzZXJfaWQnLCBmaWx0ZXJzLnVzZXJfaWRzKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnMuc3R1ZGVudF9pZHMgJiYgZmlsdGVycy5zdHVkZW50X2lkcy5sZW5ndGggPiAwKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmluKCdzdHVkZW50X2lkJywgZmlsdGVycy5zdHVkZW50X2lkcyk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLmV2ZW50X3R5cGVzICYmIGZpbHRlcnMuZXZlbnRfdHlwZXMubGVuZ3RoID4gMCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5pbignZXZlbnRfdHlwZScsIGZpbHRlcnMuZXZlbnRfdHlwZXMpO1xuICAgIH1cbiAgICBpZiAoZmlsdGVycy5ldmVudF9jYXRlZ29yaWVzICYmIGZpbHRlcnMuZXZlbnRfY2F0ZWdvcmllcy5sZW5ndGggPiAwKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmluKCdldmVudF9jYXRlZ29yeScsIGZpbHRlcnMuZXZlbnRfY2F0ZWdvcmllcyk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLnJlc291cmNlX3R5cGVzICYmIGZpbHRlcnMucmVzb3VyY2VfdHlwZXMubGVuZ3RoID4gMCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5pbigncmVzb3VyY2VfdHlwZScsIGZpbHRlcnMucmVzb3VyY2VfdHlwZXMpO1xuICAgIH1cbiAgICBpZiAoZmlsdGVycy5yaXNrX2xldmVscyAmJiBmaWx0ZXJzLnJpc2tfbGV2ZWxzLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ3Jpc2tfbGV2ZWwnLCBmaWx0ZXJzLnJpc2tfbGV2ZWxzKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnMuc3RhdHVzICYmIGZpbHRlcnMuc3RhdHVzLmxlbmd0aCA+IDApIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuaW4oJ3N0YXR1cycsIGZpbHRlcnMuc3RhdHVzKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnMuaXNfc3R1ZGVudF9yZWNvcmQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnaXNfc3R1ZGVudF9yZWNvcmQnLCBmaWx0ZXJzLmlzX3N0dWRlbnRfcmVjb3JkKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnMuaXNfbWlub3JfZGF0YSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LmVxKCdpc19taW5vcl9kYXRhJywgZmlsdGVycy5pc19taW5vcl9kYXRhKTtcbiAgICB9XG4gICAgaWYgKGZpbHRlcnMuc2VhcmNoKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LnRleHRTZWFyY2goJ3NlYXJjaF92ZWN0b3InLCBmaWx0ZXJzLnNlYXJjaCk7XG4gICAgfVxuXG4gICAgLy8gT3JkZXIgYnkgdGltZXN0YW1wIGRlc2NlbmRpbmdcbiAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyKCdldmVudF90aW1lc3RhbXAnLCB7IGFzY2VuZGluZzogZmFsc2UgfSk7XG5cbiAgICAvLyBQYWdpbmF0aW9uXG4gICAgaWYgKGZpbHRlcnMubGltaXQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubGltaXQoZmlsdGVycy5saW1pdCk7XG4gICAgfVxuICAgIGlmIChmaWx0ZXJzLm9mZnNldCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5yYW5nZShmaWx0ZXJzLm9mZnNldCwgZmlsdGVycy5vZmZzZXQgKyAoZmlsdGVycy5saW1pdCB8fCA1MCkgLSAxKTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yLCBjb3VudCB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogKGRhdGEgYXMgQXVkaXRFdmVudFtdKSB8fCBbXSxcbiAgICAgIGVycm9yLFxuICAgICAgY291bnQ6IGNvdW50IHx8IDAsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGF1ZGl0IGV2ZW50czonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgZGF0YTogW10sIGVycm9yLCBjb3VudDogMCB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IHN0dWRlbnQgcmVjb3JkIGFjY2VzcyBsb2dzIChGRVJQQSB2aWV3KVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0U3R1ZGVudFJlY29yZEFjY2VzcyhcbiAgc3R1ZGVudElkPzogc3RyaW5nLFxuICBkYXRlRnJvbT86IHN0cmluZyxcbiAgZGF0ZVRvPzogc3RyaW5nXG4pOiBQcm9taXNlPHsgZGF0YTogU3R1ZGVudFJlY29yZEFjY2Vzc1tdOyBlcnJvcjogYW55IH0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xuXG4gICAgbGV0IHF1ZXJ5ID0gY2xpZW50LmZyb20oJ2F1ZGl0X3N0dWRlbnRfcmVjb3JkX2FjY2VzcycpLnNlbGVjdCgnKicpO1xuXG4gICAgaWYgKHN0dWRlbnRJZCkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnc3R1ZGVudF9pZCcsIHN0dWRlbnRJZCk7XG4gICAgfVxuICAgIGlmIChkYXRlRnJvbSkge1xuICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ2V2ZW50X3RpbWVzdGFtcCcsIGRhdGVGcm9tKTtcbiAgICB9XG4gICAgaWYgKGRhdGVUbykge1xuICAgICAgcXVlcnkgPSBxdWVyeS5sdGUoJ2V2ZW50X3RpbWVzdGFtcCcsIGRhdGVUbyk7XG4gICAgfVxuXG4gICAgcXVlcnkgPSBxdWVyeS5vcmRlcignZXZlbnRfdGltZXN0YW1wJywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pLmxpbWl0KDEwMCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiAoZGF0YSBhcyBTdHVkZW50UmVjb3JkQWNjZXNzW10pIHx8IFtdLFxuICAgICAgZXJyb3IsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIHN0dWRlbnQgcmVjb3JkIGFjY2VzczonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgZGF0YTogW10sIGVycm9yIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgZ3JhZGUgY2hhbmdlcyBhdWRpdFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0R3JhZGVDaGFuZ2VzKFxuICBzdHVkZW50SWQ/OiBzdHJpbmcsXG4gIGRhdGVGcm9tPzogc3RyaW5nLFxuICBkYXRlVG8/OiBzdHJpbmdcbik6IFByb21pc2U8eyBkYXRhOiBHcmFkZUNoYW5nZVtdOyBlcnJvcjogYW55IH0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xuXG4gICAgbGV0IHF1ZXJ5ID0gY2xpZW50LmZyb20oJ2F1ZGl0X2dyYWRlX2NoYW5nZXMnKS5zZWxlY3QoJyonKTtcblxuICAgIGlmIChzdHVkZW50SWQpIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3N0dWRlbnRfaWQnLCBzdHVkZW50SWQpO1xuICAgIH1cbiAgICBpZiAoZGF0ZUZyb20pIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkuZ3RlKCdldmVudF90aW1lc3RhbXAnLCBkYXRlRnJvbSk7XG4gICAgfVxuICAgIGlmIChkYXRlVG8pIHtcbiAgICAgIHF1ZXJ5ID0gcXVlcnkubHRlKCdldmVudF90aW1lc3RhbXAnLCBkYXRlVG8pO1xuICAgIH1cblxuICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXIoJ2V2ZW50X3RpbWVzdGFtcCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KS5saW1pdCgxMDApO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICByZXR1cm4ge1xuICAgICAgZGF0YTogKGRhdGEgYXMgR3JhZGVDaGFuZ2VbXSkgfHwgW10sXG4gICAgICBlcnJvcixcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgZ3JhZGUgY2hhbmdlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgZGF0YTogW10sIGVycm9yIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgaGlnaC1yaXNrIGV2ZW50c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0SGlnaFJpc2tFdmVudHMoXG4gIGxpbWl0OiBudW1iZXIgPSA1MFxuKTogUHJvbWlzZTx7IGRhdGE6IEF1ZGl0RXZlbnRbXTsgZXJyb3I6IGFueSB9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2xpZW50ID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudFxuICAgICAgLmZyb20oJ2F1ZGl0X2hpZ2hfcmlza19ldmVudHMnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAub3JkZXIoJ2V2ZW50X3RpbWVzdGFtcCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KVxuICAgICAgLmxpbWl0KGxpbWl0KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiAoZGF0YSBhcyBBdWRpdEV2ZW50W10pIHx8IFtdLFxuICAgICAgZXJyb3IsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGhpZ2gtcmlzayBldmVudHM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7IGRhdGE6IFtdLCBlcnJvciB9O1xuICB9XG59XG5cbi8qKlxuICogR2V0IGFjdGl2ZSBhbGVydHNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEFjdGl2ZUFsZXJ0cygpOiBQcm9taXNlPHsgZGF0YTogQXVkaXRBbGVydFtdOyBlcnJvcjogYW55IH0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBjbGllbnQgPSBnZXRTdXBhYmFzZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgY2xpZW50XG4gICAgICAuZnJvbSgnYXVkaXRfYWxlcnRzJylcbiAgICAgIC5zZWxlY3QoJyonKVxuICAgICAgLmluKCdzdGF0dXMnLCBbJ29wZW4nLCAnaW52ZXN0aWdhdGluZyddKVxuICAgICAgLm9yZGVyKCdkZXRlY3RlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiAoZGF0YSBhcyBBdWRpdEFsZXJ0W10pIHx8IFtdLFxuICAgICAgZXJyb3IsXG4gICAgfTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZXR0aW5nIGFjdGl2ZSBhbGVydHM6JywgZXJyb3IpO1xuICAgIHJldHVybiB7IGRhdGE6IFtdLCBlcnJvciB9O1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBBUkVOVEFMIENPTlNFTlQgTUFOQUdFTUVOVFxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIEdldCBwYXJlbnRhbCBjb25zZW50IGZvciBhIHN0dWRlbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBhcmVudGFsQ29uc2VudChcbiAgc3R1ZGVudElkOiBzdHJpbmdcbik6IFByb21pc2U8eyBkYXRhOiBQYXJlbnRhbENvbnNlbnRbXTsgZXJyb3I6IGFueSB9PiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2xpZW50ID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudFxuICAgICAgLmZyb20oJ3BhcmVudGFsX2NvbnNlbnRfYXVkaXQnKVxuICAgICAgLnNlbGVjdCgnKicpXG4gICAgICAuZXEoJ3N0dWRlbnRfaWQnLCBzdHVkZW50SWQpXG4gICAgICAub3JkZXIoJ3JlcXVlc3RlZF9hdCcsIHsgYXNjZW5kaW5nOiBmYWxzZSB9KTtcblxuICAgIHJldHVybiB7XG4gICAgICBkYXRhOiAoZGF0YSBhcyBQYXJlbnRhbENvbnNlbnRbXSkgfHwgW10sXG4gICAgICBlcnJvcixcbiAgICB9O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgcGFyZW50YWwgY29uc2VudDonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgZGF0YTogW10sIGVycm9yIH07XG4gIH1cbn1cblxuLyoqXG4gKiBDaGVjayBpZiBzdHVkZW50IGhhcyB2YWxpZCBjb25zZW50IGZvciBhIHNwZWNpZmljIHR5cGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGhhc1ZhbGlkQ29uc2VudChcbiAgc3R1ZGVudElkOiBzdHJpbmcsXG4gIGNvbnNlbnRUeXBlOiBzdHJpbmdcbik6IFByb21pc2U8Ym9vbGVhbj4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IGdldFN1cGFiYXNlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnRcbiAgICAgIC5mcm9tKCdwYXJlbnRhbF9jb25zZW50X2F1ZGl0JylcbiAgICAgIC5zZWxlY3QoJ2lkLCBjb25zZW50X3N0YXR1cywgZXhwaXJlc19hdCcpXG4gICAgICAuZXEoJ3N0dWRlbnRfaWQnLCBzdHVkZW50SWQpXG4gICAgICAuZXEoJ2NvbnNlbnRfdHlwZScsIGNvbnNlbnRUeXBlKVxuICAgICAgLmVxKCdjb25zZW50X3N0YXR1cycsICdncmFudGVkJylcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvciB8fCAhZGF0YSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIGV4cGlyZWRcbiAgICBjb25zdCBjb25zZW50RGF0YSA9IGRhdGEgYXMgYW55O1xuICAgIGlmIChjb25zZW50RGF0YS5leHBpcmVzX2F0KSB7XG4gICAgICBjb25zdCBleHBpcnlEYXRlID0gbmV3IERhdGUoY29uc2VudERhdGEuZXhwaXJlc19hdCk7XG4gICAgICBpZiAoZXhwaXJ5RGF0ZSA8IG5ldyBEYXRlKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIGNvbnNlbnQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBVVElMSVRZIEZVTkNUSU9OU1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG4vKipcbiAqIFZlcmlmeSBhdWRpdCBjaGFpbiBpbnRlZ3JpdHlcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHZlcmlmeUF1ZGl0Q2hhaW4oXG4gIGRhdGVGcm9tPzogc3RyaW5nLFxuICBkYXRlVG8/OiBzdHJpbmdcbik6IFByb21pc2U8eyBpc1ZhbGlkOiBib29sZWFuOyB0b3RhbEV2ZW50czogbnVtYmVyOyBpbnZhbGlkRXZlbnRzOiBudW1iZXIgfT4ge1xuICB0cnkge1xuICAgIGNvbnN0IGNsaWVudCA9IGdldFN1cGFiYXNlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBjbGllbnQucnBjKCd2ZXJpZnlfYXVkaXRfY2hhaW4nLCB7XG4gICAgICBwX2RhdGVfZnJvbTogZGF0ZUZyb20gfHwgbmV3IERhdGUoRGF0ZS5ub3coKSAtIDI0ICogNjAgKiA2MCAqIDEwMDApLnRvSVNPU3RyaW5nKCksXG4gICAgICBwX2RhdGVfdG86IGRhdGVUbyB8fCBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfSBhcyBhbnkpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB2ZXJpZnlpbmcgYXVkaXQgY2hhaW46JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIHRvdGFsRXZlbnRzOiAwLCBpbnZhbGlkRXZlbnRzOiAwIH07XG4gICAgfVxuXG4gICAgY29uc3QgcmVzdWx0ID0gZGF0YSBhcyBhbnk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzVmFsaWQ6IHJlc3VsdFswXS5pc192YWxpZCxcbiAgICAgIHRvdGFsRXZlbnRzOiByZXN1bHRbMF0udG90YWxfZXZlbnRzLFxuICAgICAgaW52YWxpZEV2ZW50czogcmVzdWx0WzBdLmludmFsaWRfZXZlbnRzLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXhjZXB0aW9uIHZlcmlmeWluZyBhdWRpdCBjaGFpbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHsgaXNWYWxpZDogZmFsc2UsIHRvdGFsRXZlbnRzOiAwLCBpbnZhbGlkRXZlbnRzOiAwIH07XG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBjb21wbGlhbmNlIHJlcG9ydFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb21wbGlhbmNlUmVwb3J0KFxuICBmcmFtZXdvcms6IHN0cmluZyxcbiAgZGF0ZUZyb20/OiBzdHJpbmcsXG4gIGRhdGVUbz86IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgY2xpZW50ID0gZ2V0U3VwYWJhc2VDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IGNsaWVudC5ycGMoJ2dlbmVyYXRlX2NvbXBsaWFuY2VfcmVwb3J0Jywge1xuICAgICAgcF9mcmFtZXdvcms6IGZyYW1ld29yayxcbiAgICAgIHBfZGF0ZV9mcm9tOiBkYXRlRnJvbSB8fCBuZXcgRGF0ZShEYXRlLm5vdygpIC0gMzAgKiAyNCAqIDYwICogNjAgKiAxMDAwKS50b0lTT1N0cmluZygpLFxuICAgICAgcF9kYXRlX3RvOiBkYXRlVG8gfHwgbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgIH0gYXMgYW55KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZ2VuZXJhdGluZyBjb21wbGlhbmNlIHJlcG9ydDonLCBlcnJvcik7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YSBhcyBzdHJpbmc7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXhjZXB0aW9uIGdlbmVyYXRpbmcgY29tcGxpYW5jZSByZXBvcnQ6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBhdWRpdFNlcnZpY2UgPSB7XG4gIGxvZ0F1ZGl0RXZlbnQsXG4gIGxvZ0F1dGhFdmVudCxcbiAgbG9nU3R1ZGVudFJlY29yZEFjY2VzcyxcbiAgbG9nR3JhZGVDaGFuZ2UsXG4gIGxvZ0NvbnNlbnRBY3Rpb24sXG4gIGxvZ0RhdGFFeHBvcnQsXG4gIGxvZ0NvbmZpZ0NoYW5nZSxcbiAgZ2V0QXVkaXRFdmVudHMsXG4gIGdldFN0dWRlbnRSZWNvcmRBY2Nlc3MsXG4gIGdldEdyYWRlQ2hhbmdlcyxcbiAgZ2V0SGlnaFJpc2tFdmVudHMsXG4gIGdldEFjdGl2ZUFsZXJ0cyxcbiAgZ2V0UGFyZW50YWxDb25zZW50LFxuICBoYXNWYWxpZENvbnNlbnQsXG4gIHZlcmlmeUF1ZGl0Q2hhaW4sXG4gIGdlbmVyYXRlQ29tcGxpYW5jZVJlcG9ydCxcbiAgZ2V0Q2xpZW50SW5mbyxcbiAgZ2VuZXJhdGVTZXNzaW9uSWQsXG59O1xuXG5leHBvcnQgZGVmYXVsdCBhdWRpdFNlcnZpY2U7XG4iXSwibmFtZXMiOlsiY3JlYXRlQ2xpZW50Iiwic3VwYWJhc2VVcmwiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwic3VwYWJhc2VTZXJ2aWNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiZ2V0U3VwYWJhc2VDbGllbnQiLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIiwibG9nQXVkaXRFdmVudCIsInBhcmFtcyIsImNsaWVudCIsImRhdGEiLCJlcnJvciIsInJwYyIsInBfdXNlcl9pZCIsInVzZXJfaWQiLCJwX2V2ZW50X3R5cGUiLCJldmVudF90eXBlIiwicF9ldmVudF9jYXRlZ29yeSIsImV2ZW50X2NhdGVnb3J5IiwicF9yZXNvdXJjZV90eXBlIiwicmVzb3VyY2VfdHlwZSIsInBfcmVzb3VyY2VfaWQiLCJyZXNvdXJjZV9pZCIsInBfcmVzb3VyY2VfbmFtZSIsInJlc291cmNlX25hbWUiLCJwX2FjdGlvbiIsImFjdGlvbiIsInBfZGVzY3JpcHRpb24iLCJkZXNjcmlwdGlvbiIsInBfb2xkX3ZhbHVlcyIsIm9sZF92YWx1ZXMiLCJwX25ld192YWx1ZXMiLCJuZXdfdmFsdWVzIiwicF9zZXNzaW9uX2lkIiwic2Vzc2lvbl9pZCIsInBfaXBfYWRkcmVzcyIsImlwX2FkZHJlc3MiLCJwX3VzZXJfYWdlbnQiLCJ1c2VyX2FnZW50IiwicF9zdGF0dXMiLCJzdGF0dXMiLCJwX3Jpc2tfbGV2ZWwiLCJyaXNrX2xldmVsIiwicF9tZXRhZGF0YSIsIm1ldGFkYXRhIiwiY29uc29sZSIsImdldENsaWVudEluZm8iLCJyZXEiLCJ1c2VyQWdlbnQiLCJuYXZpZ2F0b3IiLCJmb3J3YXJkZWQiLCJoZWFkZXJzIiwiZ2V0IiwiaXAiLCJzcGxpdCIsInVuZGVmaW5lZCIsImdlbmVyYXRlU2Vzc2lvbklkIiwiRGF0ZSIsIm5vdyIsIk1hdGgiLCJyYW5kb20iLCJ0b1N0cmluZyIsInN1YnN0cmluZyIsImxvZ0F1dGhFdmVudCIsInVzZXJJZCIsImNsaWVudEluZm8iLCJyZXBsYWNlIiwibG9nU3R1ZGVudFJlY29yZEFjY2VzcyIsInN0dWRlbnRJZCIsInJlc291cmNlVHlwZSIsInJlc291cmNlSWQiLCJzdHVkZW50X2lkIiwiaXNfc3R1ZGVudF9yZWNvcmQiLCJjb21wbGlhbmNlX2ZsYWdzIiwibG9nR3JhZGVDaGFuZ2UiLCJncmFkZUlkIiwib2xkR3JhZGUiLCJuZXdHcmFkZSIsImxvZ0NvbnNlbnRBY3Rpb24iLCJjb25zZW50SWQiLCJjb25zZW50VHlwZSIsInBhcmVudGFsX2NvbnNlbnRfaWQiLCJjb25zZW50X3R5cGUiLCJsb2dEYXRhRXhwb3J0IiwiZXhwb3J0Rm9ybWF0IiwicmVjb3JkQ291bnQiLCJleHBvcnRfZm9ybWF0IiwicmVjb3JkX2NvdW50IiwibG9nQ29uZmlnQ2hhbmdlIiwib2xkVmFsdWVzIiwibmV3VmFsdWVzIiwiYXV0b21hdGljRmllbGRzIiwiZmlsdGVyZWRPbGRWYWx1ZXMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJmaWx0ZXIiLCJrZXkiLCJpbmNsdWRlcyIsImZpbHRlcmVkTmV3VmFsdWVzIiwiZ2V0QXVkaXRFdmVudHMiLCJmaWx0ZXJzIiwicXVlcnkiLCJmcm9tIiwic2VsZWN0IiwiY291bnQiLCJkYXRlX2Zyb20iLCJndGUiLCJkYXRlX3RvIiwibHRlIiwidXNlcl9pZHMiLCJsZW5ndGgiLCJpbiIsInN0dWRlbnRfaWRzIiwiZXZlbnRfdHlwZXMiLCJldmVudF9jYXRlZ29yaWVzIiwicmVzb3VyY2VfdHlwZXMiLCJyaXNrX2xldmVscyIsImVxIiwiaXNfbWlub3JfZGF0YSIsInNlYXJjaCIsInRleHRTZWFyY2giLCJvcmRlciIsImFzY2VuZGluZyIsImxpbWl0Iiwib2Zmc2V0IiwicmFuZ2UiLCJnZXRTdHVkZW50UmVjb3JkQWNjZXNzIiwiZGF0ZUZyb20iLCJkYXRlVG8iLCJnZXRHcmFkZUNoYW5nZXMiLCJnZXRIaWdoUmlza0V2ZW50cyIsImdldEFjdGl2ZUFsZXJ0cyIsImdldFBhcmVudGFsQ29uc2VudCIsImhhc1ZhbGlkQ29uc2VudCIsInNpbmdsZSIsImNvbnNlbnREYXRhIiwiZXhwaXJlc19hdCIsImV4cGlyeURhdGUiLCJ2ZXJpZnlBdWRpdENoYWluIiwicF9kYXRlX2Zyb20iLCJ0b0lTT1N0cmluZyIsInBfZGF0ZV90byIsImlzVmFsaWQiLCJ0b3RhbEV2ZW50cyIsImludmFsaWRFdmVudHMiLCJyZXN1bHQiLCJpc192YWxpZCIsInRvdGFsX2V2ZW50cyIsImludmFsaWRfZXZlbnRzIiwiZ2VuZXJhdGVDb21wbGlhbmNlUmVwb3J0IiwiZnJhbWV3b3JrIiwicF9mcmFtZXdvcmsiLCJhdWRpdFNlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/audit/auditService.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminClient: () => (/* binding */ createAdminClient),\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n\n// Regular authenticated client (subject to RLS)\nasync function createClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const client = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRnZG9uZHN2dHFicW5zZWNiYXl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNjQ3ODIsImV4cCI6MjA3Nzg0MDc4Mn0.vJCiJGwPGhy_q7avgMnsjihi4i1a7GFUwoGv3Go-9c0\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // The `set` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // The `delete` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n    // Set tenant context if multitenancy is enabled\n    if (true) {\n        try {\n            const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.headers)();\n            const tenantSlug = headersList.get(\"x-tenant-slug\");\n            if (tenantSlug) {\n                // Get tenant ID from slug\n                const { data: tenant } = await client.rpc(\"get_tenant_by_slug\", {\n                    p_slug: tenantSlug\n                }).single();\n                const typedTenant = tenant;\n                if (typedTenant?.id) {\n                    // Set current tenant in database session\n                    await client.rpc(\"set_current_tenant\", {\n                        p_tenant_id: typedTenant.id\n                    });\n                }\n            }\n        } catch (error) {\n            console.error(\"Error setting tenant context:\", error);\n        // Don't fail the request, just log the error\n        }\n    }\n    return client;\n}\n// Admin client with service role (bypasses RLS)\n// Use this for admin operations that need to bypass RLS policies\nfunction createAdminClient() {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFnRDtBQUN1QjtBQUNNO0FBRTdFLGdEQUFnRDtBQUN6QyxlQUFlRztJQUNwQixNQUFNRSxjQUFjLE1BQU1MLHFEQUFPQTtJQUVqQyxNQUFNTSxTQUFTSixpRUFBa0JBLENBQy9CSywwQ0FBb0MsRUFDcENBLGtOQUF5QyxFQUN6QztRQUNFUCxTQUFTO1lBQ1BXLEtBQUlDLElBQVk7Z0JBQ2QsT0FBT1AsWUFBWU0sR0FBRyxDQUFDQyxPQUFPQztZQUNoQztZQUNBQyxLQUFJRixJQUFZLEVBQUVDLEtBQWEsRUFBRUUsT0FBc0I7Z0JBQ3JELElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DO3dCQUFPLEdBQUdFLE9BQU87b0JBQUM7Z0JBQzVDLEVBQUUsT0FBT0MsT0FBTztnQkFDZCx1REFBdUQ7Z0JBQ3ZELHdEQUF3RDtnQkFDeEQsaUJBQWlCO2dCQUNuQjtZQUNGO1lBQ0FDLFFBQU9MLElBQVksRUFBRUcsT0FBc0I7Z0JBQ3pDLElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DLE9BQU87d0JBQUksR0FBR0UsT0FBTztvQkFBQztnQkFDaEQsRUFBRSxPQUFPQyxPQUFPO2dCQUNkLDBEQUEwRDtnQkFDMUQsd0RBQXdEO2dCQUN4RCxpQkFBaUI7Z0JBQ25CO1lBQ0Y7UUFDRjtJQUNGO0lBR0YsZ0RBQWdEO0lBQ2hELElBQUlULElBQWlELEVBQVE7UUFDM0QsSUFBSTtZQUNGLE1BQU1ZLGNBQWMsTUFBTWxCLHFEQUFPQTtZQUNqQyxNQUFNbUIsYUFBYUQsWUFBWVIsR0FBRyxDQUFDO1lBRW5DLElBQUlTLFlBQVk7Z0JBQ2QsMEJBQTBCO2dCQUMxQixNQUFNLEVBQUVDLE1BQU1DLE1BQU0sRUFBRSxHQUFHLE1BQU1oQixPQUM1QmlCLEdBQUcsQ0FBQyxzQkFBc0I7b0JBQUVDLFFBQVFKO2dCQUFXLEdBQy9DSyxNQUFNO2dCQUVULE1BQU1DLGNBQWNKO2dCQUNwQixJQUFJSSxhQUFhQyxJQUFJO29CQUNuQix5Q0FBeUM7b0JBQ3pDLE1BQU1yQixPQUFPaUIsR0FBRyxDQUFDLHNCQUFzQjt3QkFBRUssYUFBYUYsWUFBWUMsRUFBRTtvQkFBQztnQkFDdkU7WUFDRjtRQUNGLEVBQUUsT0FBT1gsT0FBTztZQUNkYSxRQUFRYixLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyw2Q0FBNkM7UUFDL0M7SUFDRjtJQUVBLE9BQU9WO0FBQ1Q7QUFFQSxnREFBZ0Q7QUFDaEQsaUVBQWlFO0FBQzFELFNBQVN3QjtJQUNkLE9BQU8xQixtRUFBb0JBLENBQ3pCRywwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ3VCLHlCQUF5QixFQUNyQztRQUNFQyxNQUFNO1lBQ0pDLGtCQUFrQjtZQUNsQkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhcmVudGluZy1zY2hvb2wtcGxhdGZvcm0vLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cz8yZThlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMsIGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCBhcyBjcmVhdGVTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbi8vIFJlZ3VsYXIgYXV0aGVudGljYXRlZCBjbGllbnQgKHN1YmplY3QgdG8gUkxTKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNsaWVudCgpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG5cbiAgY29uc3QgY2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXQobmFtZSk/LnZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYHNldGAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IENvb2tpZU9wdGlvbnMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6ICcnLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYGRlbGV0ZWAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH1cbiAgKTtcblxuICAvLyBTZXQgdGVuYW50IGNvbnRleHQgaWYgbXVsdGl0ZW5hbmN5IGlzIGVuYWJsZWRcbiAgaWYgKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01VTFRJVEVOQU5DWV9FTkFCTEVEID09PSAndHJ1ZScpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGVhZGVyc0xpc3QgPSBhd2FpdCBoZWFkZXJzKCk7XG4gICAgICBjb25zdCB0ZW5hbnRTbHVnID0gaGVhZGVyc0xpc3QuZ2V0KCd4LXRlbmFudC1zbHVnJyk7XG5cbiAgICAgIGlmICh0ZW5hbnRTbHVnKSB7XG4gICAgICAgIC8vIEdldCB0ZW5hbnQgSUQgZnJvbSBzbHVnXG4gICAgICAgIGNvbnN0IHsgZGF0YTogdGVuYW50IH0gPSBhd2FpdCBjbGllbnRcbiAgICAgICAgICAucnBjKCdnZXRfdGVuYW50X2J5X3NsdWcnLCB7IHBfc2x1ZzogdGVuYW50U2x1ZyB9KVxuICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICBjb25zdCB0eXBlZFRlbmFudCA9IHRlbmFudCBhcyB7IGlkOiBzdHJpbmc7IHNsdWc6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0gfCBudWxsO1xuICAgICAgICBpZiAodHlwZWRUZW5hbnQ/LmlkKSB7XG4gICAgICAgICAgLy8gU2V0IGN1cnJlbnQgdGVuYW50IGluIGRhdGFiYXNlIHNlc3Npb25cbiAgICAgICAgICBhd2FpdCBjbGllbnQucnBjKCdzZXRfY3VycmVudF90ZW5hbnQnLCB7IHBfdGVuYW50X2lkOiB0eXBlZFRlbmFudC5pZCB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHRlbmFudCBjb250ZXh0OicsIGVycm9yKTtcbiAgICAgIC8vIERvbid0IGZhaWwgdGhlIHJlcXVlc3QsIGp1c3QgbG9nIHRoZSBlcnJvclxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjbGllbnQ7XG59XG5cbi8vIEFkbWluIGNsaWVudCB3aXRoIHNlcnZpY2Ugcm9sZSAoYnlwYXNzZXMgUkxTKVxuLy8gVXNlIHRoaXMgZm9yIGFkbWluIG9wZXJhdGlvbnMgdGhhdCBuZWVkIHRvIGJ5cGFzcyBSTFMgcG9saWNpZXNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBZG1pbkNsaWVudCgpIHtcbiAgcmV0dXJuIGNyZWF0ZVN1cGFiYXNlQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXG4gICAge1xuICAgICAgYXV0aDoge1xuICAgICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICApO1xufSJdLCJuYW1lcyI6WyJjb29raWVzIiwiaGVhZGVycyIsImNyZWF0ZVNlcnZlckNsaWVudCIsImNyZWF0ZUNsaWVudCIsImNyZWF0ZVN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJjbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwiZXJyb3IiLCJyZW1vdmUiLCJORVhUX1BVQkxJQ19NVUxUSVRFTkFOQ1lfRU5BQkxFRCIsImhlYWRlcnNMaXN0IiwidGVuYW50U2x1ZyIsImRhdGEiLCJ0ZW5hbnQiLCJycGMiLCJwX3NsdWciLCJzaW5nbGUiLCJ0eXBlZFRlbmFudCIsImlkIiwicF90ZW5hbnRfaWQiLCJjb25zb2xlIiwiY3JlYXRlQWRtaW5DbGllbnQiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/server.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant/auth.ts":
/*!********************************!*\
  !*** ./src/lib/tenant/auth.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   verifyTenantAdmin: () => (/* binding */ verifyTenantAdmin),\n/* harmony export */   verifyTenantMember: () => (/* binding */ verifyTenantMember)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _detection__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./detection */ \"(rsc)/./src/lib/tenant/detection.ts\");\n\n\n/**\n * Verify that the current user is authenticated and is an admin/owner in the current tenant\n * @param request - The Next.js request object\n * @returns Object with user, tenant, and tenant user role, or null if unauthorized\n */ async function verifyTenantAdmin(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return null;\n        }\n        // Get current tenant\n        const tenant = await (0,_detection__WEBPACK_IMPORTED_MODULE_1__.getCurrentTenant)(request);\n        if (!tenant) {\n            return null;\n        }\n        // Check if user is admin/owner in this tenant\n        const { data: tenantUser } = await supabase.from(\"tenant_users\").select(\"role, status\").eq(\"tenant_id\", tenant.id).eq(\"user_id\", user.id).single();\n        if (!tenantUser || tenantUser.status !== \"active\") {\n            return null;\n        }\n        if (![\n            \"owner\",\n            \"admin\"\n        ].includes(tenantUser.role)) {\n            return null;\n        }\n        return {\n            user,\n            tenant,\n            tenantRole: tenantUser.role\n        };\n    } catch (error) {\n        console.error(\"Error verifying tenant admin:\", error);\n        return null;\n    }\n}\n/**\n * Verify that the current user is authenticated and belongs to the current tenant\n * @param request - The Next.js request object\n * @returns Object with user, tenant, and tenant user role, or null if unauthorized\n */ async function verifyTenantMember(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return null;\n        }\n        // Get current tenant\n        const tenant = await (0,_detection__WEBPACK_IMPORTED_MODULE_1__.getCurrentTenant)(request);\n        if (!tenant) {\n            return null;\n        }\n        // Check if user belongs to this tenant\n        const { data: tenantUser } = await supabase.from(\"tenant_users\").select(\"role, status\").eq(\"tenant_id\", tenant.id).eq(\"user_id\", user.id).single();\n        if (!tenantUser || tenantUser.status !== \"active\") {\n            return null;\n        }\n        return {\n            user,\n            tenant,\n            tenantRole: tenantUser.role\n        };\n    } catch (error) {\n        console.error(\"Error verifying tenant member:\", error);\n        return null;\n    }\n}\n/**\n * Check if the current user is a super admin\n * @returns boolean indicating if user is super admin\n */ async function isSuperAdmin() {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return false;\n        }\n        const { data } = await supabase.rpc(\"is_super_admin\", {\n            p_user_id: user.id\n        });\n        return data === true;\n    } catch (error) {\n        console.error(\"Error checking super admin status:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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O0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wYXJlbnRpbmctc2Nob29sLXBsYXRmb3JtLy4vc3JjL2xpYi90ZW5hbnQvYXV0aC50cz9mZjVmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcic7XG5pbXBvcnQgeyBnZXRDdXJyZW50VGVuYW50IH0gZnJvbSAnLi9kZXRlY3Rpb24nO1xuXG4vKipcbiAqIFZlcmlmeSB0aGF0IHRoZSBjdXJyZW50IHVzZXIgaXMgYXV0aGVudGljYXRlZCBhbmQgaXMgYW4gYWRtaW4vb3duZXIgaW4gdGhlIGN1cnJlbnQgdGVuYW50XG4gKiBAcGFyYW0gcmVxdWVzdCAtIFRoZSBOZXh0LmpzIHJlcXVlc3Qgb2JqZWN0XG4gKiBAcmV0dXJucyBPYmplY3Qgd2l0aCB1c2VyLCB0ZW5hbnQsIGFuZCB0ZW5hbnQgdXNlciByb2xlLCBvciBudWxsIGlmIHVuYXV0aG9yaXplZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VGVuYW50QWRtaW4ocmVxdWVzdDogUmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcblxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gR2V0IGN1cnJlbnQgdGVuYW50XG4gICAgY29uc3QgdGVuYW50ID0gYXdhaXQgZ2V0Q3VycmVudFRlbmFudChyZXF1ZXN0KTtcbiAgICBpZiAoIXRlbmFudCkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgaWYgdXNlciBpcyBhZG1pbi9vd25lciBpbiB0aGlzIHRlbmFudFxuICAgIGNvbnN0IHsgZGF0YTogdGVuYW50VXNlciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRfdXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZSwgc3RhdHVzJylcbiAgICAgIC5lcSgndGVuYW50X2lkJywgdGVuYW50LmlkKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICghdGVuYW50VXNlciB8fCB0ZW5hbnRVc2VyLnN0YXR1cyAhPT0gJ2FjdGl2ZScpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIGlmICghWydvd25lcicsICdhZG1pbiddLmluY2x1ZGVzKHRlbmFudFVzZXIucm9sZSkpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1c2VyLFxuICAgICAgdGVuYW50LFxuICAgICAgdGVuYW50Um9sZTogdGVuYW50VXNlci5yb2xlLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHRlbmFudCBhZG1pbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBWZXJpZnkgdGhhdCB0aGUgY3VycmVudCB1c2VyIGlzIGF1dGhlbnRpY2F0ZWQgYW5kIGJlbG9uZ3MgdG8gdGhlIGN1cnJlbnQgdGVuYW50XG4gKiBAcGFyYW0gcmVxdWVzdCAtIFRoZSBOZXh0LmpzIHJlcXVlc3Qgb2JqZWN0XG4gKiBAcmV0dXJucyBPYmplY3Qgd2l0aCB1c2VyLCB0ZW5hbnQsIGFuZCB0ZW5hbnQgdXNlciByb2xlLCBvciBudWxsIGlmIHVuYXV0aG9yaXplZFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdmVyaWZ5VGVuYW50TWVtYmVyKHJlcXVlc3Q6IFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgLy8gQ2hlY2sgYXV0aGVudGljYXRpb25cbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIEdldCBjdXJyZW50IHRlbmFudFxuICAgIGNvbnN0IHRlbmFudCA9IGF3YWl0IGdldEN1cnJlbnRUZW5hbnQocmVxdWVzdCk7XG4gICAgaWYgKCF0ZW5hbnQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHVzZXIgYmVsb25ncyB0byB0aGlzIHRlbmFudFxuICAgIGNvbnN0IHsgZGF0YTogdGVuYW50VXNlciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5mcm9tKCd0ZW5hbnRfdXNlcnMnKVxuICAgICAgLnNlbGVjdCgncm9sZSwgc3RhdHVzJylcbiAgICAgIC5lcSgndGVuYW50X2lkJywgdGVuYW50LmlkKVxuICAgICAgLmVxKCd1c2VyX2lkJywgdXNlci5pZClcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmICghdGVuYW50VXNlciB8fCB0ZW5hbnRVc2VyLnN0YXR1cyAhPT0gJ2FjdGl2ZScpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICB1c2VyLFxuICAgICAgdGVuYW50LFxuICAgICAgdGVuYW50Um9sZTogdGVuYW50VXNlci5yb2xlLFxuICAgIH07XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgdmVyaWZ5aW5nIHRlbmFudCBtZW1iZXI6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogQ2hlY2sgaWYgdGhlIGN1cnJlbnQgdXNlciBpcyBhIHN1cGVyIGFkbWluXG4gKiBAcmV0dXJucyBib29sZWFuIGluZGljYXRpbmcgaWYgdXNlciBpcyBzdXBlciBhZG1pblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNTdXBlckFkbWluKCk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7XG4gICAgICBkYXRhOiB7IHVzZXIgfSxcbiAgICB9ID0gYXdhaXQgc3VwYWJhc2UuYXV0aC5nZXRVc2VyKCk7XG5cbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IHN1cGFiYXNlLnJwYygnaXNfc3VwZXJfYWRtaW4nLCB7IHBfdXNlcl9pZDogdXNlci5pZCB9KTtcbiAgICByZXR1cm4gZGF0YSA9PT0gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjaGVja2luZyBzdXBlciBhZG1pbiBzdGF0dXM6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsImdldEN1cnJlbnRUZW5hbnQiLCJ2ZXJpZnlUZW5hbnRBZG1pbiIsInJlcXVlc3QiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiYXV0aCIsImdldFVzZXIiLCJ0ZW5hbnQiLCJ0ZW5hbnRVc2VyIiwiZnJvbSIsInNlbGVjdCIsImVxIiwiaWQiLCJzaW5nbGUiLCJzdGF0dXMiLCJpbmNsdWRlcyIsInJvbGUiLCJ0ZW5hbnRSb2xlIiwiZXJyb3IiLCJjb25zb2xlIiwidmVyaWZ5VGVuYW50TWVtYmVyIiwiaXNTdXBlckFkbWluIiwicnBjIiwicF91c2VyX2lkIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant/auth.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/tenant/detection.ts":
/*!*************************************!*\
  !*** ./src/lib/tenant/detection.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getCurrentTenant: () => (/* binding */ getCurrentTenant),\n/* harmony export */   getTenantByDomain: () => (/* binding */ getTenantByDomain),\n/* harmony export */   getTenantBySlug: () => (/* binding */ getTenantBySlug),\n/* harmony export */   getTenantSlugFromHeaders: () => (/* binding */ getTenantSlugFromHeaders),\n/* harmony export */   getTenantSlugFromPath: () => (/* binding */ getTenantSlugFromPath),\n/* harmony export */   getUserTenantRole: () => (/* binding */ getUserTenantRole),\n/* harmony export */   getUserTenants: () => (/* binding */ getUserTenants),\n/* harmony export */   isSuperAdmin: () => (/* binding */ isSuperAdmin),\n/* harmony export */   validateUserTenantAccess: () => (/* binding */ validateUserTenantAccess)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n// ============================================================================\n// MULTITENANCY: TENANT DETECTION\n// ============================================================================\n// Functions for detecting and retrieving tenant information\n// ============================================================================\n\n/**\n * Get tenant slug from request headers (set by middleware)\n */ function getTenantSlugFromHeaders(headers) {\n    return headers.get(\"x-tenant-slug\");\n}\n/**\n * Get tenant by slug from database\n */ async function getTenantBySlug(slug) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_tenant_by_slug\", {\n            p_slug: slug\n        }).single();\n        if (error) {\n            console.error(\"Error fetching tenant by slug:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getTenantBySlug:\", error);\n        return null;\n    }\n}\n/**\n * Get tenant by custom domain\n */ async function getTenantByDomain(domain) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_tenant_by_domain\", {\n            p_domain: domain\n        }).single();\n        if (error) {\n            console.error(\"Error fetching tenant by domain:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getTenantByDomain:\", error);\n        return null;\n    }\n}\n/**\n * Extract tenant slug from URL path\n * Supports path-based routing: /org/{slug}/...\n */ function getTenantSlugFromPath(url) {\n    try {\n        const urlObj = new URL(url);\n        const pathMatch = urlObj.pathname.match(/^\\/org\\/([a-z0-9][a-z0-9-]{1,61}[a-z0-9])/);\n        return pathMatch ? pathMatch[1] : null;\n    } catch  {\n        return null;\n    }\n}\n/**\n * Get current tenant from request\n * Priority:\n * 1. Path-based routing (/org/{slug}) - for localhost testing\n * 2. Custom domain\n * 3. Subdomain from headers\n * 4. Default tenant (localhost fallback)\n */ async function getCurrentTenant(request) {\n    const headers = new Headers(request.headers);\n    const hostname = headers.get(\"host\") || \"\";\n    const url = request.url;\n    const defaultTenantSlug = \"default\" || 0;\n    // For local development with path-based routing\n    if (hostname.includes(\"localhost\") || hostname.includes(\"127.0.0.1\")) {\n        // Check for path-based tenant: /org/{slug}/...\n        const pathSlug = getTenantSlugFromPath(url);\n        if (pathSlug) {\n            const tenant = await getTenantBySlug(pathSlug);\n            if (tenant) {\n                return tenant;\n            }\n        }\n        // Fall back to default tenant for localhost\n        return getTenantBySlug(defaultTenantSlug);\n    }\n    // Production: Try custom domain first\n    let tenant = await getTenantByDomain(hostname);\n    if (tenant) {\n        return tenant;\n    }\n    // Fall back to subdomain from middleware\n    const tenantSlug = getTenantSlugFromHeaders(headers);\n    if (tenantSlug) {\n        tenant = await getTenantBySlug(tenantSlug);\n    }\n    return tenant;\n}\n/**\n * Validate that a user belongs to a tenant\n */ async function validateUserTenantAccess(userId, tenantId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"user_belongs_to_tenant\", {\n            p_user_id: userId,\n            p_tenant_id: tenantId\n        });\n        if (error) {\n            console.error(\"Error validating tenant access:\", error);\n            return false;\n        }\n        return data === true;\n    } catch (error) {\n        console.error(\"Error in validateUserTenantAccess:\", error);\n        return false;\n    }\n}\n/**\n * Get user's role in a tenant\n */ async function getUserTenantRole(userId, tenantId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_user_tenant_role\", {\n            p_user_id: userId,\n            p_tenant_id: tenantId\n        });\n        if (error) {\n            console.error(\"Error fetching user tenant role:\", error);\n            return null;\n        }\n        return data;\n    } catch (error) {\n        console.error(\"Error in getUserTenantRole:\", error);\n        return null;\n    }\n}\n/**\n * Get all tenants a user belongs to\n */ async function getUserTenants(userId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"get_user_tenants\", {\n            p_user_id: userId\n        });\n        if (error) {\n            console.error(\"Error fetching user tenants:\", error);\n            return [];\n        }\n        return data || [];\n    } catch (error) {\n        console.error(\"Error in getUserTenants:\", error);\n        return [];\n    }\n}\n/**\n * Check if user is a super admin\n */ async function isSuperAdmin(userId) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_0__.createClient)();\n        const { data, error } = await supabase.rpc(\"is_super_admin\", {\n            p_user_id: userId\n        });\n        if (error) {\n            console.error(\"Error checking super admin status:\", error);\n            return false;\n        }\n        return data === true;\n    } catch (error) {\n        console.error(\"Error in isSuperAdmin:\", error);\n        return false;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LGVBQWVrQyxhQUFhTixNQUFjO0lBQy9DLElBQUk7UUFDRixNQUFNOUIsV0FBVyxNQUFNTixrRUFBWUE7UUFFbkMsTUFBTSxFQUFFTyxJQUFJLEVBQUVDLEtBQUssRUFBRSxHQUFHLE1BQU1GLFNBQzNCRyxHQUFHLENBQUMsa0JBQWtCO1lBQUU2QixXQUFXRjtRQUFPO1FBRTdDLElBQUk1QixPQUFPO1lBQ1RJLFFBQVFKLEtBQUssQ0FBQyxzQ0FBc0NBO1lBQ3BELE9BQU87UUFDVDtRQUVBLE9BQU9ELFNBQVM7SUFDbEIsRUFBRSxPQUFPQyxPQUFPO1FBQ2RJLFFBQVFKLEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU87SUFDVDtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8uL3NyYy9saWIvdGVuYW50L2RldGVjdGlvbi50cz8yZWY0Il0sInNvdXJjZXNDb250ZW50IjpbIi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIE1VTFRJVEVOQU5DWTogVEVOQU5UIERFVEVDVElPTlxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuLy8gRnVuY3Rpb25zIGZvciBkZXRlY3RpbmcgYW5kIHJldHJpZXZpbmcgdGVuYW50IGluZm9ybWF0aW9uXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcic7XG5pbXBvcnQgdHlwZSB7IFRlbmFudCB9IGZyb20gJy4vdHlwZXMnO1xuXG4vKipcbiAqIEdldCB0ZW5hbnQgc2x1ZyBmcm9tIHJlcXVlc3QgaGVhZGVycyAoc2V0IGJ5IG1pZGRsZXdhcmUpXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMoaGVhZGVyczogSGVhZGVycyk6IHN0cmluZyB8IG51bGwge1xuICByZXR1cm4gaGVhZGVycy5nZXQoJ3gtdGVuYW50LXNsdWcnKTtcbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGJ5IHNsdWcgZnJvbSBkYXRhYmFzZVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGVuYW50QnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8VGVuYW50IHwgbnVsbD4ge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLnJwYygnZ2V0X3RlbmFudF9ieV9zbHVnJywgeyBwX3NsdWc6IHNsdWcgfSlcbiAgICAgIC5zaW5nbGUoKTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgdGVuYW50IGJ5IHNsdWc6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgYXMgVGVuYW50O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluIGdldFRlbmFudEJ5U2x1ZzonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgdGVuYW50IGJ5IGN1c3RvbSBkb21haW5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFRlbmFudEJ5RG9tYWluKGRvbWFpbjogc3RyaW5nKTogUHJvbWlzZTxUZW5hbnQgfCBudWxsPiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAucnBjKCdnZXRfdGVuYW50X2J5X2RvbWFpbicsIHsgcF9kb21haW46IGRvbWFpbiB9KVxuICAgICAgLnNpbmdsZSgpO1xuXG4gICAgaWYgKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyB0ZW5hbnQgYnkgZG9tYWluOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiBkYXRhIGFzIFRlbmFudDtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBnZXRUZW5hbnRCeURvbWFpbjonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuLyoqXG4gKiBFeHRyYWN0IHRlbmFudCBzbHVnIGZyb20gVVJMIHBhdGhcbiAqIFN1cHBvcnRzIHBhdGgtYmFzZWQgcm91dGluZzogL29yZy97c2x1Z30vLi4uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZXRUZW5hbnRTbHVnRnJvbVBhdGgodXJsOiBzdHJpbmcpOiBzdHJpbmcgfCBudWxsIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB1cmxPYmogPSBuZXcgVVJMKHVybCk7XG4gICAgY29uc3QgcGF0aE1hdGNoID0gdXJsT2JqLnBhdGhuYW1lLm1hdGNoKC9eXFwvb3JnXFwvKFthLXowLTldW2EtejAtOS1dezEsNjF9W2EtejAtOV0pLyk7XG4gICAgcmV0dXJuIHBhdGhNYXRjaCA/IHBhdGhNYXRjaFsxXSA6IG51bGw7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGN1cnJlbnQgdGVuYW50IGZyb20gcmVxdWVzdFxuICogUHJpb3JpdHk6XG4gKiAxLiBQYXRoLWJhc2VkIHJvdXRpbmcgKC9vcmcve3NsdWd9KSAtIGZvciBsb2NhbGhvc3QgdGVzdGluZ1xuICogMi4gQ3VzdG9tIGRvbWFpblxuICogMy4gU3ViZG9tYWluIGZyb20gaGVhZGVyc1xuICogNC4gRGVmYXVsdCB0ZW5hbnQgKGxvY2FsaG9zdCBmYWxsYmFjaylcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldEN1cnJlbnRUZW5hbnQocmVxdWVzdDogUmVxdWVzdCk6IFByb21pc2U8VGVuYW50IHwgbnVsbD4ge1xuICBjb25zdCBoZWFkZXJzID0gbmV3IEhlYWRlcnMocmVxdWVzdC5oZWFkZXJzKTtcbiAgY29uc3QgaG9zdG5hbWUgPSBoZWFkZXJzLmdldCgnaG9zdCcpIHx8ICcnO1xuICBjb25zdCB1cmwgPSByZXF1ZXN0LnVybDtcbiAgY29uc3QgZGVmYXVsdFRlbmFudFNsdWcgPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19ERUZBVUxUX1RFTkFOVF9TTFVHIHx8ICdkZWZhdWx0JztcblxuICAvLyBGb3IgbG9jYWwgZGV2ZWxvcG1lbnQgd2l0aCBwYXRoLWJhc2VkIHJvdXRpbmdcbiAgaWYgKGhvc3RuYW1lLmluY2x1ZGVzKCdsb2NhbGhvc3QnKSB8fCBob3N0bmFtZS5pbmNsdWRlcygnMTI3LjAuMC4xJykpIHtcbiAgICAvLyBDaGVjayBmb3IgcGF0aC1iYXNlZCB0ZW5hbnQ6IC9vcmcve3NsdWd9Ly4uLlxuICAgIGNvbnN0IHBhdGhTbHVnID0gZ2V0VGVuYW50U2x1Z0Zyb21QYXRoKHVybCk7XG4gICAgaWYgKHBhdGhTbHVnKSB7XG4gICAgICBjb25zdCB0ZW5hbnQgPSBhd2FpdCBnZXRUZW5hbnRCeVNsdWcocGF0aFNsdWcpO1xuICAgICAgaWYgKHRlbmFudCkge1xuICAgICAgICByZXR1cm4gdGVuYW50O1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEZhbGwgYmFjayB0byBkZWZhdWx0IHRlbmFudCBmb3IgbG9jYWxob3N0XG4gICAgcmV0dXJuIGdldFRlbmFudEJ5U2x1ZyhkZWZhdWx0VGVuYW50U2x1Zyk7XG4gIH1cblxuICAvLyBQcm9kdWN0aW9uOiBUcnkgY3VzdG9tIGRvbWFpbiBmaXJzdFxuICBsZXQgdGVuYW50ID0gYXdhaXQgZ2V0VGVuYW50QnlEb21haW4oaG9zdG5hbWUpO1xuICBpZiAodGVuYW50KSB7XG4gICAgcmV0dXJuIHRlbmFudDtcbiAgfVxuXG4gIC8vIEZhbGwgYmFjayB0byBzdWJkb21haW4gZnJvbSBtaWRkbGV3YXJlXG4gIGNvbnN0IHRlbmFudFNsdWcgPSBnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMoaGVhZGVycyk7XG4gIGlmICh0ZW5hbnRTbHVnKSB7XG4gICAgdGVuYW50ID0gYXdhaXQgZ2V0VGVuYW50QnlTbHVnKHRlbmFudFNsdWcpO1xuICB9XG5cbiAgcmV0dXJuIHRlbmFudDtcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSB0aGF0IGEgdXNlciBiZWxvbmdzIHRvIGEgdGVuYW50XG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3MoXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5ycGMoJ3VzZXJfYmVsb25nc190b190ZW5hbnQnLCB7XG4gICAgICAgIHBfdXNlcl9pZDogdXNlcklkLFxuICAgICAgICBwX3RlbmFudF9pZDogdGVuYW50SWQsXG4gICAgICB9KTtcblxuICAgIGlmIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdmFsaWRhdGluZyB0ZW5hbnQgYWNjZXNzOicsIGVycm9yKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gZGF0YSA9PT0gdHJ1ZTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiB2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3M6JywgZXJyb3IpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB1c2VyJ3Mgcm9sZSBpbiBhIHRlbmFudFxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VXNlclRlbmFudFJvbGUoXG4gIHVzZXJJZDogc3RyaW5nLFxuICB0ZW5hbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZyB8IG51bGw+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCBzdXBhYmFzZSA9IGF3YWl0IGNyZWF0ZUNsaWVudCgpO1xuXG4gICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgIC5ycGMoJ2dldF91c2VyX3RlbmFudF9yb2xlJywge1xuICAgICAgICBwX3VzZXJfaWQ6IHVzZXJJZCxcbiAgICAgICAgcF90ZW5hbnRfaWQ6IHRlbmFudElkLFxuICAgICAgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgdGVuYW50IHJvbGU6JywgZXJyb3IpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGE7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlclRlbmFudFJvbGU6JywgZXJyb3IpO1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbi8qKlxuICogR2V0IGFsbCB0ZW5hbnRzIGEgdXNlciBiZWxvbmdzIHRvXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRVc2VyVGVuYW50cyh1c2VySWQ6IHN0cmluZykge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgLnJwYygnZ2V0X3VzZXJfdGVuYW50cycsIHsgcF91c2VyX2lkOiB1c2VySWQgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHVzZXIgdGVuYW50czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgfHwgW107XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gZ2V0VXNlclRlbmFudHM6JywgZXJyb3IpO1xuICAgIHJldHVybiBbXTtcbiAgfVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHVzZXIgaXMgYSBzdXBlciBhZG1pblxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gaXNTdXBlckFkbWluKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAucnBjKCdpc19zdXBlcl9hZG1pbicsIHsgcF91c2VyX2lkOiB1c2VySWQgfSk7XG5cbiAgICBpZiAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNoZWNraW5nIHN1cGVyIGFkbWluIHN0YXR1czonLCBlcnJvcik7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRhdGEgPT09IHRydWU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgaW4gaXNTdXBlckFkbWluOicsIGVycm9yKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJjcmVhdGVDbGllbnQiLCJnZXRUZW5hbnRTbHVnRnJvbUhlYWRlcnMiLCJoZWFkZXJzIiwiZ2V0IiwiZ2V0VGVuYW50QnlTbHVnIiwic2x1ZyIsInN1cGFiYXNlIiwiZGF0YSIsImVycm9yIiwicnBjIiwicF9zbHVnIiwic2luZ2xlIiwiY29uc29sZSIsImdldFRlbmFudEJ5RG9tYWluIiwiZG9tYWluIiwicF9kb21haW4iLCJnZXRUZW5hbnRTbHVnRnJvbVBhdGgiLCJ1cmwiLCJ1cmxPYmoiLCJVUkwiLCJwYXRoTWF0Y2giLCJwYXRobmFtZSIsIm1hdGNoIiwiZ2V0Q3VycmVudFRlbmFudCIsInJlcXVlc3QiLCJIZWFkZXJzIiwiaG9zdG5hbWUiLCJkZWZhdWx0VGVuYW50U2x1ZyIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19ERUZBVUxUX1RFTkFOVF9TTFVHIiwiaW5jbHVkZXMiLCJwYXRoU2x1ZyIsInRlbmFudCIsInRlbmFudFNsdWciLCJ2YWxpZGF0ZVVzZXJUZW5hbnRBY2Nlc3MiLCJ1c2VySWQiLCJ0ZW5hbnRJZCIsInBfdXNlcl9pZCIsInBfdGVuYW50X2lkIiwiZ2V0VXNlclRlbmFudFJvbGUiLCJnZXRVc2VyVGVuYW50cyIsImlzU3VwZXJBZG1pbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/tenant/detection.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Fadmin%2Flanguages%2Froute&page=%2Fapi%2Fadmin%2Flanguages%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fadmin%2Flanguages%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();