"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/lms/courses/route";
exports.ids = ["app/api/lms/courses/route"];
exports.modules = {

/***/ "../../client/components/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/client/components/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/action-async-storage.external.js");

/***/ }),

/***/ "../../client/components/request-async-storage.external":
/*!********************************************************************************!*\
  !*** external "next/dist/client/components/request-async-storage.external.js" ***!
  \********************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/request-async-storage.external.js");

/***/ }),

/***/ "../../client/components/static-generation-async-storage.external":
/*!******************************************************************************************!*\
  !*** external "next/dist/client/components/static-generation-async-storage.external.js" ***!
  \******************************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/client/components/static-generation-async-storage.external.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Flms%2Fcourses%2Froute&page=%2Fapi%2Flms%2Fcourses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flms%2Fcourses%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Flms%2Fcourses%2Froute&page=%2Fapi%2Flms%2Fcourses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flms%2Fcourses%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \*****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_lms_courses_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/lms/courses/route.ts */ \"(rsc)/./src/app/api/lms/courses/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/lms/courses/route\",\n        pathname: \"/api/lms/courses\",\n        filename: \"route\",\n        bundlePath: \"app/api/lms/courses/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\OffirOmer\\\\Documents\\\\IPSPlatform\\\\src\\\\app\\\\api\\\\lms\\\\courses\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_OffirOmer_Documents_IPSPlatform_src_app_api_lms_courses_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/lms/courses/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZsbXMlMkZjb3Vyc2VzJTJGcm91dGUmcGFnZT0lMkZhcGklMkZsbXMlMkZjb3Vyc2VzJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGbG1zJTJGY291cnNlcyUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNPZmZpck9tZXIlNUNEb2N1bWVudHMlNUNJUFNQbGF0Zm9ybSU1Q3NyYyU1Q2FwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9QyUzQSU1Q1VzZXJzJTVDT2ZmaXJPbWVyJTVDRG9jdW1lbnRzJTVDSVBTUGxhdGZvcm0maXNEZXY9dHJ1ZSZ0c2NvbmZpZ1BhdGg9dHNjb25maWcuanNvbiZiYXNlUGF0aD0mYXNzZXRQcmVmaXg9Jm5leHRDb25maWdPdXRwdXQ9JnByZWZlcnJlZFJlZ2lvbj0mbWlkZGxld2FyZUNvbmZpZz1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNjO0FBQ21DO0FBQ2hIO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixnSEFBbUI7QUFDM0M7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxZQUFZO0FBQ1osQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsaUVBQWlFO0FBQ3pFO0FBQ0E7QUFDQSxXQUFXLDRFQUFXO0FBQ3RCO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDdUg7O0FBRXZIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8/OTc2MiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBcHBSb3V0ZVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IHBhdGNoRmV0Y2ggYXMgX3BhdGNoRmV0Y2ggfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvcGF0Y2gtZmV0Y2hcIjtcbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCJDOlxcXFxVc2Vyc1xcXFxPZmZpck9tZXJcXFxcRG9jdW1lbnRzXFxcXElQU1BsYXRmb3JtXFxcXHNyY1xcXFxhcHBcXFxcYXBpXFxcXGxtc1xcXFxjb3Vyc2VzXFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9sbXMvY291cnNlcy9yb3V0ZVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2xtcy9jb3Vyc2VzXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcInJvdXRlXCIsXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiYXBwL2FwaS9sbXMvY291cnNlcy9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXE9mZmlyT21lclxcXFxEb2N1bWVudHNcXFxcSVBTUGxhdGZvcm1cXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcbG1zXFxcXGNvdXJzZXNcXFxccm91dGUudHNcIixcbiAgICBuZXh0Q29uZmlnT3V0cHV0LFxuICAgIHVzZXJsYW5kXG59KTtcbi8vIFB1bGwgb3V0IHRoZSBleHBvcnRzIHRoYXQgd2UgbmVlZCB0byBleHBvc2UgZnJvbSB0aGUgbW9kdWxlLiBUaGlzIHNob3VsZFxuLy8gYmUgZWxpbWluYXRlZCB3aGVuIHdlJ3ZlIG1vdmVkIHRoZSBvdGhlciByb3V0ZXMgdG8gdGhlIG5ldyBmb3JtYXQuIFRoZXNlXG4vLyBhcmUgdXNlZCB0byBob29rIGludG8gdGhlIHJvdXRlLlxuY29uc3QgeyByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5jb25zdCBvcmlnaW5hbFBhdGhuYW1lID0gXCIvYXBpL2xtcy9jb3Vyc2VzL3JvdXRlXCI7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHNlcnZlckhvb2tzLFxuICAgICAgICBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MsIG9yaWdpbmFsUGF0aG5hbWUsIHBhdGNoRmV0Y2gsICB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Flms%2Fcourses%2Froute&page=%2Fapi%2Flms%2Fcourses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flms%2Fcourses%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/lms/courses/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/lms/courses/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/supabase/server */ \"(rsc)/./src/lib/supabase/server.ts\");\n/* harmony import */ var _lib_lms_courseService__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @/lib/lms/courseService */ \"(rsc)/./src/lib/lms/courseService.ts\");\n\n\n\n// ============================================================================\n// GET /api/lms/courses\n// List all courses with optional filtering\n// ============================================================================\nasync function GET(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Get query parameters\n        const searchParams = request.nextUrl.searchParams;\n        const program_id = searchParams.get(\"program_id\");\n        const instructor_id = searchParams.get(\"instructor_id\");\n        const is_active = searchParams.get(\"is_active\");\n        const search = searchParams.get(\"search\");\n        // Build filter\n        const filter = {};\n        if (program_id) filter.program_id = program_id;\n        if (instructor_id) filter.instructor_id = instructor_id;\n        if (is_active !== null) filter.is_active = is_active === \"true\";\n        if (search) filter.search = search;\n        // Get courses\n        const result = await _lib_lms_courseService__WEBPACK_IMPORTED_MODULE_2__.courseService.listCourses(filter);\n        if (!result.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: result.error\n            }, {\n                status: 400\n            });\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: result.data\n        });\n    } catch (error) {\n        console.error(\"Error fetching courses:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n// ============================================================================\n// POST /api/lms/courses\n// Create a new course\n// ============================================================================\nasync function POST(request) {\n    try {\n        const supabase = await (0,_lib_supabase_server__WEBPACK_IMPORTED_MODULE_1__.createClient)();\n        // Check authentication\n        const { data: { user } } = await supabase.auth.getUser();\n        if (!user) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Unauthorized\"\n            }, {\n                status: 401\n            });\n        }\n        // Get request body\n        const body = await request.json();\n        // Validate required fields\n        if (!body.program_id || !body.title || !body.start_date) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: \"Missing required fields\"\n            }, {\n                status: 400\n            });\n        }\n        // Create course\n        const result = await _lib_lms_courseService__WEBPACK_IMPORTED_MODULE_2__.courseService.createCourse({\n            program_id: body.program_id,\n            instructor_id: body.instructor_id || user.id,\n            title: body.title,\n            description: body.description,\n            access_tag: body.access_tag,\n            start_date: body.start_date,\n            end_date: body.end_date,\n            is_active: body.is_active ?? false\n        });\n        if (!result.success) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: result.error\n            }, {\n                status: 400\n            });\n        }\n        // Log audit event\n        await supabase.from(\"audit_events\").insert({\n            user_id: user.id,\n            event_type: \"CREATE\",\n            event_category: \"EDUCATION\",\n            resource_type: \"courses\",\n            resource_id: result.data.id,\n            action: \"Created new course\",\n            description: `Course: ${body.title}`,\n            new_values: result.data,\n            risk_level: \"low\"\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            data: result.data,\n            message: result.message\n        });\n    } catch (error) {\n        console.error(\"Error creating course:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: \"Internal server error\"\n        }, {\n            status: 500\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8uL3NyYy9hcHAvYXBpL2xtcy9jb3Vyc2VzL3JvdXRlLnRzP2ZmMTAiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gJ25leHQvc2VydmVyJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL3NlcnZlcic7XG5pbXBvcnQgeyBjb3Vyc2VTZXJ2aWNlIH0gZnJvbSAnQC9saWIvbG1zL2NvdXJzZVNlcnZpY2UnO1xuXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4vLyBHRVQgL2FwaS9sbXMvY291cnNlc1xuLy8gTGlzdCBhbGwgY291cnNlcyB3aXRoIG9wdGlvbmFsIGZpbHRlcmluZ1xuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gR0VUKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KSB7XG4gIHRyeSB7XG4gICAgY29uc3Qgc3VwYWJhc2UgPSBhd2FpdCBjcmVhdGVDbGllbnQoKTtcblxuICAgIC8vIENoZWNrIGF1dGhlbnRpY2F0aW9uXG4gICAgY29uc3Qge1xuICAgICAgZGF0YTogeyB1c2VyIH0sXG4gICAgfSA9IGF3YWl0IHN1cGFiYXNlLmF1dGguZ2V0VXNlcigpO1xuXG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVW5hdXRob3JpemVkJyB9LFxuICAgICAgICB7IHN0YXR1czogNDAxIH1cbiAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gR2V0IHF1ZXJ5IHBhcmFtZXRlcnNcbiAgICBjb25zdCBzZWFyY2hQYXJhbXMgPSByZXF1ZXN0Lm5leHRVcmwuc2VhcmNoUGFyYW1zO1xuICAgIGNvbnN0IHByb2dyYW1faWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdwcm9ncmFtX2lkJyk7XG4gICAgY29uc3QgaW5zdHJ1Y3Rvcl9pZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ2luc3RydWN0b3JfaWQnKTtcbiAgICBjb25zdCBpc19hY3RpdmUgPSBzZWFyY2hQYXJhbXMuZ2V0KCdpc19hY3RpdmUnKTtcbiAgICBjb25zdCBzZWFyY2ggPSBzZWFyY2hQYXJhbXMuZ2V0KCdzZWFyY2gnKTtcblxuICAgIC8vIEJ1aWxkIGZpbHRlclxuICAgIGNvbnN0IGZpbHRlcjogYW55ID0ge307XG4gICAgaWYgKHByb2dyYW1faWQpIGZpbHRlci5wcm9ncmFtX2lkID0gcHJvZ3JhbV9pZDtcbiAgICBpZiAoaW5zdHJ1Y3Rvcl9pZCkgZmlsdGVyLmluc3RydWN0b3JfaWQgPSBpbnN0cnVjdG9yX2lkO1xuICAgIGlmIChpc19hY3RpdmUgIT09IG51bGwpIGZpbHRlci5pc19hY3RpdmUgPSBpc19hY3RpdmUgPT09ICd0cnVlJztcbiAgICBpZiAoc2VhcmNoKSBmaWx0ZXIuc2VhcmNoID0gc2VhcmNoO1xuXG4gICAgLy8gR2V0IGNvdXJzZXNcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBjb3Vyc2VTZXJ2aWNlLmxpc3RDb3Vyc2VzKGZpbHRlcik7XG5cbiAgICBpZiAoIXJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiByZXN1bHQuZXJyb3IgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgZGF0YTogcmVzdWx0LmRhdGEsXG4gICAgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRXJyb3IgZmV0Y2hpbmcgY291cnNlczonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIFBPU1QgL2FwaS9sbXMvY291cnNlc1xuLy8gQ3JlYXRlIGEgbmV3IGNvdXJzZVxuLy8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gUE9TVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xuICB0cnkge1xuICAgIGNvbnN0IHN1cGFiYXNlID0gYXdhaXQgY3JlYXRlQ2xpZW50KCk7XG5cbiAgICAvLyBDaGVjayBhdXRoZW50aWNhdGlvblxuICAgIGNvbnN0IHtcbiAgICAgIGRhdGE6IHsgdXNlciB9LFxuICAgIH0gPSBhd2FpdCBzdXBhYmFzZS5hdXRoLmdldFVzZXIoKTtcblxuICAgIGlmICghdXNlcikge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VuYXV0aG9yaXplZCcgfSxcbiAgICAgICAgeyBzdGF0dXM6IDQwMSB9XG4gICAgICApO1xuICAgIH1cblxuICAgIC8vIEdldCByZXF1ZXN0IGJvZHlcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxdWVzdC5qc29uKCk7XG5cbiAgICAvLyBWYWxpZGF0ZSByZXF1aXJlZCBmaWVsZHNcbiAgICBpZiAoIWJvZHkucHJvZ3JhbV9pZCB8fCAhYm9keS50aXRsZSB8fCAhYm9keS5zdGFydF9kYXRlKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnTWlzc2luZyByZXF1aXJlZCBmaWVsZHMnIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBDcmVhdGUgY291cnNlXG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgY291cnNlU2VydmljZS5jcmVhdGVDb3Vyc2Uoe1xuICAgICAgcHJvZ3JhbV9pZDogYm9keS5wcm9ncmFtX2lkLFxuICAgICAgaW5zdHJ1Y3Rvcl9pZDogYm9keS5pbnN0cnVjdG9yX2lkIHx8IHVzZXIuaWQsXG4gICAgICB0aXRsZTogYm9keS50aXRsZSxcbiAgICAgIGRlc2NyaXB0aW9uOiBib2R5LmRlc2NyaXB0aW9uLFxuICAgICAgYWNjZXNzX3RhZzogYm9keS5hY2Nlc3NfdGFnLFxuICAgICAgc3RhcnRfZGF0ZTogYm9keS5zdGFydF9kYXRlLFxuICAgICAgZW5kX2RhdGU6IGJvZHkuZW5kX2RhdGUsXG4gICAgICBpc19hY3RpdmU6IGJvZHkuaXNfYWN0aXZlID8/IGZhbHNlLFxuICAgIH0pO1xuXG4gICAgaWYgKCFyZXN1bHQuc3VjY2Vzcykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogcmVzdWx0LmVycm9yIH0sXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBMb2cgYXVkaXQgZXZlbnRcbiAgICBhd2FpdCBzdXBhYmFzZS5mcm9tKCdhdWRpdF9ldmVudHMnKS5pbnNlcnQoe1xuICAgICAgdXNlcl9pZDogdXNlci5pZCxcbiAgICAgIGV2ZW50X3R5cGU6ICdDUkVBVEUnLFxuICAgICAgZXZlbnRfY2F0ZWdvcnk6ICdFRFVDQVRJT04nLFxuICAgICAgcmVzb3VyY2VfdHlwZTogJ2NvdXJzZXMnLFxuICAgICAgcmVzb3VyY2VfaWQ6IHJlc3VsdC5kYXRhIS5pZCxcbiAgICAgIGFjdGlvbjogJ0NyZWF0ZWQgbmV3IGNvdXJzZScsXG4gICAgICBkZXNjcmlwdGlvbjogYENvdXJzZTogJHtib2R5LnRpdGxlfWAsXG4gICAgICBuZXdfdmFsdWVzOiByZXN1bHQuZGF0YSxcbiAgICAgIHJpc2tfbGV2ZWw6ICdsb3cnLFxuICAgIH0pO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBkYXRhOiByZXN1bHQuZGF0YSxcbiAgICAgIG1lc3NhZ2U6IHJlc3VsdC5tZXNzYWdlLFxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNyZWF0aW5nIGNvdXJzZTonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnRlcm5hbCBzZXJ2ZXIgZXJyb3InIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY3JlYXRlQ2xpZW50IiwiY291cnNlU2VydmljZSIsIkdFVCIsInJlcXVlc3QiLCJzdXBhYmFzZSIsImRhdGEiLCJ1c2VyIiwiYXV0aCIsImdldFVzZXIiLCJqc29uIiwic3VjY2VzcyIsImVycm9yIiwic3RhdHVzIiwic2VhcmNoUGFyYW1zIiwibmV4dFVybCIsInByb2dyYW1faWQiLCJnZXQiLCJpbnN0cnVjdG9yX2lkIiwiaXNfYWN0aXZlIiwic2VhcmNoIiwiZmlsdGVyIiwicmVzdWx0IiwibGlzdENvdXJzZXMiLCJjb25zb2xlIiwiUE9TVCIsImJvZHkiLCJ0aXRsZSIsInN0YXJ0X2RhdGUiLCJjcmVhdGVDb3Vyc2UiLCJpZCIsImRlc2NyaXB0aW9uIiwiYWNjZXNzX3RhZyIsImVuZF9kYXRlIiwiZnJvbSIsImluc2VydCIsInVzZXJfaWQiLCJldmVudF90eXBlIiwiZXZlbnRfY2F0ZWdvcnkiLCJyZXNvdXJjZV90eXBlIiwicmVzb3VyY2VfaWQiLCJhY3Rpb24iLCJuZXdfdmFsdWVzIiwicmlza19sZXZlbCIsIm1lc3NhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/lms/courses/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/lms/courseService.ts":
/*!**************************************!*\
  !*** ./src/lib/lms/courseService.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   courseService: () => (/* binding */ courseService),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @/lib/supabase/client */ \"(rsc)/./src/lib/supabase/client.ts\");\n\n// ============================================================================\n// COURSE SERVICE\n// ============================================================================\nconst courseService = {\n    /**\n   * Get all courses with optional filtering\n   */ async listCourses (filter) {\n        try {\n            let query = _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").select(\"*, program:programs(*), instructor:users(*)\").order(\"created_at\", {\n                ascending: false\n            });\n            // Apply filters\n            if (filter?.program_id) {\n                query = query.eq(\"program_id\", filter.program_id);\n            }\n            if (filter?.instructor_id) {\n                query = query.eq(\"instructor_id\", filter.instructor_id);\n            }\n            if (filter?.is_active !== undefined) {\n                query = query.eq(\"is_active\", filter.is_active);\n            }\n            if (filter?.search) {\n                query = query.or(`title.ilike.%${filter.search}%,description.ilike.%${filter.search}%`);\n            }\n            if (filter?.start_date_from) {\n                query = query.gte(\"start_date\", filter.start_date_from);\n            }\n            if (filter?.start_date_to) {\n                query = query.lte(\"start_date\", filter.start_date_to);\n            }\n            const { data, error } = await query;\n            if (error) {\n                return {\n                    success: false,\n                    error: error.message\n                };\n            }\n            return {\n                success: true,\n                data: data\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Get a single course by ID with full hierarchy\n   */ async getCourseById (id, includeModules = false) {\n        try {\n            let query = _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").select(includeModules ? \"*, program:programs(*), instructor:users(*), modules(*, lessons(*, lesson_topics(*)))\" : \"*, program:programs(*), instructor:users(*)\").eq(\"id\", id).single();\n            const { data, error } = await query;\n            if (error) {\n                return {\n                    success: false,\n                    error: error.message\n                };\n            }\n            return {\n                success: true,\n                data: data\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Create a new course\n   */ async createCourse (courseData) {\n        try {\n            const { data, error } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").insert(courseData).select(\"*, program:programs(*), instructor:users(*)\").single();\n            if (error) {\n                return {\n                    success: false,\n                    error: error.message\n                };\n            }\n            return {\n                success: true,\n                data: data,\n                message: \"Course created successfully\"\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Update a course\n   */ async updateCourse (id, updates) {\n        try {\n            const { data, error } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").update(updates).eq(\"id\", id).select(\"*, program:programs(*), instructor:users(*)\").single();\n            if (error) {\n                return {\n                    success: false,\n                    error: error.message\n                };\n            }\n            return {\n                success: true,\n                data: data,\n                message: \"Course updated successfully\"\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Delete a course\n   */ async deleteCourse (id) {\n        try {\n            const { error } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").delete().eq(\"id\", id);\n            if (error) {\n                return {\n                    success: false,\n                    error: error.message\n                };\n            }\n            return {\n                success: true,\n                message: \"Course deleted successfully\"\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Duplicate a course with all its modules and lessons\n   */ async duplicateCourse (id, newTitle) {\n        try {\n            // Get original course with all hierarchy\n            const { data: originalCourse, error: fetchError } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").select(\"*, modules(*, lessons(*, lesson_topics(*)))\").eq(\"id\", id).single();\n            if (fetchError || !originalCourse) {\n                return {\n                    success: false,\n                    error: fetchError?.message || \"Course not found\"\n                };\n            }\n            // Create new course\n            const { data: newCourse, error: courseError } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"courses\").insert({\n                program_id: originalCourse.program_id,\n                instructor_id: originalCourse.instructor_id,\n                title: newTitle || `${originalCourse.title} (Copy)`,\n                description: originalCourse.description,\n                access_tag: originalCourse.access_tag,\n                start_date: originalCourse.start_date,\n                end_date: originalCourse.end_date,\n                is_active: false\n            }).select().single();\n            if (courseError || !newCourse) {\n                return {\n                    success: false,\n                    error: courseError?.message || \"Failed to create course copy\"\n                };\n            }\n            // Duplicate modules and lessons (if any)\n            if (originalCourse.modules && originalCourse.modules.length > 0) {\n                for (const module of originalCourse.modules){\n                    const { data: newModule } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"modules\").insert({\n                        course_id: newCourse.id,\n                        title: module.title,\n                        description: module.description,\n                        order: module.order,\n                        is_published: false,\n                        is_optional: module.is_optional,\n                        duration_minutes: module.duration_minutes\n                    }).select().single();\n                    // Duplicate lessons\n                    if (newModule && module.lessons && module.lessons.length > 0) {\n                        for (const lesson of module.lessons){\n                            const { data: newLesson } = await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"lessons\").insert({\n                                course_id: newCourse.id,\n                                module_id: newModule.id,\n                                title: lesson.title,\n                                description: lesson.description,\n                                content: lesson.content,\n                                order: lesson.order,\n                                start_time: lesson.start_time,\n                                duration: lesson.duration,\n                                materials: lesson.materials,\n                                is_published: false,\n                                status: \"scheduled\"\n                            }).select().single();\n                            // Duplicate topics\n                            if (newLesson && lesson.topics && lesson.topics.length > 0) {\n                                const topicsToInsert = lesson.topics.map((topic)=>({\n                                        lesson_id: newLesson.id,\n                                        title: topic.title,\n                                        content_type: topic.content_type,\n                                        content: topic.content,\n                                        order: topic.order,\n                                        duration_minutes: topic.duration_minutes,\n                                        is_required: topic.is_required\n                                    }));\n                                await _lib_supabase_client__WEBPACK_IMPORTED_MODULE_0__.supabase.from(\"lesson_topics\").insert(topicsToInsert);\n                            }\n                        }\n                    }\n                }\n            }\n            return {\n                success: true,\n                data: newCourse,\n                message: \"Course duplicated successfully\"\n            };\n        } catch (error) {\n            return {\n                success: false,\n                error: error instanceof Error ? error.message : \"Unknown error\"\n            };\n        }\n    },\n    /**\n   * Publish a course (make it visible to students)\n   */ async publishCourse (id) {\n        return this.updateCourse(id, {\n            is_active: true\n        });\n    },\n    /**\n   * Unpublish a course\n   */ async unpublishCourse (id) {\n        return this.updateCourse(id, {\n            is_active: false\n        });\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (courseService);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDQyxRQUFnQjt3Q0FDeERDLFdBQVdYLFVBQVVoQyxFQUFFO3dDQUN2QmlCLE9BQU95QixNQUFNekIsS0FBSzt3Q0FDbEIyQixjQUFjRixNQUFNRSxZQUFZO3dDQUNoQ1YsU0FBU1EsTUFBTVIsT0FBTzt3Q0FDdEJyRCxPQUFPNkQsTUFBTTdELEtBQUs7d0NBQ2xCZ0Qsa0JBQWtCYSxNQUFNYixnQkFBZ0I7d0NBQ3hDZ0IsYUFBYUgsTUFBTUcsV0FBVztvQ0FDaEM7Z0NBRUEsTUFBTXZFLDBEQUFRQSxDQUFDSyxJQUFJLENBQUMsaUJBQWlCMEIsTUFBTSxDQUFDbUM7NEJBQzlDO3dCQUNGO29CQUNGO2dCQUNGO1lBQ0Y7WUFFQSxPQUFPO2dCQUNMNUMsU0FBUztnQkFDVEYsTUFBTXFCO2dCQUNObEIsU0FBUztZQUNYO1FBQ0YsRUFBRSxPQUFPRixPQUFPO1lBQ2QsT0FBTztnQkFDTEMsU0FBUztnQkFDVEQsT0FBT0EsaUJBQWlCRyxRQUFRSCxNQUFNRSxPQUFPLEdBQUc7WUFDbEQ7UUFDRjtJQUNGO0lBRUE7O0dBRUMsR0FDRCxNQUFNaUQsZUFBYzlDLEVBQVU7UUFDNUIsT0FBTyxJQUFJLENBQUNNLFlBQVksQ0FBQ04sSUFBSTtZQUFFZCxXQUFXO1FBQUs7SUFDakQ7SUFFQTs7R0FFQyxHQUNELE1BQU02RCxpQkFBZ0IvQyxFQUFVO1FBQzlCLE9BQU8sSUFBSSxDQUFDTSxZQUFZLENBQUNOLElBQUk7WUFBRWQsV0FBVztRQUFNO0lBQ2xEO0FBQ0YsRUFBRTtBQUVGLGlFQUFlWCxhQUFhQSxFQUFDIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcGFyZW50aW5nLXNjaG9vbC1wbGF0Zm9ybS8uL3NyYy9saWIvbG1zL2NvdXJzZVNlcnZpY2UudHM/ZWY4NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBzdXBhYmFzZSB9IGZyb20gJ0AvbGliL3N1cGFiYXNlL2NsaWVudCc7XG5pbXBvcnQgdHlwZSB7XG4gIENvdXJzZSxcbiAgQ291cnNlRmlsdGVyLFxuICBDb3Vyc2VXaXRoTW9kdWxlcyxcbiAgQXBpUmVzcG9uc2UsXG4gIFBhZ2luYXRlZFJlc3BvbnNlLFxufSBmcm9tICdAL3R5cGVzL2xtcyc7XG5cbi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbi8vIENPVVJTRSBTRVJWSUNFXG4vLyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG5cbmV4cG9ydCBjb25zdCBjb3Vyc2VTZXJ2aWNlID0ge1xuICAvKipcbiAgICogR2V0IGFsbCBjb3Vyc2VzIHdpdGggb3B0aW9uYWwgZmlsdGVyaW5nXG4gICAqL1xuICBhc3luYyBsaXN0Q291cnNlcyhmaWx0ZXI/OiBDb3Vyc2VGaWx0ZXIpOiBQcm9taXNlPEFwaVJlc3BvbnNlPENvdXJzZVtdPj4ge1xuICAgIHRyeSB7XG4gICAgICBcblxuICAgICAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAgICAgLmZyb20oJ2NvdXJzZXMnKVxuICAgICAgICAuc2VsZWN0KCcqLCBwcm9ncmFtOnByb2dyYW1zKCopLCBpbnN0cnVjdG9yOnVzZXJzKCopJylcbiAgICAgICAgLm9yZGVyKCdjcmVhdGVkX2F0JywgeyBhc2NlbmRpbmc6IGZhbHNlIH0pO1xuXG4gICAgICAvLyBBcHBseSBmaWx0ZXJzXG4gICAgICBpZiAoZmlsdGVyPy5wcm9ncmFtX2lkKSB7XG4gICAgICAgIHF1ZXJ5ID0gcXVlcnkuZXEoJ3Byb2dyYW1faWQnLCBmaWx0ZXIucHJvZ3JhbV9pZCk7XG4gICAgICB9XG5cbiAgICAgIGlmIChmaWx0ZXI/Lmluc3RydWN0b3JfaWQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnaW5zdHJ1Y3Rvcl9pZCcsIGZpbHRlci5pbnN0cnVjdG9yX2lkKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZpbHRlcj8uaXNfYWN0aXZlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5lcSgnaXNfYWN0aXZlJywgZmlsdGVyLmlzX2FjdGl2ZSk7XG4gICAgICB9XG5cbiAgICAgIGlmIChmaWx0ZXI/LnNlYXJjaCkge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yKFxuICAgICAgICAgIGB0aXRsZS5pbGlrZS4lJHtmaWx0ZXIuc2VhcmNofSUsZGVzY3JpcHRpb24uaWxpa2UuJSR7ZmlsdGVyLnNlYXJjaH0lYFxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAoZmlsdGVyPy5zdGFydF9kYXRlX2Zyb20pIHtcbiAgICAgICAgcXVlcnkgPSBxdWVyeS5ndGUoJ3N0YXJ0X2RhdGUnLCBmaWx0ZXIuc3RhcnRfZGF0ZV9mcm9tKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGZpbHRlcj8uc3RhcnRfZGF0ZV90bykge1xuICAgICAgICBxdWVyeSA9IHF1ZXJ5Lmx0ZSgnc3RhcnRfZGF0ZScsIGZpbHRlci5zdGFydF9kYXRlX3RvKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnk7XG5cbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBkYXRhIGFzIENvdXJzZVtdLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBHZXQgYSBzaW5nbGUgY291cnNlIGJ5IElEIHdpdGggZnVsbCBoaWVyYXJjaHlcbiAgICovXG4gIGFzeW5jIGdldENvdXJzZUJ5SWQoaWQ6IHN0cmluZywgaW5jbHVkZU1vZHVsZXMgPSBmYWxzZSk6IFByb21pc2U8QXBpUmVzcG9uc2U8Q291cnNlIHwgQ291cnNlV2l0aE1vZHVsZXM+PiB7XG4gICAgdHJ5IHtcbiAgICAgIFxuXG4gICAgICBsZXQgcXVlcnkgPSBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY291cnNlcycpXG4gICAgICAgIC5zZWxlY3QoXG4gICAgICAgICAgaW5jbHVkZU1vZHVsZXNcbiAgICAgICAgICAgID8gJyosIHByb2dyYW06cHJvZ3JhbXMoKiksIGluc3RydWN0b3I6dXNlcnMoKiksIG1vZHVsZXMoKiwgbGVzc29ucygqLCBsZXNzb25fdG9waWNzKCopKSknXG4gICAgICAgICAgICA6ICcqLCBwcm9ncmFtOnByb2dyYW1zKCopLCBpbnN0cnVjdG9yOnVzZXJzKCopJ1xuICAgICAgICApXG4gICAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBxdWVyeTtcblxuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IGRhdGEgYXMgdW5rbm93biBhcyBDb3Vyc2UgfCBDb3Vyc2VXaXRoTW9kdWxlcyxcbiAgICAgIH07XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiAnVW5rbm93biBlcnJvcicsXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQ3JlYXRlIGEgbmV3IGNvdXJzZVxuICAgKi9cbiAgYXN5bmMgY3JlYXRlQ291cnNlKGNvdXJzZURhdGE6IHtcbiAgICBwcm9ncmFtX2lkOiBzdHJpbmc7XG4gICAgaW5zdHJ1Y3Rvcl9pZD86IHN0cmluZztcbiAgICB0aXRsZTogc3RyaW5nO1xuICAgIGRlc2NyaXB0aW9uPzogc3RyaW5nO1xuICAgIGFjY2Vzc190YWc/OiBzdHJpbmc7XG4gICAgc3RhcnRfZGF0ZTogc3RyaW5nO1xuICAgIGVuZF9kYXRlPzogc3RyaW5nO1xuICAgIGlzX2FjdGl2ZT86IGJvb2xlYW47XG4gIH0pOiBQcm9taXNlPEFwaVJlc3BvbnNlPENvdXJzZT4+IHtcbiAgICB0cnkge1xuICAgICAgXG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb3Vyc2VzJylcbiAgICAgICAgLmluc2VydChjb3Vyc2VEYXRhKVxuICAgICAgICAuc2VsZWN0KCcqLCBwcm9ncmFtOnByb2dyYW1zKCopLCBpbnN0cnVjdG9yOnVzZXJzKCopJylcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgZGF0YTogZGF0YSBhcyBDb3Vyc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdDb3Vyc2UgY3JlYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBVcGRhdGUgYSBjb3Vyc2VcbiAgICovXG4gIGFzeW5jIHVwZGF0ZUNvdXJzZShcbiAgICBpZDogc3RyaW5nLFxuICAgIHVwZGF0ZXM6IFBhcnRpYWw8Q291cnNlPlxuICApOiBQcm9taXNlPEFwaVJlc3BvbnNlPENvdXJzZT4+IHtcbiAgICB0cnkge1xuICAgICAgXG5cbiAgICAgIGNvbnN0IHsgZGF0YSwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb3Vyc2VzJylcbiAgICAgICAgLnVwZGF0ZSh1cGRhdGVzKVxuICAgICAgICAuZXEoJ2lkJywgaWQpXG4gICAgICAgIC5zZWxlY3QoJyosIHByb2dyYW06cHJvZ3JhbXMoKiksIGluc3RydWN0b3I6dXNlcnMoKiknKVxuICAgICAgICAuc2luZ2xlKCk7XG5cbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICB9O1xuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICBkYXRhOiBkYXRhIGFzIENvdXJzZSxcbiAgICAgICAgbWVzc2FnZTogJ0NvdXJzZSB1cGRhdGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIERlbGV0ZSBhIGNvdXJzZVxuICAgKi9cbiAgYXN5bmMgZGVsZXRlQ291cnNlKGlkOiBzdHJpbmcpOiBQcm9taXNlPEFwaVJlc3BvbnNlPHZvaWQ+PiB7XG4gICAgdHJ5IHtcbiAgICAgIFxuXG4gICAgICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5mcm9tKCdjb3Vyc2VzJykuZGVsZXRlKCkuZXEoJ2lkJywgaWQpO1xuXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgfTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogJ0NvdXJzZSBkZWxldGVkIHN1Y2Nlc3NmdWxseScsXG4gICAgICB9O1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgZXJyb3I6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InLFxuICAgICAgfTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIER1cGxpY2F0ZSBhIGNvdXJzZSB3aXRoIGFsbCBpdHMgbW9kdWxlcyBhbmQgbGVzc29uc1xuICAgKi9cbiAgYXN5bmMgZHVwbGljYXRlQ291cnNlKFxuICAgIGlkOiBzdHJpbmcsXG4gICAgbmV3VGl0bGU/OiBzdHJpbmdcbiAgKTogUHJvbWlzZTxBcGlSZXNwb25zZTxDb3Vyc2U+PiB7XG4gICAgdHJ5IHtcbiAgICAgIFxuXG4gICAgICAvLyBHZXQgb3JpZ2luYWwgY291cnNlIHdpdGggYWxsIGhpZXJhcmNoeVxuICAgICAgY29uc3QgeyBkYXRhOiBvcmlnaW5hbENvdXJzZSwgZXJyb3I6IGZldGNoRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgICAgIC5mcm9tKCdjb3Vyc2VzJylcbiAgICAgICAgLnNlbGVjdCgnKiwgbW9kdWxlcygqLCBsZXNzb25zKCosIGxlc3Nvbl90b3BpY3MoKikpKScpXG4gICAgICAgIC5lcSgnaWQnLCBpZClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoZmV0Y2hFcnJvciB8fCAhb3JpZ2luYWxDb3Vyc2UpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgICAgICBlcnJvcjogZmV0Y2hFcnJvcj8ubWVzc2FnZSB8fCAnQ291cnNlIG5vdCBmb3VuZCcsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBuZXcgY291cnNlXG4gICAgICBjb25zdCB7IGRhdGE6IG5ld0NvdXJzZSwgZXJyb3I6IGNvdXJzZUVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAuZnJvbSgnY291cnNlcycpXG4gICAgICAgIC5pbnNlcnQoe1xuICAgICAgICAgIHByb2dyYW1faWQ6IG9yaWdpbmFsQ291cnNlLnByb2dyYW1faWQsXG4gICAgICAgICAgaW5zdHJ1Y3Rvcl9pZDogb3JpZ2luYWxDb3Vyc2UuaW5zdHJ1Y3Rvcl9pZCxcbiAgICAgICAgICB0aXRsZTogbmV3VGl0bGUgfHwgYCR7b3JpZ2luYWxDb3Vyc2UudGl0bGV9IChDb3B5KWAsXG4gICAgICAgICAgZGVzY3JpcHRpb246IG9yaWdpbmFsQ291cnNlLmRlc2NyaXB0aW9uLFxuICAgICAgICAgIGFjY2Vzc190YWc6IG9yaWdpbmFsQ291cnNlLmFjY2Vzc190YWcsXG4gICAgICAgICAgc3RhcnRfZGF0ZTogb3JpZ2luYWxDb3Vyc2Uuc3RhcnRfZGF0ZSxcbiAgICAgICAgICBlbmRfZGF0ZTogb3JpZ2luYWxDb3Vyc2UuZW5kX2RhdGUsXG4gICAgICAgICAgaXNfYWN0aXZlOiBmYWxzZSwgLy8gRHVwbGljYXRlcyBzdGFydCBhcyBpbmFjdGl2ZVxuICAgICAgICB9KVxuICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgLnNpbmdsZSgpO1xuXG4gICAgICBpZiAoY291cnNlRXJyb3IgfHwgIW5ld0NvdXJzZSkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBjb3Vyc2VFcnJvcj8ubWVzc2FnZSB8fCAnRmFpbGVkIHRvIGNyZWF0ZSBjb3Vyc2UgY29weScsXG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIC8vIER1cGxpY2F0ZSBtb2R1bGVzIGFuZCBsZXNzb25zIChpZiBhbnkpXG4gICAgICBpZiAob3JpZ2luYWxDb3Vyc2UubW9kdWxlcyAmJiBvcmlnaW5hbENvdXJzZS5tb2R1bGVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZm9yIChjb25zdCBtb2R1bGUgb2Ygb3JpZ2luYWxDb3Vyc2UubW9kdWxlcykge1xuICAgICAgICAgIGNvbnN0IHsgZGF0YTogbmV3TW9kdWxlIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgICAgICAgICAgLmZyb20oJ21vZHVsZXMnKVxuICAgICAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgICAgIGNvdXJzZV9pZDogbmV3Q291cnNlLmlkLFxuICAgICAgICAgICAgICB0aXRsZTogbW9kdWxlLnRpdGxlLFxuICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogbW9kdWxlLmRlc2NyaXB0aW9uLFxuICAgICAgICAgICAgICBvcmRlcjogbW9kdWxlLm9yZGVyLFxuICAgICAgICAgICAgICBpc19wdWJsaXNoZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICBpc19vcHRpb25hbDogbW9kdWxlLmlzX29wdGlvbmFsLFxuICAgICAgICAgICAgICBkdXJhdGlvbl9taW51dGVzOiBtb2R1bGUuZHVyYXRpb25fbWludXRlcyxcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuc2VsZWN0KClcbiAgICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICAgIC8vIER1cGxpY2F0ZSBsZXNzb25zXG4gICAgICAgICAgaWYgKG5ld01vZHVsZSAmJiBtb2R1bGUubGVzc29ucyAmJiBtb2R1bGUubGVzc29ucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxlc3NvbiBvZiBtb2R1bGUubGVzc29ucykge1xuICAgICAgICAgICAgICBjb25zdCB7IGRhdGE6IG5ld0xlc3NvbiB9ID0gYXdhaXQgc3VwYWJhc2VcbiAgICAgICAgICAgICAgICAuZnJvbSgnbGVzc29ucycpXG4gICAgICAgICAgICAgICAgLmluc2VydCh7XG4gICAgICAgICAgICAgICAgICBjb3Vyc2VfaWQ6IG5ld0NvdXJzZS5pZCxcbiAgICAgICAgICAgICAgICAgIG1vZHVsZV9pZDogbmV3TW9kdWxlLmlkLFxuICAgICAgICAgICAgICAgICAgdGl0bGU6IGxlc3Nvbi50aXRsZSxcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBsZXNzb24uZGVzY3JpcHRpb24sXG4gICAgICAgICAgICAgICAgICBjb250ZW50OiBsZXNzb24uY29udGVudCxcbiAgICAgICAgICAgICAgICAgIG9yZGVyOiBsZXNzb24ub3JkZXIsXG4gICAgICAgICAgICAgICAgICBzdGFydF90aW1lOiBsZXNzb24uc3RhcnRfdGltZSxcbiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiBsZXNzb24uZHVyYXRpb24sXG4gICAgICAgICAgICAgICAgICBtYXRlcmlhbHM6IGxlc3Nvbi5tYXRlcmlhbHMsXG4gICAgICAgICAgICAgICAgICBpc19wdWJsaXNoZWQ6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgc3RhdHVzOiAnc2NoZWR1bGVkJyxcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5zZWxlY3QoKVxuICAgICAgICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICAgICAgICAvLyBEdXBsaWNhdGUgdG9waWNzXG4gICAgICAgICAgICAgIGlmIChuZXdMZXNzb24gJiYgbGVzc29uLnRvcGljcyAmJiBsZXNzb24udG9waWNzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCB0b3BpY3NUb0luc2VydCA9IGxlc3Nvbi50b3BpY3MubWFwKCh0b3BpYzogYW55KSA9PiAoe1xuICAgICAgICAgICAgICAgICAgbGVzc29uX2lkOiBuZXdMZXNzb24uaWQsXG4gICAgICAgICAgICAgICAgICB0aXRsZTogdG9waWMudGl0bGUsXG4gICAgICAgICAgICAgICAgICBjb250ZW50X3R5cGU6IHRvcGljLmNvbnRlbnRfdHlwZSxcbiAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRvcGljLmNvbnRlbnQsXG4gICAgICAgICAgICAgICAgICBvcmRlcjogdG9waWMub3JkZXIsXG4gICAgICAgICAgICAgICAgICBkdXJhdGlvbl9taW51dGVzOiB0b3BpYy5kdXJhdGlvbl9taW51dGVzLFxuICAgICAgICAgICAgICAgICAgaXNfcmVxdWlyZWQ6IHRvcGljLmlzX3JlcXVpcmVkLFxuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICAgICAgICAgIGF3YWl0IHN1cGFiYXNlLmZyb20oJ2xlc3Nvbl90b3BpY3MnKS5pbnNlcnQodG9waWNzVG9JbnNlcnQpO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIGRhdGE6IG5ld0NvdXJzZSBhcyBDb3Vyc2UsXG4gICAgICAgIG1lc3NhZ2U6ICdDb3Vyc2UgZHVwbGljYXRlZCBzdWNjZXNzZnVsbHknLFxuICAgICAgfTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdVbmtub3duIGVycm9yJyxcbiAgICAgIH07XG4gICAgfVxuICB9LFxuXG4gIC8qKlxuICAgKiBQdWJsaXNoIGEgY291cnNlIChtYWtlIGl0IHZpc2libGUgdG8gc3R1ZGVudHMpXG4gICAqL1xuICBhc3luYyBwdWJsaXNoQ291cnNlKGlkOiBzdHJpbmcpOiBQcm9taXNlPEFwaVJlc3BvbnNlPENvdXJzZT4+IHtcbiAgICByZXR1cm4gdGhpcy51cGRhdGVDb3Vyc2UoaWQsIHsgaXNfYWN0aXZlOiB0cnVlIH0pO1xuICB9LFxuXG4gIC8qKlxuICAgKiBVbnB1Ymxpc2ggYSBjb3Vyc2VcbiAgICovXG4gIGFzeW5jIHVucHVibGlzaENvdXJzZShpZDogc3RyaW5nKTogUHJvbWlzZTxBcGlSZXNwb25zZTxDb3Vyc2U+PiB7XG4gICAgcmV0dXJuIHRoaXMudXBkYXRlQ291cnNlKGlkLCB7IGlzX2FjdGl2ZTogZmFsc2UgfSk7XG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBjb3Vyc2VTZXJ2aWNlO1xuIl0sIm5hbWVzIjpbInN1cGFiYXNlIiwiY291cnNlU2VydmljZSIsImxpc3RDb3Vyc2VzIiwiZmlsdGVyIiwicXVlcnkiLCJmcm9tIiwic2VsZWN0Iiwib3JkZXIiLCJhc2NlbmRpbmciLCJwcm9ncmFtX2lkIiwiZXEiLCJpbnN0cnVjdG9yX2lkIiwiaXNfYWN0aXZlIiwidW5kZWZpbmVkIiwic2VhcmNoIiwib3IiLCJzdGFydF9kYXRlX2Zyb20iLCJndGUiLCJzdGFydF9kYXRlX3RvIiwibHRlIiwiZGF0YSIsImVycm9yIiwic3VjY2VzcyIsIm1lc3NhZ2UiLCJFcnJvciIsImdldENvdXJzZUJ5SWQiLCJpZCIsImluY2x1ZGVNb2R1bGVzIiwic2luZ2xlIiwiY3JlYXRlQ291cnNlIiwiY291cnNlRGF0YSIsImluc2VydCIsInVwZGF0ZUNvdXJzZSIsInVwZGF0ZXMiLCJ1cGRhdGUiLCJkZWxldGVDb3Vyc2UiLCJkZWxldGUiLCJkdXBsaWNhdGVDb3Vyc2UiLCJuZXdUaXRsZSIsIm9yaWdpbmFsQ291cnNlIiwiZmV0Y2hFcnJvciIsIm5ld0NvdXJzZSIsImNvdXJzZUVycm9yIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImFjY2Vzc190YWciLCJzdGFydF9kYXRlIiwiZW5kX2RhdGUiLCJtb2R1bGVzIiwibGVuZ3RoIiwibW9kdWxlIiwibmV3TW9kdWxlIiwiY291cnNlX2lkIiwiaXNfcHVibGlzaGVkIiwiaXNfb3B0aW9uYWwiLCJkdXJhdGlvbl9taW51dGVzIiwibGVzc29ucyIsImxlc3NvbiIsIm5ld0xlc3NvbiIsIm1vZHVsZV9pZCIsImNvbnRlbnQiLCJzdGFydF90aW1lIiwiZHVyYXRpb24iLCJtYXRlcmlhbHMiLCJzdGF0dXMiLCJ0b3BpY3MiLCJ0b3BpY3NUb0luc2VydCIsIm1hcCIsInRvcGljIiwibGVzc29uX2lkIiwiY29udGVudF90eXBlIiwiaXNfcmVxdWlyZWQiLCJwdWJsaXNoQ291cnNlIiwidW5wdWJsaXNoQ291cnNlIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/lms/courseService.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/client.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/client.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getTenantBySlug: () => (/* binding */ getTenantBySlug),\n/* harmony export */   initializeTenantContext: () => (/* binding */ initializeTenantContext),\n/* harmony export */   setTenantContext: () => (/* binding */ setTenantContext),\n/* harmony export */   supabase: () => (/* binding */ supabase)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\nconst supabaseUrl = \"https://dgdondsvtqbqnsecbayx.supabase.co\";\nconst supabaseAnonKey = \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRnZG9uZHN2dHFicW5zZWNiYXl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNjQ3ODIsImV4cCI6MjA3Nzg0MDc4Mn0.vJCiJGwPGhy_q7avgMnsjihi4i1a7GFUwoGv3Go-9c0\";\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseAnonKey, {\n    auth: {\n        autoRefreshToken: true,\n        persistSession: true,\n        detectSessionInUrl: true\n    }\n});\n/**\n * Set tenant context for the browser client\n * Call this after user authentication or when switching tenants\n */ async function setTenantContext(tenantId) {\n    try {\n        await supabase.rpc(\"set_current_tenant\", {\n            p_tenant_id: tenantId\n        });\n    } catch (error) {\n        console.error(\"Error setting tenant context:\", error);\n        throw error;\n    }\n}\n/**\n * Get tenant by slug (for initialization)\n */ async function getTenantBySlug(slug) {\n    const { data, error } = await supabase.rpc(\"get_tenant_by_slug\", {\n        p_slug: slug\n    }).single();\n    if (error) {\n        console.error(\"Error fetching tenant:\", error);\n        return null;\n    }\n    return data;\n}\n/**\n * Initialize tenant context from subdomain or localStorage\n * Call this in your app initialization (e.g., in a useEffect or context provider)\n */ async function initializeTenantContext() {\n    // Skip if multitenancy is disabled\n    if (false) {}\n    try {\n        // Try to get tenant from subdomain\n        const hostname = window.location.hostname;\n        const mainDomain = \"ipsplatform.com\" || 0;\n        // For localhost, use default tenant\n        if (hostname.includes(\"localhost\") || hostname.includes(\"127.0.0.1\")) {\n            const defaultSlug = \"default\" || 0;\n            const tenant = await getTenantBySlug(defaultSlug);\n            if (tenant?.id) {\n                await setTenantContext(tenant.id);\n                localStorage.setItem(\"tenant_id\", tenant.id);\n                localStorage.setItem(\"tenant_slug\", tenant.slug);\n            }\n            return;\n        }\n        // Extract subdomain\n        const parts = hostname.split(\".\");\n        if (parts.length >= 2) {\n            const subdomain = parts[0];\n            // Get tenant by slug\n            const tenant = await getTenantBySlug(subdomain);\n            if (tenant?.id) {\n                await setTenantContext(tenant.id);\n                localStorage.setItem(\"tenant_id\", tenant.id);\n                localStorage.setItem(\"tenant_slug\", tenant.slug);\n                return;\n            }\n        }\n        // Fallback: try to get from localStorage\n        const storedTenantId = localStorage.getItem(\"tenant_id\");\n        if (storedTenantId) {\n            await setTenantContext(storedTenantId);\n        }\n    } catch (error) {\n        console.error(\"Error initializing tenant context:\", error);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL2NsaWVudC50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFxRDtBQUVyRCxNQUFNQyxjQUFjQywwQ0FBb0M7QUFDeEQsTUFBTUcsa0JBQWtCSCxrTkFBeUM7QUFFMUQsTUFBTUssV0FBV1AsbUVBQVlBLENBQUNDLGFBQWFJLGlCQUFpQjtJQUNqRUcsTUFBTTtRQUNKQyxrQkFBa0I7UUFDbEJDLGdCQUFnQjtRQUNoQkMsb0JBQW9CO0lBQ3RCO0FBQ0YsR0FBRztBQUVIOzs7Q0FHQyxHQUNNLGVBQWVDLGlCQUFpQkMsUUFBZ0I7SUFDckQsSUFBSTtRQUNGLE1BQU1OLFNBQVNPLEdBQUcsQ0FBQyxzQkFBc0I7WUFBRUMsYUFBYUY7UUFBUztJQUNuRSxFQUFFLE9BQU9HLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0MsTUFBTUE7SUFDUjtBQUNGO0FBRUE7O0NBRUMsR0FDTSxlQUFlRSxnQkFBZ0JDLElBQVk7SUFDaEQsTUFBTSxFQUFFQyxJQUFJLEVBQUVKLEtBQUssRUFBRSxHQUFHLE1BQU1ULFNBQzNCTyxHQUFHLENBQUMsc0JBQXNCO1FBQUVPLFFBQVFGO0lBQUssR0FDekNHLE1BQU07SUFFVCxJQUFJTixPQUFPO1FBQ1RDLFFBQVFELEtBQUssQ0FBQywwQkFBMEJBO1FBQ3hDLE9BQU87SUFDVDtJQUVBLE9BQU9JO0FBQ1Q7QUFFQTs7O0NBR0MsR0FDTSxlQUFlRztJQUNwQixtQ0FBbUM7SUFDbkMsSUFBSXJCLEtBQWlELEVBQVEsRUFPNUQ7SUFFRCxJQUFJO1FBQ0YsbUNBQW1DO1FBQ25DLE1BQU0yQixXQUFXQyxPQUFPQyxRQUFRLENBQUNGLFFBQVE7UUFDekMsTUFBTUcsYUFBYTlCLGlCQUFtQyxJQUFJO1FBRTFELG9DQUFvQztRQUNwQyxJQUFJMkIsU0FBU0ssUUFBUSxDQUFDLGdCQUFnQkwsU0FBU0ssUUFBUSxDQUFDLGNBQWM7WUFDcEUsTUFBTVQsY0FBY3ZCLFNBQTJDLElBQUk7WUFDbkUsTUFBTXlCLFNBQVMsTUFBTVQsZ0JBQWdCTztZQUNyQyxJQUFJRSxRQUFRQyxJQUFJO2dCQUNkLE1BQU1oQixpQkFBaUJlLE9BQU9DLEVBQUU7Z0JBQ2hDTyxhQUFhQyxPQUFPLENBQUMsYUFBYVQsT0FBT0MsRUFBRTtnQkFDM0NPLGFBQWFDLE9BQU8sQ0FBQyxlQUFlVCxPQUFPUixJQUFJO1lBQ2pEO1lBQ0E7UUFDRjtRQUVBLG9CQUFvQjtRQUNwQixNQUFNa0IsUUFBUVIsU0FBU1MsS0FBSyxDQUFDO1FBQzdCLElBQUlELE1BQU1FLE1BQU0sSUFBSSxHQUFHO1lBQ3JCLE1BQU1DLFlBQVlILEtBQUssQ0FBQyxFQUFFO1lBRTFCLHFCQUFxQjtZQUNyQixNQUFNVixTQUFTLE1BQU1ULGdCQUFnQnNCO1lBQ3JDLElBQUliLFFBQVFDLElBQUk7Z0JBQ2QsTUFBTWhCLGlCQUFpQmUsT0FBT0MsRUFBRTtnQkFDaENPLGFBQWFDLE9BQU8sQ0FBQyxhQUFhVCxPQUFPQyxFQUFFO2dCQUMzQ08sYUFBYUMsT0FBTyxDQUFDLGVBQWVULE9BQU9SLElBQUk7Z0JBQy9DO1lBQ0Y7UUFDRjtRQUVBLHlDQUF5QztRQUN6QyxNQUFNc0IsaUJBQWlCTixhQUFhTyxPQUFPLENBQUM7UUFDNUMsSUFBSUQsZ0JBQWdCO1lBQ2xCLE1BQU03QixpQkFBaUI2QjtRQUN6QjtJQUNGLEVBQUUsT0FBT3pCLE9BQU87UUFDZEMsUUFBUUQsS0FBSyxDQUFDLHNDQUFzQ0E7SUFDdEQ7QUFDRiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhcmVudGluZy1zY2hvb2wtcGxhdGZvcm0vLi9zcmMvbGliL3N1cGFiYXNlL2NsaWVudC50cz8wZjk3Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMITtcbmNvbnN0IHN1cGFiYXNlQW5vbktleSA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZITtcblxuZXhwb3J0IGNvbnN0IHN1cGFiYXNlID0gY3JlYXRlQ2xpZW50KHN1cGFiYXNlVXJsLCBzdXBhYmFzZUFub25LZXksIHtcbiAgYXV0aDoge1xuICAgIGF1dG9SZWZyZXNoVG9rZW46IHRydWUsXG4gICAgcGVyc2lzdFNlc3Npb246IHRydWUsXG4gICAgZGV0ZWN0U2Vzc2lvbkluVXJsOiB0cnVlLCAvLyBJbXBvcnRhbnQgZm9yIGhhbmRsaW5nIGVtYWlsIGxpbmtzXG4gIH0sXG59KTtcblxuLyoqXG4gKiBTZXQgdGVuYW50IGNvbnRleHQgZm9yIHRoZSBicm93c2VyIGNsaWVudFxuICogQ2FsbCB0aGlzIGFmdGVyIHVzZXIgYXV0aGVudGljYXRpb24gb3Igd2hlbiBzd2l0Y2hpbmcgdGVuYW50c1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gc2V0VGVuYW50Q29udGV4dCh0ZW5hbnRJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHRyeSB7XG4gICAgYXdhaXQgc3VwYWJhc2UucnBjKCdzZXRfY3VycmVudF90ZW5hbnQnLCB7IHBfdGVuYW50X2lkOiB0ZW5hbnRJZCB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHRlbmFudCBjb250ZXh0OicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIEdldCB0ZW5hbnQgYnkgc2x1ZyAoZm9yIGluaXRpYWxpemF0aW9uKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VGVuYW50QnlTbHVnKHNsdWc6IHN0cmluZyk6IFByb21pc2U8eyBpZDogc3RyaW5nOyBzbHVnOiBzdHJpbmc7IG5hbWU6IHN0cmluZyB9IHwgbnVsbD4ge1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5ycGMoJ2dldF90ZW5hbnRfYnlfc2x1ZycsIHsgcF9zbHVnOiBzbHVnIH0pXG4gICAgLnNpbmdsZSgpO1xuXG4gIGlmIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIHRlbmFudDonLCBlcnJvcik7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZGF0YSBhcyB7IGlkOiBzdHJpbmc7IHNsdWc6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0gfCBudWxsO1xufVxuXG4vKipcbiAqIEluaXRpYWxpemUgdGVuYW50IGNvbnRleHQgZnJvbSBzdWJkb21haW4gb3IgbG9jYWxTdG9yYWdlXG4gKiBDYWxsIHRoaXMgaW4geW91ciBhcHAgaW5pdGlhbGl6YXRpb24gKGUuZy4sIGluIGEgdXNlRWZmZWN0IG9yIGNvbnRleHQgcHJvdmlkZXIpXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0aWFsaXplVGVuYW50Q29udGV4dCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgLy8gU2tpcCBpZiBtdWx0aXRlbmFuY3kgaXMgZGlzYWJsZWRcbiAgaWYgKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01VTFRJVEVOQU5DWV9FTkFCTEVEICE9PSAndHJ1ZScpIHtcbiAgICBjb25zdCBkZWZhdWx0U2x1ZyA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0RFRkFVTFRfVEVOQU5UX1NMVUcgfHwgJ2RlZmF1bHQnO1xuICAgIGNvbnN0IHRlbmFudCA9IGF3YWl0IGdldFRlbmFudEJ5U2x1ZyhkZWZhdWx0U2x1Zyk7XG4gICAgaWYgKHRlbmFudD8uaWQpIHtcbiAgICAgIGF3YWl0IHNldFRlbmFudENvbnRleHQodGVuYW50LmlkKTtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdHJ5IHtcbiAgICAvLyBUcnkgdG8gZ2V0IHRlbmFudCBmcm9tIHN1YmRvbWFpblxuICAgIGNvbnN0IGhvc3RuYW1lID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xuICAgIGNvbnN0IG1haW5Eb21haW4gPSBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19NQUlOX0RPTUFJTiB8fCAnaXBzcGxhdGZvcm0uY29tJztcblxuICAgIC8vIEZvciBsb2NhbGhvc3QsIHVzZSBkZWZhdWx0IHRlbmFudFxuICAgIGlmIChob3N0bmFtZS5pbmNsdWRlcygnbG9jYWxob3N0JykgfHwgaG9zdG5hbWUuaW5jbHVkZXMoJzEyNy4wLjAuMScpKSB7XG4gICAgICBjb25zdCBkZWZhdWx0U2x1ZyA9IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX0RFRkFVTFRfVEVOQU5UX1NMVUcgfHwgJ2RlZmF1bHQnO1xuICAgICAgY29uc3QgdGVuYW50ID0gYXdhaXQgZ2V0VGVuYW50QnlTbHVnKGRlZmF1bHRTbHVnKTtcbiAgICAgIGlmICh0ZW5hbnQ/LmlkKSB7XG4gICAgICAgIGF3YWl0IHNldFRlbmFudENvbnRleHQodGVuYW50LmlkKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RlbmFudF9pZCcsIHRlbmFudC5pZCk7XG4gICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd0ZW5hbnRfc2x1ZycsIHRlbmFudC5zbHVnKTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IHN1YmRvbWFpblxuICAgIGNvbnN0IHBhcnRzID0gaG9zdG5hbWUuc3BsaXQoJy4nKTtcbiAgICBpZiAocGFydHMubGVuZ3RoID49IDIpIHtcbiAgICAgIGNvbnN0IHN1YmRvbWFpbiA9IHBhcnRzWzBdO1xuXG4gICAgICAvLyBHZXQgdGVuYW50IGJ5IHNsdWdcbiAgICAgIGNvbnN0IHRlbmFudCA9IGF3YWl0IGdldFRlbmFudEJ5U2x1ZyhzdWJkb21haW4pO1xuICAgICAgaWYgKHRlbmFudD8uaWQpIHtcbiAgICAgICAgYXdhaXQgc2V0VGVuYW50Q29udGV4dCh0ZW5hbnQuaWQpO1xuICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndGVuYW50X2lkJywgdGVuYW50LmlkKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3RlbmFudF9zbHVnJywgdGVuYW50LnNsdWcpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gRmFsbGJhY2s6IHRyeSB0byBnZXQgZnJvbSBsb2NhbFN0b3JhZ2VcbiAgICBjb25zdCBzdG9yZWRUZW5hbnRJZCA9IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0ZW5hbnRfaWQnKTtcbiAgICBpZiAoc3RvcmVkVGVuYW50SWQpIHtcbiAgICAgIGF3YWl0IHNldFRlbmFudENvbnRleHQoc3RvcmVkVGVuYW50SWQpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbml0aWFsaXppbmcgdGVuYW50IGNvbnRleHQ6JywgZXJyb3IpO1xuICB9XG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlQW5vbktleSIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZIiwic3VwYWJhc2UiLCJhdXRoIiwiYXV0b1JlZnJlc2hUb2tlbiIsInBlcnNpc3RTZXNzaW9uIiwiZGV0ZWN0U2Vzc2lvbkluVXJsIiwic2V0VGVuYW50Q29udGV4dCIsInRlbmFudElkIiwicnBjIiwicF90ZW5hbnRfaWQiLCJlcnJvciIsImNvbnNvbGUiLCJnZXRUZW5hbnRCeVNsdWciLCJzbHVnIiwiZGF0YSIsInBfc2x1ZyIsInNpbmdsZSIsImluaXRpYWxpemVUZW5hbnRDb250ZXh0IiwiTkVYVF9QVUJMSUNfTVVMVElURU5BTkNZX0VOQUJMRUQiLCJkZWZhdWx0U2x1ZyIsIk5FWFRfUFVCTElDX0RFRkFVTFRfVEVOQU5UX1NMVUciLCJ0ZW5hbnQiLCJpZCIsImhvc3RuYW1lIiwid2luZG93IiwibG9jYXRpb24iLCJtYWluRG9tYWluIiwiTkVYVF9QVUJMSUNfTUFJTl9ET01BSU4iLCJpbmNsdWRlcyIsImxvY2FsU3RvcmFnZSIsInNldEl0ZW0iLCJwYXJ0cyIsInNwbGl0IiwibGVuZ3RoIiwic3ViZG9tYWluIiwic3RvcmVkVGVuYW50SWQiLCJnZXRJdGVtIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/client.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/supabase/server.ts":
/*!************************************!*\
  !*** ./src/lib/supabase/server.ts ***!
  \************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createAdminClient: () => (/* binding */ createAdminClient),\n/* harmony export */   createClient: () => (/* binding */ createClient)\n/* harmony export */ });\n/* harmony import */ var next_headers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/headers */ \"(rsc)/./node_modules/next/dist/api/headers.js\");\n/* harmony import */ var _supabase_ssr__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @supabase/ssr */ \"(rsc)/./node_modules/@supabase/ssr/dist/module/index.js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n\n\n\n// Regular authenticated client (subject to RLS)\nasync function createClient() {\n    const cookieStore = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.cookies)();\n    const client = (0,_supabase_ssr__WEBPACK_IMPORTED_MODULE_1__.createServerClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRnZG9uZHN2dHFicW5zZWNiYXl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyNjQ3ODIsImV4cCI6MjA3Nzg0MDc4Mn0.vJCiJGwPGhy_q7avgMnsjihi4i1a7GFUwoGv3Go-9c0\", {\n        cookies: {\n            get (name) {\n                return cookieStore.get(name)?.value;\n            },\n            set (name, value, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value,\n                        ...options\n                    });\n                } catch (error) {\n                // The `set` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            },\n            remove (name, options) {\n                try {\n                    cookieStore.set({\n                        name,\n                        value: \"\",\n                        ...options\n                    });\n                } catch (error) {\n                // The `delete` method was called from a Server Component.\n                // This can be ignored if you have middleware refreshing\n                // user sessions.\n                }\n            }\n        }\n    });\n    // Set tenant context if multitenancy is enabled\n    if (true) {\n        try {\n            const headersList = await (0,next_headers__WEBPACK_IMPORTED_MODULE_0__.headers)();\n            const tenantSlug = headersList.get(\"x-tenant-slug\");\n            if (tenantSlug) {\n                // Get tenant ID from slug\n                const { data: tenant } = await client.rpc(\"get_tenant_by_slug\", {\n                    p_slug: tenantSlug\n                }).single();\n                const typedTenant = tenant;\n                if (typedTenant?.id) {\n                    // Set current tenant in database session\n                    await client.rpc(\"set_current_tenant\", {\n                        p_tenant_id: typedTenant.id\n                    });\n                }\n            }\n        } catch (error) {\n            console.error(\"Error setting tenant context:\", error);\n        // Don't fail the request, just log the error\n        }\n    }\n    return client;\n}\n// Admin client with service role (bypasses RLS)\n// Use this for admin operations that need to bypass RLS policies\nfunction createAdminClient() {\n    return (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_2__.createClient)(\"https://dgdondsvtqbqnsecbayx.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY, {\n        auth: {\n            autoRefreshToken: false,\n            persistSession: false\n        }\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFnRDtBQUN1QjtBQUNNO0FBRTdFLGdEQUFnRDtBQUN6QyxlQUFlRztJQUNwQixNQUFNRSxjQUFjLE1BQU1MLHFEQUFPQTtJQUVqQyxNQUFNTSxTQUFTSixpRUFBa0JBLENBQy9CSywwQ0FBb0MsRUFDcENBLGtOQUF5QyxFQUN6QztRQUNFUCxTQUFTO1lBQ1BXLEtBQUlDLElBQVk7Z0JBQ2QsT0FBT1AsWUFBWU0sR0FBRyxDQUFDQyxPQUFPQztZQUNoQztZQUNBQyxLQUFJRixJQUFZLEVBQUVDLEtBQWEsRUFBRUUsT0FBc0I7Z0JBQ3JELElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DO3dCQUFPLEdBQUdFLE9BQU87b0JBQUM7Z0JBQzVDLEVBQUUsT0FBT0MsT0FBTztnQkFDZCx1REFBdUQ7Z0JBQ3ZELHdEQUF3RDtnQkFDeEQsaUJBQWlCO2dCQUNuQjtZQUNGO1lBQ0FDLFFBQU9MLElBQVksRUFBRUcsT0FBc0I7Z0JBQ3pDLElBQUk7b0JBQ0ZWLFlBQVlTLEdBQUcsQ0FBQzt3QkFBRUY7d0JBQU1DLE9BQU87d0JBQUksR0FBR0UsT0FBTztvQkFBQztnQkFDaEQsRUFBRSxPQUFPQyxPQUFPO2dCQUNkLDBEQUEwRDtnQkFDMUQsd0RBQXdEO2dCQUN4RCxpQkFBaUI7Z0JBQ25CO1lBQ0Y7UUFDRjtJQUNGO0lBR0YsZ0RBQWdEO0lBQ2hELElBQUlULElBQWlELEVBQVE7UUFDM0QsSUFBSTtZQUNGLE1BQU1ZLGNBQWMsTUFBTWxCLHFEQUFPQTtZQUNqQyxNQUFNbUIsYUFBYUQsWUFBWVIsR0FBRyxDQUFDO1lBRW5DLElBQUlTLFlBQVk7Z0JBQ2QsMEJBQTBCO2dCQUMxQixNQUFNLEVBQUVDLE1BQU1DLE1BQU0sRUFBRSxHQUFHLE1BQU1oQixPQUM1QmlCLEdBQUcsQ0FBQyxzQkFBc0I7b0JBQUVDLFFBQVFKO2dCQUFXLEdBQy9DSyxNQUFNO2dCQUVULE1BQU1DLGNBQWNKO2dCQUNwQixJQUFJSSxhQUFhQyxJQUFJO29CQUNuQix5Q0FBeUM7b0JBQ3pDLE1BQU1yQixPQUFPaUIsR0FBRyxDQUFDLHNCQUFzQjt3QkFBRUssYUFBYUYsWUFBWUMsRUFBRTtvQkFBQztnQkFDdkU7WUFDRjtRQUNGLEVBQUUsT0FBT1gsT0FBTztZQUNkYSxRQUFRYixLQUFLLENBQUMsaUNBQWlDQTtRQUMvQyw2Q0FBNkM7UUFDL0M7SUFDRjtJQUVBLE9BQU9WO0FBQ1Q7QUFFQSxnREFBZ0Q7QUFDaEQsaUVBQWlFO0FBQzFELFNBQVN3QjtJQUNkLE9BQU8xQixtRUFBb0JBLENBQ3pCRywwQ0FBb0MsRUFDcENBLFFBQVFDLEdBQUcsQ0FBQ3VCLHlCQUF5QixFQUNyQztRQUNFQyxNQUFNO1lBQ0pDLGtCQUFrQjtZQUNsQkMsZ0JBQWdCO1FBQ2xCO0lBQ0Y7QUFFSiIsInNvdXJjZXMiOlsid2VicGFjazovL3BhcmVudGluZy1zY2hvb2wtcGxhdGZvcm0vLi9zcmMvbGliL3N1cGFiYXNlL3NlcnZlci50cz8yZThlIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvb2tpZXMsIGhlYWRlcnMgfSBmcm9tICduZXh0L2hlYWRlcnMnO1xuaW1wb3J0IHsgY3JlYXRlU2VydmVyQ2xpZW50LCB0eXBlIENvb2tpZU9wdGlvbnMgfSBmcm9tICdAc3VwYWJhc2Uvc3NyJztcbmltcG9ydCB7IGNyZWF0ZUNsaWVudCBhcyBjcmVhdGVTdXBhYmFzZUNsaWVudCB9IGZyb20gJ0BzdXBhYmFzZS9zdXBhYmFzZS1qcyc7XG5cbi8vIFJlZ3VsYXIgYXV0aGVudGljYXRlZCBjbGllbnQgKHN1YmplY3QgdG8gUkxTKVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUNsaWVudCgpIHtcbiAgY29uc3QgY29va2llU3RvcmUgPSBhd2FpdCBjb29raWVzKCk7XG5cbiAgY29uc3QgY2xpZW50ID0gY3JlYXRlU2VydmVyQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkhLFxuICAgIHtcbiAgICAgIGNvb2tpZXM6IHtcbiAgICAgICAgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICAgIHJldHVybiBjb29raWVTdG9yZS5nZXQobmFtZSk/LnZhbHVlO1xuICAgICAgICB9LFxuICAgICAgICBzZXQobmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBvcHRpb25zOiBDb29raWVPcHRpb25zKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvb2tpZVN0b3JlLnNldCh7IG5hbWUsIHZhbHVlLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYHNldGAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlbW92ZShuYW1lOiBzdHJpbmcsIG9wdGlvbnM6IENvb2tpZU9wdGlvbnMpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29va2llU3RvcmUuc2V0KHsgbmFtZSwgdmFsdWU6ICcnLCAuLi5vcHRpb25zIH0pO1xuICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAvLyBUaGUgYGRlbGV0ZWAgbWV0aG9kIHdhcyBjYWxsZWQgZnJvbSBhIFNlcnZlciBDb21wb25lbnQuXG4gICAgICAgICAgICAvLyBUaGlzIGNhbiBiZSBpZ25vcmVkIGlmIHlvdSBoYXZlIG1pZGRsZXdhcmUgcmVmcmVzaGluZ1xuICAgICAgICAgICAgLy8gdXNlciBzZXNzaW9ucy5cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9LFxuICAgIH1cbiAgKTtcblxuICAvLyBTZXQgdGVuYW50IGNvbnRleHQgaWYgbXVsdGl0ZW5hbmN5IGlzIGVuYWJsZWRcbiAgaWYgKHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX01VTFRJVEVOQU5DWV9FTkFCTEVEID09PSAndHJ1ZScpIHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgaGVhZGVyc0xpc3QgPSBhd2FpdCBoZWFkZXJzKCk7XG4gICAgICBjb25zdCB0ZW5hbnRTbHVnID0gaGVhZGVyc0xpc3QuZ2V0KCd4LXRlbmFudC1zbHVnJyk7XG5cbiAgICAgIGlmICh0ZW5hbnRTbHVnKSB7XG4gICAgICAgIC8vIEdldCB0ZW5hbnQgSUQgZnJvbSBzbHVnXG4gICAgICAgIGNvbnN0IHsgZGF0YTogdGVuYW50IH0gPSBhd2FpdCBjbGllbnRcbiAgICAgICAgICAucnBjKCdnZXRfdGVuYW50X2J5X3NsdWcnLCB7IHBfc2x1ZzogdGVuYW50U2x1ZyB9KVxuICAgICAgICAgIC5zaW5nbGUoKTtcblxuICAgICAgICBjb25zdCB0eXBlZFRlbmFudCA9IHRlbmFudCBhcyB7IGlkOiBzdHJpbmc7IHNsdWc6IHN0cmluZzsgbmFtZTogc3RyaW5nIH0gfCBudWxsO1xuICAgICAgICBpZiAodHlwZWRUZW5hbnQ/LmlkKSB7XG4gICAgICAgICAgLy8gU2V0IGN1cnJlbnQgdGVuYW50IGluIGRhdGFiYXNlIHNlc3Npb25cbiAgICAgICAgICBhd2FpdCBjbGllbnQucnBjKCdzZXRfY3VycmVudF90ZW5hbnQnLCB7IHBfdGVuYW50X2lkOiB0eXBlZFRlbmFudC5pZCB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBzZXR0aW5nIHRlbmFudCBjb250ZXh0OicsIGVycm9yKTtcbiAgICAgIC8vIERvbid0IGZhaWwgdGhlIHJlcXVlc3QsIGp1c3QgbG9nIHRoZSBlcnJvclxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBjbGllbnQ7XG59XG5cbi8vIEFkbWluIGNsaWVudCB3aXRoIHNlcnZpY2Ugcm9sZSAoYnlwYXNzZXMgUkxTKVxuLy8gVXNlIHRoaXMgZm9yIGFkbWluIG9wZXJhdGlvbnMgdGhhdCBuZWVkIHRvIGJ5cGFzcyBSTFMgcG9saWNpZXNcbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVBZG1pbkNsaWVudCgpIHtcbiAgcmV0dXJuIGNyZWF0ZVN1cGFiYXNlQ2xpZW50KFxuICAgIHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCEsXG4gICAgcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSEsXG4gICAge1xuICAgICAgYXV0aDoge1xuICAgICAgICBhdXRvUmVmcmVzaFRva2VuOiBmYWxzZSxcbiAgICAgICAgcGVyc2lzdFNlc3Npb246IGZhbHNlXG4gICAgICB9XG4gICAgfVxuICApO1xufSJdLCJuYW1lcyI6WyJjb29raWVzIiwiaGVhZGVycyIsImNyZWF0ZVNlcnZlckNsaWVudCIsImNyZWF0ZUNsaWVudCIsImNyZWF0ZVN1cGFiYXNlQ2xpZW50IiwiY29va2llU3RvcmUiLCJjbGllbnQiLCJwcm9jZXNzIiwiZW52IiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJnZXQiLCJuYW1lIiwidmFsdWUiLCJzZXQiLCJvcHRpb25zIiwiZXJyb3IiLCJyZW1vdmUiLCJORVhUX1BVQkxJQ19NVUxUSVRFTkFOQ1lfRU5BQkxFRCIsImhlYWRlcnNMaXN0IiwidGVuYW50U2x1ZyIsImRhdGEiLCJ0ZW5hbnQiLCJycGMiLCJwX3NsdWciLCJzaW5nbGUiLCJ0eXBlZFRlbmFudCIsImlkIiwicF90ZW5hbnRfaWQiLCJjb25zb2xlIiwiY3JlYXRlQWRtaW5DbGllbnQiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiYXV0aCIsImF1dG9SZWZyZXNoVG9rZW4iLCJwZXJzaXN0U2Vzc2lvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/supabase/server.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/@supabase","vendor-chunks/next","vendor-chunks/tslib","vendor-chunks/cookie"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Flms%2Fcourses%2Froute&page=%2Fapi%2Flms%2Fcourses%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Flms%2Fcourses%2Froute.ts&appDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5COffirOmer%5CDocuments%5CIPSPlatform&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();